<head>
    <link href="https://vjs.zencdn.net/7.10.2/video-js.css" rel="stylesheet" />
    <script defer src="https://unpkg.com/alpinejs@3.x.x" ></script>
    <style>
        .vjs-watermark {
            position: absolute;
            top: 0;
            left: 100%;
            white-space: nowrap;
            font-weight: bold;
            z-index: 10;
        }
        .vjs-big-play-button {
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
            font-size: 3em;
        }

        @keyframes scrollWatermark {
            0% {
                left: 100%;
            }
            50% {
                left: 50%;
            }
            100% {
                left: -50%;
            }
        }
    </style>
    <!-- Include Pickr.js -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/classic.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>
</head>
<div class="m-4">
    <nav class="sm:hidden" aria-label="Back">
      <a href="#" class="flex items-center text-sm font-medium text-gray-500 hover:text-gray-700">
        <svg class="-ml-1 mr-1 h-5 w-5 flex-shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
          <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
        </svg>
        Back
      </a>
    </nav>
    <nav class="hidden sm:flex" aria-label="Breadcrumb">
      <ol role="list" class="flex items-center space-x-4">
        <li>
          <div class="flex">
            <a href="#" class="text-sm font-medium text-gray-500 hover:text-gray-700">Settings</a>
          </div>
        </li>
        <li>
          <div class="flex items-center">
            <svg class="h-5 w-5 flex-shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
            </svg>
            <a href="#" class="ml-4 text-sm font-medium text-gray-500 hover:text-gray-700">Institute</a>
          </div>
        </li>
      </ol>
    </nav>
</div>
<form x-data="watermarkForm()" class = "m-4 box-border">
    <div class="space-y-12">
        <div class="border-b border-gray-900/10 pb-12">
            <h2 class="text-base font-semibold leading-7 text-gray-900">Video Watermark Settings</h2>
            <p class="mt-1 text-sm leading-6 text-gray-600">Configure the settings for the watermark that will be displayed on your videos.</p>

            <div class="flex space-y-6 gap-10">
            <div class="mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6">
                <div class="sm:col-span-6">
                    <label for="type" class="block text-sm font-medium leading-6 text-gray-900">Watermark Type</label>
                    <div class="mt-2">
                      <select id="type" x-model="type" name="watermark_type" autocomplete="watermark_type" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6">
                        <option value="dynamic">Dynamic</option>
                        <option value="static">Static</option>
                        <option value="none">None</option>
                      </select>
                    </div>
                </div>

                <div x-show="type === 'static'" class="sm:col-span-4">
                    <label for="position" class="block text-sm font-medium leading-6 text-gray-900">Watermark Position</label>
                    <div class="mt-2">
                      <select id="position" x-model="position" name="watermark_position" autocomplete="country-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6">
                        <option value="top-left">Top Left</option>
                        <option value="top-right">Top Right</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-right">Bottom Right</option>
                        <option value="middle">Middle</option>
                      </select>
                    </div>
                </div>

                <div x-show="type === 'dynamic'" class="sm:col-span-6">
                    <label for="interval" class="block text-sm font-medium leading-6 text-gray-900">Interval (seconds)</label>
                    <div class="mt-2">
                      <input type="number" id="interval" name="watermark_interval" x-model="interval" min="1" autocomplete="email" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                    </div>
                </div>
                <div x-show="type === 'dynamic'" class="sm:col-span-6">
                    <label for="skip" class="block text-sm font-medium leading-6 text-gray-900">Skip (seconds)</label>
                    <div class="mt-2">
                      <input type="number" id="skip" name="watermark_skip" x-model="skip" min="1" autocomplete="email" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                    </div>
                </div>
                <div x-show="type !== 'none'" class="sm:col-span-6">
                    <label for="size" class="block text-sm font-medium leading-6 text-gray-900">Size</label>
                    <div class="mt-2">
                      <input type="number" id="size" name="watermark_size" x-model="size" min="1" autocomplete="email" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                    </div>
                </div>
                <div x-show="type !== 'none'" class="sm:col-span-4">
                    <label for="color" class="block text-sm font-medium leading-6 text-gray-900">Color & Opacity</label>
                    <div class="mt-2 flex items-center gap-2">
                        <div class="pickr">
                            <button id="color" name="watermark_color" x-model="color" type="button" class="pcr-button" role="button" aria-label="toggle color picker dialog" 
                                style="transition: none; --pcr-color: rgba(3, 164, 235, 1);"  readonly></button>
                        </div>
                        <input type="range" id="opacity" name="watermark_opacity" x-model="opacity" min="0" max="100"  step="0.5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">                  
                    </div>
                </div>
            </div>
            <div x-show="type !== 'none'" class="space-y-12">
                <div class="relative my-4 w-full truncate rounded-lg shadow-md">
                    <video id="my-video" class="video-js vjs-default-skin" controls preload="auto" poster="https://www.w3schools.com/html/mov_bbb.jpg" data-setup="{}" height="269px" muted autoplay>
                        <source src='http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4' type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <div x-show="type === 'static'" :style="previewStyles" class="absolute font-bold" x-text="watermarkText"></div>
                </div>
            </div>
            </div>
        </div>
        <div class="mt-4 flex items-center justify-end gap-x-6">
            <button type="button" class="text-sm font-semibold leading-6 text-gray-900">Cancel</button>
            <button type="submit" class="rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Save</button>
        </div>
    </div>

    <!-- Video.js CDN -->
    <script src="https://vjs.zencdn.net/7.17.0/video.min.js"></script>

    <script>
        function watermarkForm() {
            return {
                watermarkText: 'Watermark',
                type: 'dynamic',
                position: 'top-left',
                interval: 5,
                skip: 3,
                size: 10,
                color: '#03A4EB',
                opacity: 50,
                positionY: 10,

                init() {
                    if(this.type === "dynamic")
                    this.initializePlayer();
                    this.initializeColorPicker();
                },

                get rgbaColor() {
                    let hex = this.color.replace('#', '');
                    let r = parseInt(hex.substring(0, 2), 16);
                    let g = parseInt(hex.substring(2, 4), 16);
                    let b = parseInt(hex.substring(4, 6), 16);
                    let a = this.opacity / 100;
                    return `rgba(${r}, ${g}, ${b}, ${a})`;
                },

                initializePlayer() {
                    var myplayer = videojs('my-video', {
                        controls: true,
                        autoplay: false,
                        preload: 'auto',
                    });

                    myplayer.on('ready', () => {
                        this.addScrollingWatermark(myplayer);
                    });
                },

                addScrollingWatermark(player) {
                    var watermark = document.createElement('div');
                    watermark.classList.add('vjs-watermark');
                    watermark.textContent = this.watermarkText;

                    var videoContainer = player.el();
                    videoContainer.appendChild(watermark);

                    this.scrollWatermark(watermark);
                },

                scrollWatermark(watermarkElement) {
                    setInterval(() => {
                        if(this.type==="static")
                        return;
                        watermarkElement.style.animation = 'scrollWatermark ' + this.interval + 's linear';
                        watermarkElement.style.display = 'block';
                        watermarkElement.style.top = `${this.positionY}%`;
                        watermarkElement.style.color = this.rgbaColor;
                        watermarkElement.style.fontSize = `${this.size}px`;

                        setTimeout(() => {
                            watermarkElement.style.animation = '';
                        }, this.interval * 1000);
                        this.positionY += 20;
                        if (this.positionY > 100) {
                            this.positionY = 10;
                        }
                    }, (this.interval + this.skip) * 1000);
                },

                get previewStyles() {
                    const positions = {
                      'top-left': { top: '10px', left: '10px' },
                      'top-right': { top: '10px', right: '10px' },
                      'bottom-left': { bottom: '10px', left: '10px' },
                      'bottom-right': { bottom: '10px', right: '10px' },
                      'middle': { top: '50%', left: '50%', transform: 'translate(-50%, -50%)' }
                    };
      
                    const positionStyle = this.type === 'static' ? positions[this.position] : {};
      
                    return {
                      ...positionStyle,
                      fontSize: `${this.size}px`,
                      color: this.rgbaColor,
                    };
                  },

                initializeColorPicker() {
                    const pickr = Pickr.create({
                        el: '.pcr-button',
                        theme: 'classic',
                        default: 'rgba(3, 164, 235, 1)',
                
                        swatches: [
                            'rgba(244, 67, 54, 1)',
                            'rgba(233, 30, 99, 1)',
                            'rgba(156, 39, 176, 1)',
                            'rgba(103, 58, 183, 1)',
                            'rgba(63, 81, 181, 1)',
                            'rgba(3, 164, 235, 1)',
                            'rgba(0, 150, 136, 1)',
                            'rgba(76, 175, 80, 1)',
                            'rgba(139, 195, 74, 1)',
                            'rgba(205, 220, 57, 1)',
                            'rgba(255, 235, 59, 1)',
                            'rgba(255, 193, 7, 1)'
                        ],
                
                        components: {
                            preview: true,
                            opacity: false,
                            hue: true,
                
                            interaction: {
                                hex: false,
                                rgba: false,
                                input: true,
                                clear: false,
                                save: false,
                                opacity: false
                            }
                        }
                    });
                    pickr.on('change', (color) => {
                        const hexaColor = color.toHEXA().toString();
                        this.color = hexaColor;
                        document.getElementsByClassName('pcr-button')[0].style = `--pcr-color: ${hexaColor}`;
                    });
                }

                
            
                };
        }
    </script>
</form>
