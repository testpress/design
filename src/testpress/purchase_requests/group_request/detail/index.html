{% extends "layouts/admin_base.html" %}
{% block body_class %}overflow-y-scroll min-h-screen bg-gray-100{% endblock %}
{% block content %}
<div x-data="groupRequestDetail()" class="py-10 max-w-7xl mx-auto lg:px-8 px-4">
  {% include "./header.html" %}

  <!-- Info Cards Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5 mb-5">
    {% include "./group_info.html" %}
    {% include "./purchasing_product.html" %}
    {% include "./review_info.html" %}
  </div>
  <!-- End Info Cards Grid -->

  <!-- Users Table -->
  <div>
    {% include "./users_table.html" %}
  </div>
  <!-- End Users Table -->

</div>
{% endblock %}

{% block script %}
<script>
  function groupRequestDetail() {
    return {
      activeTab: 'pending',
      searchQuery: '',
      selectedUsers: [],
      showFilterModal: false,

      pendingUsers: [
        {
          id: 1,
          name: 'John Doe',
          email: 'john.doe@example.com',
          phone: '+91 98765 43210',
          avatar: 'https://i.pravatar.cc/150?img=12',
          status: 'pending'
        },
        {
          id: 2,
          name: 'Jane Smith',
          email: 'jane.smith@example.com',
          phone: '+91 98765 43211',
          avatar: 'https://i.pravatar.cc/150?img=47',
          status: 'pending'
        },
        {
          id: 3,
          name: 'Michael Johnson',
          email: 'michael.johnson@example.com',
          phone: '+91 98765 43212',
          avatar: null,
          status: 'pending'
        },
        {
          id: 4,
          name: 'Sarah Williams',
          email: 'sarah.williams@example.com',
          phone: '+91 98765 43213',
          avatar: 'https://i.pravatar.cc/150?img=45',
          status: 'pending'
        },
        {
          id: 5,
          name: 'David Brown',
          email: 'david.brown@example.com',
          phone: '+91 98765 43214',
          avatar: null,
          status: 'pending'
        },
        {
          id: 6,
          name: 'Emily Davis',
          email: 'emily.davis@example.com',
          phone: '+91 98765 43215',
          avatar: 'https://i.pravatar.cc/150?img=28',
          status: 'pending'
        },
        {
          id: 7,
          name: 'Robert Wilson',
          email: 'robert.wilson@example.com',
          phone: '+91 98765 43216',
          avatar: null,
          status: 'pending'
        },
        {
          id: 8,
          name: 'Lisa Anderson',
          email: 'lisa.anderson@example.com',
          phone: '+91 98765 43217',
          avatar: 'https://i.pravatar.cc/150?img=33',
          status: 'pending'
        },
        {
          id: 9,
          name: 'James Taylor',
          email: 'james.taylor@example.com',
          phone: '+91 98765 43218',
          avatar: null,
          status: 'pending'
        },
        {
          id: 10,
          name: 'Maria Garcia',
          email: 'maria.garcia@example.com',
          phone: '+91 98765 43219',
          avatar: 'https://i.pravatar.cc/150?img=15',
          status: 'pending'
        },
        {
          id: 11,
          name: 'William Martinez',
          email: 'william.martinez@example.com',
          phone: '+91 98765 43220',
          avatar: null,
          status: 'pending'
        },
        {
          id: 12,
          name: 'Jennifer Lee',
          email: 'jennifer.lee@example.com',
          phone: '+91 98765 43221',
          avatar: 'https://i.pravatar.cc/150?img=20',
          status: 'pending'
        }
      ],

      approvedRejectedUsers: [
        {
          id: 13,
          name: 'Thomas White',
          email: 'thomas.white@example.com',
          phone: '+91 98765 43222',
          avatar: null,
          status: 'approved'
        },
        {
          id: 14,
          name: 'Patricia Harris',
          email: 'patricia.harris@example.com',
          phone: '+91 98765 43223',
          avatar: 'https://i.pravatar.cc/150?img=25',
          status: 'approved'
        },
        {
          id: 15,
          name: 'Christopher Clark',
          email: 'christopher.clark@example.com',
          phone: '+91 98765 43224',
          avatar: null,
          status: 'rejected'
        },
        {
          id: 16,
          name: 'Linda Lewis',
          email: 'linda.lewis@example.com',
          phone: '+91 98765 43225',
          avatar: 'https://i.pravatar.cc/150?img=30',
          status: 'approved'
        },
        {
          id: 17,
          name: 'Daniel Walker',
          email: 'daniel.walker@example.com',
          phone: '+91 98765 43226',
          avatar: null,
          status: 'approved'
        },
        {
          id: 18,
          name: 'Barbara Hall',
          email: 'barbara.hall@example.com',
          phone: '+91 98765 43227',
          avatar: 'https://i.pravatar.cc/150?img=35',
          status: 'rejected'
        }
      ],

      get filteredPendingUsers() {
        let filtered = this.pendingUsers;
        if (this.searchQuery) {
          const query = this.searchQuery.toLowerCase();
          filtered = filtered.filter(u =>
            u.name.toLowerCase().includes(query) ||
            u.email.toLowerCase().includes(query) ||
            (u.phone && u.phone.toLowerCase().includes(query))
          );
        }
        return filtered;
      },

      get filteredApprovedRejectedUsers() {
        let filtered = this.approvedRejectedUsers;
        if (this.searchQuery) {
          const query = this.searchQuery.toLowerCase();
          filtered = filtered.filter(u =>
            u.name.toLowerCase().includes(query) ||
            u.email.toLowerCase().includes(query) ||
            (u.phone && u.phone.toLowerCase().includes(query))
          );
        }
        return filtered;
      },

      toggleAllUsers() {
        if (this.selectedUsers.length === this.filteredPendingUsers.length) {
          this.selectedUsers = [];
        } else {
          this.selectedUsers = this.filteredPendingUsers.map(u => u.id);
        }
      },

      toggleUserSelection(userId) {
        const index = this.selectedUsers.indexOf(userId);
        if (index > -1) {
          this.selectedUsers.splice(index, 1);
        } else {
          this.selectedUsers.push(userId);
        }
      },

      openBulkApproveModal() {
        // TODO: Implement bulk approve modal
        console.log('Bulk approve:', this.selectedUsers);
      },

      openBulkRejectModal() {
        // TODO: Implement bulk reject modal
        console.log('Bulk reject:', this.selectedUsers);
      },

      openApproveModal(user) {
        // TODO: Implement approve modal
        console.log('Approve user:', user);
      },

      openRejectModal(user) {
        // TODO: Implement reject modal
        console.log('Reject user:', user);
      },

      getActiveFiltersCount() {
        let count = 0;
        if (this.searchQuery) count++;
        return count;
      }
    };
  }
</script>
{% endblock %}