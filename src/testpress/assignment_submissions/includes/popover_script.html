<script>
  function popOver() {
    return {
      popoverOpen: false,
      popoverArrow: true,
      popoverPosition: 'bottom',
      popoverHeight: 0,
      popoverOffset: 8,

      init() {
        window.addEventListener('resize', () => this.popoverPositionCalculate())
        this.$watch('popoverOpen', (value) => {
          if (value) {
            this.popoverPositionCalculate()
            document.getElementById('width').focus()
          }
        })
      },

      popoverHeightCalculate() {
        this.$refs.popover.classList.add('invisible')
        this.popoverOpen = true
        this.$nextTick(() => {
          this.popoverHeight = this.$refs.popover.offsetHeight
          console.log('Setting popoverOpen to false')
          this.popoverOpen = false
          this.$refs.popover.classList.remove('invisible')
          this.$refs.popoverInner.setAttribute('x-transition', '')
          this.popoverPositionCalculate()
        })
      },

      popoverPositionCalculate() {
        if (
          window.innerHeight <
          this.$refs.popoverButton.getBoundingClientRect().top +
            this.$refs.popoverButton.offsetHeight +
            this.popoverOffset +
            this.popoverHeight
        ) {
          this.popoverPosition = 'top'
        } else {
          this.popoverPosition = 'bottom'
        }
      },
    }
  }
</script>
