<script>
  document.addEventListener('DOMContentLoaded', function () {
    const dropzoneContainer = document.getElementById('dropzone-container');
    const fileInput = document.getElementById('id_file');
    const fileUploadInfo = document.getElementById('file-upload-info');
    const fileUploadError = document.getElementById('file-upload-error');

    dropzoneContainer.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropzoneContainer.classList.add('border-emerald-500');
    });

    dropzoneContainer.addEventListener('dragleave', () => {
      dropzoneContainer.classList.remove('border-emerald-500');
    });

    dropzoneContainer.addEventListener('drop', (e) => {
      e.preventDefault();
      dropzoneContainer.classList.remove('border-emerald-500');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        fileInput.files = files;
        handleFileSelect(files);
      }
    });

    fileInput.addEventListener('change', () => {
      handleFileSelect(fileInput.files);
    });

    function handleFileSelect(files) {
      fileUploadInfo.innerHTML = '';
      fileUploadError.innerHTML = '';
      if (files.length > 0) {
        const file = files[0];
        if ( file.name.endsWith('.xls') || file.name.endsWith('.xlsx') ) {
          fileUploadInfo.innerHTML = `Selected file: <b>${file.name}</b> (${(file.size / 1024).toFixed(2)} KB)`;
        } else {
          fileUploadError.innerHTML = 'Please select a valid Excel file. (xls or xlsx)';
          fileInput.value = '';
        }
      }
    }
  });
</script>
