<script>
  function installmentsData() {
    return {
      selectedFilter: 'all',
      searchQuery: '',
      init() {
        window.addEventListener('filter-changed', (e) => {
          this.selectedFilter = e.detail;
        });
      },
      installments: [
        {
          id: 1,
          product: 'Premium Course Package',
          course: 'Full Stack Development',
          amountPaid: 15000,
          amountDue: 30000,
          totalAmount: 45000,
          isPaid: true,
          isDueSoon: false,
          isOverdue: false,
          dueDate: '15 Jan 2026',
          lastPaid: '10 Jan 2026',
          overdueDays: 0,
          daysUntilDue: 0,
          transactions: [
            {
              id: 'TXN123456789',
              amount: 15000,
              paidOn: '10 Jan 2026',
              status: 'success'
            }
          ]
        },
        {
          id: 2,
          product: 'Premium Course Package',
          course: 'Full Stack Development',
          amountPaid: 15000,
          amountDue: 30000,
          totalAmount: 45000,
          isPaid: false,
          isDueSoon: true,
          isOverdue: false,
          dueDate: '15 Feb 2026',
          lastPaid: '10 Jan 2026',
          overdueDays: 0,
          daysUntilDue: 19,
          transactions: [
            {
              id: 'TXN123456789',
              amount: 15000,
              paidOn: '10 Jan 2026',
              status: 'success'
            }
          ]
        },
        {
          id: 3,
          product: 'Standard Package',
          course: 'Data Science Bootcamp',
          amountPaid: 0,
          amountDue: 40000,
          totalAmount: 40000,
          isPaid: false,
          isDueSoon: false,
          isOverdue: true,
          dueDate: '10 Jan 2026',
          lastPaid: '-',
          overdueDays: 17,
          daysUntilDue: 0,
          transactions: []
        },
        {
          id: 4,
          product: 'Advanced AI Course',
          course: 'Machine Learning Specialization',
          amountPaid: 25000,
          amountDue: 25000,
          totalAmount: 50000,
          isPaid: false,
          isDueSoon: false,
          isOverdue: false,
          dueDate: '10 Mar 2026',
          lastPaid: '05 Jan 2026',
          overdueDays: 0,
          daysUntilDue: 42,
          transactions: [
            {
              id: 'TXN987654321',
              amount: 25000,
              paidOn: '05 Jan 2026',
              status: 'success'
            }
          ]
        }
      ],
      
      payNow(installment) {
        // Show payment modal or redirect to payment gateway
        console.log('Initiating payment for:', installment);
        
        // Example: Show a simple alert (replace with actual payment integration)
        alert(`Initiating payment of ₹${installment.amountDue.toLocaleString()} for ${installment.course}`);
        
        // In a real implementation, you would:
        // 1. Open a payment modal
        // 2. Integrate with payment gateway (Razorpay, Stripe, etc.)
        // 3. Handle payment success/failure
        // 4. Update the installment status
      },
      
      viewReceipt(installment) {
        // Show receipt modal or download PDF
        console.log('Viewing receipt for:', installment);
        
        // Example: Show a simple alert (replace with actual receipt viewer)
        alert(`Receipt Details:\n\nCourse: ${installment.course}\nProduct: ${installment.product}\nAmount Paid: ₹${installment.amountPaid.toLocaleString()}\nLast Paid: ${installment.lastPaid}`);
        
        // In a real implementation, you would:
        // 1. Open a receipt modal with full details
        // 2. Provide option to download PDF receipt
        // 3. Show transaction history
      },
      
      getFilteredInstallments(filter) {
        if (filter === 'all') {
          return this.installments;
        }
        
        switch(filter) {
          case 'paid':
            return this.installments.filter(i => i.isPaid);
          case 'pending':
            return this.installments.filter(i => !i.isPaid && !i.isOverdue);
          case 'overdue':
            return this.installments.filter(i => i.isOverdue);
          default:
            return this.installments;
        }
      }
    }
  }
</script>
