<div id="hs-pro-shflo" class="hs-overlay hs-overlay-open:translate-x-0 hidden translate-x-full fixed top-0 end-0 transition-all duration-300 transform h-full w-[40%] z-[9999] flex flex-col bg-white dark:bg-neutral-800 shadow-2xl rounded-r-xl" role="dialog" tabindex="-1" aria-labelledby="hs-pro-shflo-label" @click.self.stop @hs-overlay-close.window="selectedErrorReason = null">
  <!-- Header -->
  <div class="py-3 px-6 flex justify-between items-center border-b border-gray-200 rounded-lg dark:border-neutral-700 relative z-10 bg-white dark:bg-neutral-800">
    <h3 id="hs-pro-shflo-label" class="font-medium text-gray-800 dark:text-neutral-200">
      Questions for Mistake Reasons
      <span x-show="selectedErrorReason" class="text-sm font-normal text-gray-600 dark:text-neutral-400">
        (<span x-text="selectedErrorReason"></span>)
      </span>
    </h3>
    <button 
      type="button" 
      @click="selectedErrorReason = null"
      class="py-1.5 px-2 inline-flex justify-center items-center gap-x-1 rounded-full border border-gray-200 text-xs text-gray-800 hover:bg-gray-100 focus:outline-hidden focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:hover:bg-neutral-700 dark:text-neutral-200 dark:focus:bg-neutral-700" 
      aria-label="Close" 
      data-hs-overlay="#hs-pro-shflo"
    >
      <span class="hidden lg:block">Esc</span>
      <span class="block lg:hidden">Close</span>
      <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
    </button>
  </div>
  <!-- End Header -->

  <!-- Body -->
  <div class="bg-gray-100 h-full overflow-y-auto overflow-hidden relative z-10 [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300 dark:[&::-webkit-scrollbar-track]:bg-neutral-700 dark:[&::-webkit-scrollbar-thumb]:bg-neutral-500 dark:bg-neutral-800">
    <div class="p-2 space-y-2">
      {% for item in question_mistake_reasons %}  
      {% set mistake_reason_name = '{{item.mistake_reason.name}}' %} 

      <div 
        x-show="!selectedErrorReason || '{{ item.mistake_reason.name }}' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
        {% set question_type = item.user_selected_answer.question.type %} 
        {% if question_type == 'R' or question_type == 'C' %} 
          {% include "./mcq_question.html" %} 
        {% elif question_type == 'S' or question_type == 'E' %} 
          {% include "./essay_question.html" %} 
        {% elif question_type == 'G' %} 
          {% include "./gap_fill_question.html" %} 
        {% elif question_type == 'MATCH' %}
          {% include "./match_question.html" %} 
        {% elif question_type == 'F' %} 
          {% include "./file_question.html" %} 
        {% elif question_type == 'N' %} 
          {% include "./numerical_question.html" %} 
        {% elif question_type == 'M' %} 
          {% include "./match_question.html" %} 
        {% elif question_type == 'F' %}
          {% include "./file_question.html" %} 
        {%else %}
        <div class="p-4">
          <p class="font-medium text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none">
            {{ item.user_selected_answer.question.question_html|safe }}
          </p>

          {% if item.user_selected_answer.user_answer %}
          <div class="mt-4">
            <p class="font-medium text-gray-700 dark:text-neutral-300">
              Your Answer
            </p>
            <div class="mt-2 text-gray-600 dark:text-neutral-400 prose prose-sm max-w-none">
              {{ item.user_selected_answer.user_answer|safe }}
            </div>
          </div>
          {% endif %}
        </div>
        {% endif %}

        <!-- Notes Section -->
        {% if item.notes %}
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                {{ item.notes }}
              </p>
            </div>
          </div>
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
  <!-- End Body -->

</div>
<!-- End Cart Offcanvas -->