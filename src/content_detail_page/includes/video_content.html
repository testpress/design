
<div class="lg:px-8" x-data="{toggleSVG:true, isBookmarked:false, is_renderable:false}">
  {% include "./content_heading.html" %}
  <div class="mt-6">
    <div>
      <video id="my-video" class="video-js vjs-big-play-centered h-[32rem]" controls preload="auto" style="width: 100%">
        <source src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4"/>
        <p class="vjs-no-js">
          To view this video please enable JavaScript, and consider upgrading to a
          web browser that
          <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
        </p>
      </video>
    </div>
    {% include "./video_question.html" %}
  </div>
  </div>
  <div class="px-4 lg:px-0">
  {% include "./doubt_button.html" %}
  <div class="mt-6 text-sm text-gray-900 description" x-data="{ showFullDescription: false }">
    <div x-cloak x-show="!showFullDescription">
        <span id="desc-chaptercontent-id" class="short-description">
          Discover the secrets of digital marketing in this comprehensive guide! From SEO strategies to social media growth, we cover everything you need to boost your brand online. Learn expert tips, proven techniques, and the latest trends to stay ahead of the competition. Watch now and start growing!...
        </span>
        <span @click="showFullDescription = true" class="text-emerald-600 text-bold cursor-pointer">Show More</span>
    </div>
    <div x-cloak x-show="showFullDescription">
        <span id="full-desc-chaptercontent-id" class="full-description">
          Discover the secrets of digital marketing in this comprehensive guide! From SEO strategies to social media growth, we cover everything you need to boost your brand online. Learn expert tips, proven techniques, and the latest trends to stay ahead of the competition. Watch now and start growing! Learn how to optimize your website for search engines, create engaging content, and drive organic traffic that converts. We explore the importance of keyword research, backlink building, and on-page SEO to ensure your content ranks higher on Google.
        </span>
        <span @click="showFullDescription = false" class="text-emerald-600 text-bold cursor-pointer">Show Less</span>
    </div>
  </div>
</div>
<script src="https://vjs.zencdn.net/7.8.4/video.js"></script>
<script>
var video = videojs("my-video"); 
var video_question_modal = document.querySelector(".video-question-modal");
var video_questions_positions = [10,50,90]; 
var currentPosition = 0;
const params = new URLSearchParams(window.location.search);
var quizEnabled = params.get("video_quiz_enabled") === "true";

video.on("timeupdate", function () {
  if(quizEnabled == false)return;
  var currentTime = Math.floor(video.currentTime());
  if (video_questions_positions.includes(currentTime) && this.currentPosition != currentTime) {
    const prevVideoQuestion = document.querySelector(`.video-question-position-${currentTime}`);
    if (prevVideoQuestion) {
      prevVideoQuestion.style.display = "none";
    }
    this.isPausedForQuiz = true;
    this.currentPosition = currentTime;
    video.pause();
    video_question_modal.classList.remove("hidden");
    const currentVideoQuestion = document.querySelector(`.video-question-position-${currentTime}`);
    if (currentVideoQuestion) {
      currentVideoQuestion.style.display = "block";
    }
  }
});
var continueBtn = document.querySelectorAll(".continue-btn");
continueBtn.forEach(button => {
  button.addEventListener("click", function() {
    var currentTime = Math.floor(video.currentTime());
    video_question_modal.classList.add("hidden");
    const currentVideoQuestion = document.querySelector(`.video-question-position-${currentTime}`);
    if (currentVideoQuestion) {
      currentVideoQuestion.style.display = "none";
    }
    video.play();
  });
});

video.on("loadedmetadata",function(){
  if(quizEnabled == false)return;
  
  var total = video.duration();
  
  var p = jQuery(video.controlBar.progressControl.children_[0].el_);
  
  for(var i=0;i<video_questions_positions.length;i++){
    var left =( video_questions_positions[i]/ total * 100)+'%';
    var time = video_questions_positions[i];

		var el = jQuery('<div class="vjs-marker" style="left:'+left+'" data-time="'+time+'"><span>Quiz</span></div>');
		el.click(function(){
      video.currentTime($(this).data('time')); 
		});
		p.append(el);
  }
});
</script>
