{% for chapter in chapters %}
  <li>
    <a href="#" @click="expanded['chapter_{{ loop.index0 }}'] = !expanded['chapter_{{ loop.index0 }}']" class="flex items-start justify-between px-2 py-3 font-semibold leading-6 text-gray-700 hover:text-emerald-600 group gap-x-3 text-sm">
      {{ chapter.title }}
      <!-- SVG Icon -->
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" :class="{ '-rotate-180': expanded['chapter_{{ loop.index0 }}'] }" class="w-5 h-5 transition-transform duration-300 transform">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
      </svg>
    </a>
    <ul x-show="expanded['chapter_{{ loop.index0 }}']" x-collapse role="list" class="ml-4">
      {% if chapter.subchapters %} 
        {% for subchapter in chapter.subchapters %}
          <li>
            <a href="#" @click="expanded['subchapter_{{ loop.index0 }}'] = !expanded['subchapter_{{ loop.index0 }}']" class="flex items-start justify-between px-2 py-3 font-semibold leading-6 text-slate-700 text-sm hover:text-emerald-600 group gap-x-3">
              {{ subchapter.name }}
              <!-- SVG Icon -->
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" :class="{ '-rotate-180': expanded['subchapter_{{ loop.index0 }}'] }" class="w-5 h-5 transition-transform duration-300 transform">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
              </svg>
            </a>
            <ul x-show="expanded['subchapter_{{ loop.index0 }}']" x-collapse role="list" class="ml-4">
              {% if subchapter.nestedsubchapter %}
                {% include "./subchapter.html" %}
              {% else %}
                {% for content in subchapter.contents %}
                  {% include "./content.html" %}
                {% endfor %}
              {% endif %}
            </ul>
          </li>
        {% endfor %}
      {% else %}
        {% for content in chapter.contents %}
          {% include "./content.html" %}
        {% endfor %}
      {% endif %}
    </ul>
  </li>              
{% endfor %}