<script>
  window.addEventListener('load', () => {
    // Apex Device Distribution Donut Chart (Semi-circle)
    (function () {
      buildChart(
        "#hs-device-distribution-chart",
        (mode) => ({
          chart: {
            height: 265,
            type: "donut",
          },
          plotOptions: {
            pie: {
              startAngle: -90,
              endAngle: 90,
              donut: {
                size: "76%",
              },
              dataLabels: {
                show: false,
              }
            }
          },
          series: [12450, 3280, 2150, 1120], // Mobile, Tablet, Desktop, Smart TV
          labels: ["Mobile", "Tablet", "Desktop", "Smart TV"],
          legend: {
            show: false,
          },
          stroke: {
            lineCap: 'round',
            width: 5,
            colors: ['#ffffff']
          },
          dataLabels: {
            enabled: false,
          },
          states: {
            hover: {
              filter: {
                type: "none",
              },
            },
          },
          grid: {
            padding: {
              top: 20,
              bottom: -100,
              left: -12,
              right: -12
            }
          },
          tooltip: {
            enabled: true,
            custom: function (props) {
              const { seriesIndex, w } = props;
              if (seriesIndex < 0) return '';
              const label = w.globals.labels[seriesIndex];
              const value = w.globals.series[seriesIndex];
              const total = w.globals.series.reduce((a, b) => a + b, 0);
              const percentage = ((value / total) * 100).toFixed(1);
              const color = w.globals.colors[seriesIndex];

              return `
                <div class="border border-gray-300 bg-white w-36 text-gray-900 shadow-xl dark:bg-neutral-800 dark:border-neutral-700">
                  <div class="px-2 py-1.5 font-semibold text-[13px] flex items-center dark:text-neutral-200">
                    <span>${label}</span>
                    <span class="ms-auto">${percentage}%</span>
                  </div>
                  <div class="border-t border-gray-200 dark:border-neutral-700"></div>
                  <div class="space-y-1.5 p-2">
                    <div class="flex items-center gap-x-2 text-xs text-gray-600 dark:text-neutral-400">
                      <span class="w-3 h-3 rounded-sm inline-block" style="background:${color}"></span>
                      <span>Users</span>
                      <span class="ms-auto">${value.toLocaleString()}</span>
                    </div>
                  </div>
                </div>
              `;
            },
          },
        }),
        {
          colors: [
            '#2563eb', // Blue for Mobile
            '#9333ea', // Purple for Tablet
            '#4f46e5', // Indigo for Desktop
            '#9ca3af'  // Gray for Smart TV
          ],
          stroke: {
            colors: ["#ffffff"],
          },
        },
        {
          colors: [
            '#3b82f6', // Lighter blue for Mobile
            '#a855f7', // Lighter purple for Tablet
            '#6366f1', // Lighter indigo for Desktop
            '#6b7280'  // Gray for Smart TV
          ],
          stroke: {
            colors: ["#1f2937"],
          },
        }
      );
    })();
  });
</script>