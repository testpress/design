<script src="https://preline.co/pro/assets/vendor/lodash/lodash.min.js"></script>
<script src="https://preline.co/pro/assets/vendor/apexcharts/dist/apexcharts.min.js"></script>
<script src="https://preline.co/pro/assets/js/hs-apexcharts-helpers.js"></script>

<script>
  window.addEventListener('load', () => {
    // Apex Revenue Trend Line Chart
    (function () {
      buildChart('#hs-revenue-trend-line-chart', (mode) => ({
        chart: {
          height: 300,
          type: 'area',
          toolbar: {
            show: false
          },
          zoom: {
            enabled: false
          }
        },
        series: [
          {
            name: 'Gross Revenue',
            data: [65000, 72000, 68000, 75000, 71000, 79000, 74000, 82000, 78000, 85000, 81000, 88000, 84000, 90000, 86000, 92000, 88000, 95000, 91000, 87000, 83000, 89000, 85000, 80000, 76000, 82000, 78000, 84000, 80000, 86000]
          },
          {
            name: 'Net Revenue',
            data: [61000, 68000, 64000, 71000, 67000, 75000, 70000, 78000, 74000, 81000, 77000, 84000, 80000, 86000, 82000, 88000, 84000, 91000, 87000, 83000, 79000, 85000, 81000, 76000, 72000, 78000, 74000, 80000, 76000, 82000]
          }
        ],
        legend: {
          show: false
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          curve: 'smooth',
          width: 2
        },
        fill: {
          type: 'gradient',
          gradient: {
            type: 'vertical',
            shadeIntensity: 1,
            opacityFrom: 0.2,
            opacityTo: 0.8
          }
        },
        xaxis: {
          type: 'category',
          tickPlacement: 'on',
          categories: Array.from({ length: 30 }, (_, i) => {
            const date = new Date();
            date.setDate(date.getDate() - (29 - i));
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
          }),
          axisBorder: {
            show: false
          },
          axisTicks: {
            show: false
          },
          crosshairs: {
            stroke: {
              dashArray: 0
            },
            dropShadow: {
              show: false
            }
          },
          tooltip: {
            enabled: false
          },
          labels: {
            style: {
              colors: '#a8a29e',
              fontSize: '13px',
              fontFamily: 'Inter, ui-sans-serif',
              fontWeight: 400
            },
            formatter: function (value) {
              // Show only 8 labels to reduce clutter: 0, 4, 8, 12, 16, 20, 24, 29
              const categories = Array.from({ length: 30 }, (_, i) => {
                const date = new Date();
                date.setDate(date.getDate() - (29 - i));
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
              });
              const index = categories.indexOf(value);
              // Show labels at: 0, 4, 8, 12, 16, 20, 24, 29 (8 labels total)
              // Exclude index 28 to avoid crowding with index 29
              if (index !== -1 && (index === 0 || index === 29 || (index > 0 && index % 4 === 0 && index < 28))) {
                let t = value;
                if (t) {
                  const newT = t.split(' ');
                  t = `${newT[0]} ${newT[1]}`;
                }
                return t;
              }
              return ''; // Hide label for other dates
            },
            hideOverlappingLabels: true
          }
        },
        yaxis: {
          labels: {
            align: 'left',
            minWidth: 0,
            maxWidth: 140,
            style: {
              colors: '#a8a29e',
              fontSize: '12px',
              fontFamily: 'Inter, ui-sans-serif',
              fontWeight: 400
            },
            formatter: (value) => {
              if (value >= 100000) return `₹${(value / 100000).toFixed(1)}L`;
              if (value >= 1000) return `₹${(value / 1000).toFixed(0)}k`;
              return `₹${value}`;
            }
          }
        },
        tooltip: {
          y: {
            formatter: (value) => {
              if (value >= 100000) return `₹${(value / 100000).toFixed(2)}L`;
              if (value >= 1000) return `₹${(value / 1000).toFixed(1)}k`;
              return `₹${value}`;
            }
          },
          custom: function (props) {
            return buildTooltipCompareTwo(props, {
              title: 'Revenue',
              mode,
              hasTextLabel: true,
              valuePrefix: '₹',
              isValueDivided: false,
              wrapperExtClasses: 'min-w-48'
            });
          }
        },
        responsive: [{
          breakpoint: 568,
          options: {
            chart: {
              height: 300
            },
            labels: {
              style: {
                colors: '#a8a29e',
                fontSize: '11px',
                fontFamily: 'Inter, ui-sans-serif',
                fontWeight: 400
              },
              offsetX: -2,
              formatter: function (value) {
                // Show label only every 4 days on mobile to reduce clutter
                const categories = Array.from({ length: 30 }, (_, i) => {
                  const date = new Date();
                  date.setDate(date.getDate() - (29 - i));
                  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                });
                const index = categories.indexOf(value);
                // Show labels at: 0, 4, 8, 12, 16, 20, 24, 29 (8 labels total)
                // Exclude index 28 to avoid crowding with index 29
                if (index !== -1 && (index === 0 || index === 29 || (index > 0 && index % 4 === 0 && index < 28))) {
                  let t = value;
                  if (t) {
                    const newT = t.split(' ');
                    t = `${newT[0].slice(0, 3)} ${newT[1]}`;
                  }
                  return t;
                }
                return ''; // Hide label for other dates
              },
              hideOverlappingLabels: true
            },
            yaxis: {
              labels: {
                align: 'left',
                minWidth: 0,
                maxWidth: 140,
                style: {
                  colors: '#a8a29e',
                  fontSize: '11px',
                  fontFamily: 'Inter, ui-sans-serif',
                  fontWeight: 400
                },
                formatter: (value) => {
                  if (value >= 100000) return `₹${(value / 100000).toFixed(1)}L`;
                  if (value >= 1000) return `₹${(value / 1000).toFixed(0)}k`;
                  return `₹${value}`;
                }
              }
            }
          }
        }]
      }), {
        colors: ['#16a34a', '#3b82f6'], // Green for Gross, Blue for Net
        fill: {
          gradient: {
            shadeIntensity: .1,
            opacityFrom: .5,
            opacityTo: 0,
            stops: [50, 100, 100, 100]
          }
        },
        grid: {
          strokeDashArray: 2,
          borderColor: '#e5e7eb'
        },
        xaxis: {
          labels: {
            style: {
              colors: '#a8a29e',
            }
          }
        },
        yaxis: {
          labels: {
            style: {
              colors: '#a8a29e'
            }
          }
        }
      }, {
        colors: ['#22c55e', '#60a5fa'], // Lighter green and blue for dark mode
        fill: {
          gradient: {
            shadeIntensity: .1,
            opacityFrom: .5,
            opacityTo: 0,
            stops: [50, 100, 100, 100]
          }
        },
        grid: {
          strokeDashArray: 2,
          borderColor: '#44403c'
        },
        xaxis: {
          labels: {
            style: {
              colors: '#a3a3a3',
            }
          }
        },
        yaxis: {
          labels: {
            style: {
              colors: '#a3a3a3'
            }
          }
        }
      })
    })();
  });
</script>