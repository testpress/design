---
permalink: flimix/design/landing_pages/edit_landing_page/
tags: flimix
---

{% extends "src/flimix/layouts/sidebar_layout.html" %}
{% block main_class %}bg-stone-50{% endblock %}

{% block main_content %}
<div class="space-y-5" x-data="{ title: '', slug: '', slugEdited: false }">
  {% include "./header.html" %}
<div x-data="pageBuilder()" class="space-y-6">
  <!-- Add Section Button -->
  <div class="flex justify-between items-center">
    <h2 class="text-xl font-semibold">Landing Page Builder</h2>
    <button @click="addSection" class="inline-flex items-center px-3 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700">
      + Add Section
    </button>
  </div>

  <!-- Sections -->
  <template x-for="(section, sectionIndex) in sections" :key="section.id">
    <div class="border border-gray-200 rounded-xl p-4 bg-white dark:bg-neutral-800 dark:border-neutral-700">
      <!-- Section Header -->
      <div class="flex items-center justify-between mb-4">
        <div>
          <h3 class="text-lg font-semibold" x-text="section.name"></h3>
          <p class="text-sm text-gray-500" x-text="section.type"></p>
        </div>
        <div class="flex gap-2">
          <button @click="editSection(sectionIndex)" class="text-sm text-indigo-600 hover:underline">Edit</button>
          <button @click="removeSection(sectionIndex)" class="text-sm text-red-600 hover:underline">Delete</button>
        </div>
      </div>

      <!-- Blocks List -->
      <div class="space-y-3">
        <template x-for="(block, blockIndex) in section.blocks" :key="block.id">
          <div class="p-3 border border-gray-100 rounded-md bg-gray-50 dark:bg-neutral-700 dark:border-neutral-600">
            <div class="flex justify-between">
              <div>
                <p class="font-medium" x-text="block.type"></p>
                <p class="text-sm text-gray-600" x-text="block.summary"></p>
              </div>
              <div class="flex gap-2">
                <button @click="editBlock(sectionIndex, blockIndex)" class="text-sm text-indigo-600 hover:underline">Edit</button>
                <button @click="removeBlock(sectionIndex, blockIndex)" class="text-sm text-red-600 hover:underline">Delete</button>
              </div>
            </div>
          </div>
        </template>
      </div>

      <!-- Add Block -->
      <div class="mt-4">
        <button @click="openBlockModal(sectionIndex)" class="text-sm text-indigo-600 hover:underline">+ Add Block</button>
      </div>
    </div>
  </template>

  <!-- Section Modal -->
  <div x-show="showSectionModal" x-cloak class="fixed inset-0 z-[40] flex items-center justify-center bg-black bg-opacity-50">
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md dark:bg-neutral-800">
      <h3 class="text-lg font-semibold mb-4">Add Section</h3>
      <input x-model="newSection.name" placeholder="Section Name" class="w-full mb-3 p-2 border rounded" />
      <select x-model="newSection.type" class="w-full mb-3 p-2 border rounded">
        <option value="hero">Hero</option>
        <option value="carousel">Carousel</option>
        <option value="grid">Grid</option>
      </select>
      <div class="flex justify-end gap-2">
        <button @click="showSectionModal=false" class="text-sm text-gray-500">Cancel</button>
        <button @click="saveSection" class="text-sm text-white bg-indigo-600 px-4 py-2 rounded">Save</button>
      </div>
    </div>
  </div>

  <!-- Block Modal -->
  <div x-show="showBlockModal" x-cloak class="fixed inset-0 z-[99] flex items-center justify-center bg-black bg-opacity-50">
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md dark:bg-neutral-800">
      <h3 class="text-lg font-semibold mb-4">Add Block</h3>
      <select x-model="newBlock.type" class="w-full mb-3 p-2 border rounded">
        <option value="specific_movie">Specific Movie</option>
        <option value="movies_by_genre">Movies by Genre</option>
        <option value="movies_by_language">Movies by Language</option>
      </select>
      <template x-if="newBlock.type === 'specific_movie'">
        <input x-model="newBlock.movie" placeholder="Movie ID or Name" class="w-full mb-3 p-2 border rounded" />
      </template>
      <template x-if="newBlock.type === 'movies_by_genre'">
        <input x-model="newBlock.genre" placeholder="Genre" class="w-full mb-3 p-2 border rounded" />
      </template>
      <template x-if="newBlock.type === 'movies_by_language'">
        <input x-model="newBlock.language" placeholder="Language" class="w-full mb-3 p-2 border rounded" />
      </template>
      <input x-model="newBlock.limit" type="number" placeholder="Limit (e.g. 6)" class="w-full mb-3 p-2 border rounded" />
      <div class="flex justify-end gap-2">
        <button @click="showBlockModal=false" class="text-sm text-gray-500">Cancel</button>
        <button @click="saveBlock" class="text-sm text-white bg-indigo-600 px-4 py-2 rounded">Add</button>
      </div>
    </div>
  </div>
</div>

<script>
function pageBuilder() {
  return {
    sections: [],
    showSectionModal: false,
    showBlockModal: false,
    newSection: { name: '', type: 'hero' },
    newBlock: {},
    currentSectionIndex: null,

    addSection() {
      this.newSection = { name: '', type: 'hero' }
      this.showSectionModal = true
    },
    saveSection() {
      this.sections.push({
        id: Date.now(),
        name: this.newSection.name,
        type: this.newSection.type,
        blocks: []
      });
      this.showSectionModal = false;
    },
    removeSection(index) {
      this.sections.splice(index, 1);
    },
    editSection(index) {
      this.newSection = { ...this.sections[index] };
      this.currentSectionIndex = index;
      this.showSectionModal = true;
    },

    openBlockModal(sectionIndex) {
      this.newBlock = { type: 'specific_movie', limit: 6 };
      this.currentSectionIndex = sectionIndex;
      this.showBlockModal = true;
    },
    saveBlock() {
      const summary = this.generateBlockSummary(this.newBlock);
      this.sections[this.currentSectionIndex].blocks.push({
        id: Date.now(),
        ...this.newBlock,
        summary
      });
      this.showBlockModal = false;
    },
    generateBlockSummary(block) {
      switch (block.type) {
        case 'specific_movie':
          return `Movie: ${block.movie}`;
        case 'movies_by_genre':
          return `Genre: ${block.genre}, Limit: ${block.limit}`;
        case 'movies_by_language':
          return `Language: ${block.language}, Limit: ${block.limit}`;
        default:
          return 'Configured block';
      }
    },
    removeBlock(sectionIndex, blockIndex) {
      this.sections[sectionIndex].blocks.splice(blockIndex, 1);
    },
    editBlock(sectionIndex, blockIndex) {
      // Optional: show block config for editing
    }
  }
}
</script>

{% endblock main_content %}