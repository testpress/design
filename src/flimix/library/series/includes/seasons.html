<div id="seasons_and_episodes" class="hidden" role="tabpanel" aria-labelledby="seasons_and_episodes-items">
  <div class="-ms-[5px] flex justify-between items-center gap-1 sm:gap-2 px-2 mt-5">
    <div class="flex flex-wrap items-center gap-1 sm:gap-2">

      <!-- Select -->
      <div class="hs-dropdown [--auto-close:inside] relative inline-flex">
        <button id="hs-pro-eakfd" type="button"
          class="py-2 px-2 inline-flex items-center gap-x-1.5 text-xs rounded-lg bg-white text-gray-800 hover:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-gray-100 dark:bg-neutral-900 dark:text-neutral-200 dark:hover:bg-neutral-800 dark:focus:bg-neutral-800"
          aria-haspopup="menu" aria-expanded="false" aria-label="Dropdown">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="shrink-0 size-3.5">
            <path d="m3 16 4 4 4-4" />
            <path d="M7 20V4" />
            <rect x="15" y="4" width="4" height="6" ry="2" />
            <path d="M17 20v-6h-2" />
            <path d="M15 20h4" />
          </svg>
          Sort by
        </button>

        <!-- Filter Dropdown -->
        <div
          class="hs-dropdown-menu hs-dropdown-open:opacity-100 w-auto transition-[opacity,margin] duration opacity-0 hidden z-20 bg-white rounded-xl shadow-xl dark:bg-neutral-900"
          role="menu" aria-orientation="vertical" aria-labelledby="hs-pro-eakfd">

          <div class="p-1 space-y-0.5">
            <a class="w-full flex gap-x-3 py-2 px-3 rounded-lg text-sm text-gray-800 hover:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:text-neutral-300 focus:outline-hidden focus:bg-gray-100 dark:hover:bg-neutral-800 dark:focus:bg-neutral-800"
              href="#">
              Newest First
            </a>
            <a class="w-full flex gap-x-3 py-2 px-3 rounded-lg text-sm text-gray-800 hover:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:text-neutral-300 focus:outline-hidden focus:bg-gray-100 dark:hover:bg-neutral-800 dark:focus:bg-neutral-800"
              href="#">
              Oldest First
            </a>
          </div>
        </div>
        <!-- End Filter Dropdown -->
      </div>
      <!-- End Select -->


      <div
        class="relative ps-0.5 sm:ps-2 before:block before:absolute before:top-1/2 before:-start-px before:w-px before:h-4 before:bg-gray-300 before:-translate-y-1/2 dark:before:bg-neutral-700">
        <!-- Search -->
        <button type="button"
          class="hs-collapse-toggle md:hidden size-8 inline-flex justify-center items-center gap-x-1.5 text-xs rounded-lg bg-white text-gray-800 hover:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-gray-100 dark:bg-neutral-900 dark:text-neutral-200 dark:hover:bg-neutral-800 dark:focus:bg-neutral-800"
          id="hs-basic-collapse" aria-expanded="false" aria-controls="hs-pro-eakcphds"
          data-hs-collapse="#hs-pro-eakcphds">
          <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.3-4.3"></path>
          </svg>
          <span class="sr-only">Search</span>
        </button>
        <!-- End Search -->

        <!-- Input -->
        <div class="relative hidden md:block">
          <div class="absolute inset-y-0 start-0 flex items-center pointer-events-none z-10 ps-2">
            <svg class="shrink-0 size-4 text-gray-800 dark:text-neutral-200" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </svg>
          </div>
          <input type="text"
            class="py-1 px-8 block w-full bg-white border-0 rounded-lg md:text-[13px] hover:bg-gray-100 placeholder:text-gray-800 focus:outline-hidden focus:ring-0 focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:text-neutral-400 dark:hover:bg-neutral-800 dark:focus:bg-neutral-800 dark:placeholder:text-neutral-200"
            placeholder="Search for season or episode">
          <div class="hidden absolute inset-y-0 end-0 flex items-center z-10 pe-1">
            <button type="button"
              class="inline-flex shrink-0 justify-center items-center size-6 rounded-full text-gray-500 hover:text-primary-600 focus:outline-hidden focus:text-primary-600 dark:text-neutral-500 dark:hover:text-primary-500 dark:focus:text-primary-500">
              <span class="sr-only">Close</span>
              <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="m15 9-6 6"></path>
                <path d="m9 9 6 6"></path>
              </svg>
            </button>
          </div>
        </div>
        <!-- End Input -->
      </div>
    </div>

    <button aria-haspopup="dialog" aria-expanded="false" aria-controls="create-season" data-hs-overlay="#create-season"
      @click="$nextTick(() => {
      $refs.seasontitle.focus();
      $refs.seasontitle.click();
      const len = $refs.seasontitle.value.length;
      $refs.seasontitle.setSelectionRange(len, len);
    })" type="button"
      class="py-[7px] px-2 inline-flex items-center gap-x-1 text-xs font-medium rounded-lg border border-transparent bg-primary-600 text-white hover:bg-primary-700 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:ring-2 focus:ring-primary-500"
      data-hs-overlay="#hs-pro-dshm" aria-expanded="false">
      <svg class="shrink-0 size-3.5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 12h14"></path>
        <path d="M12 5v14"></path>
      </svg>
      Add new season
    </button>
  </div>
  <div class="-ms-1 px-2">
    <div id="hs-pro-eakcphds" class="hs-collapse hidden w-full overflow-hidden transition-[height] duration-300"
      aria-labelledby="hs-basic-collapse">
      <div class="py-1.5">
        <!-- Input -->
        <div class="relative">
          <div class="absolute inset-y-0 start-0 flex items-center pointer-events-none z-10 ps-1.5">
            <svg class="shrink-0 size-4 text-gray-800 dark:text-neutral-200" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </svg>
          </div>
          <input type="text"
            class="py-1 px-7 block w-full bg-white border-0 rounded-lg md:text-[13px] hover:bg-gray-100 placeholder:text-gray-800 focus:outline-hidden focus:ring-0 focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:text-neutral-400 dark:hover:bg-neutral-800 dark:focus:bg-neutral-800 dark:placeholder:text-neutral-200"
            placeholder="Search">
          <div class="hidden absolute inset-y-0 end-0 flex items-center z-20 pe-1">
            <button type="button"
              class="inline-flex shrink-0 justify-center items-center size-6 rounded-full text-gray-500 hover:text-teal-600 focus:outline-hidden focus:text-teal-600 dark:text-neutral-500 dark:hover:text-teal-500 dark:focus:text-teal-500">
              <span class="sr-only">Close</span>
              <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="m15 9-6 6"></path>
                <path d="m9 9 6 6"></path>
              </svg>
            </button>
          </div>
        </div>
        <!-- End Input -->
      </div>
    </div>
  </div>

  <div class="p-2 mt-2">
    <div
      class="pb-12 mb-12 border-b border-gray-200 md:last:pb-0 md:last:mb-0 md:last:border-b-0 dark:border-neutral-700 pt-2 md:pt-4 pb-10 border-t border-gray-200 dark:border-neutral-700"
      x-data="{showMoreEpisodes:false}">
      <!-- Heading -->
      <div class="mb-4 flex items-center gap-2">
        <div class="grow">
          <h2 class="font-medium text-gray-800 dark:text-neutral-200">
            Season 1: Days Gone Bye (6 Episodes)
          </h2>
        </div>
        <!-- Segment Button Group -->
        <div
          class="inline-block p-0.5 bg-white border border-gray-200 rounded-lg shadow-sm transition ease-out dark:bg-neutral-800 dark:border-neutral-700">
          <div class="flex items-center">
            <div class="hs-tooltip relative inline-block">
              <button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="create-episode"
                data-hs-overlay="#create-episode"
                class="hs-tooltip-toggle size-7 flex shrink-0 justify-center items-center text-gray-500 hover:bg-gray-100 hover:text-gray-800 rounded disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:bg-gray-100 dark:hover:bg-neutral-700 dark:text-neutral-400 dark:focus:bg-neutral-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="shrink-0 size-4">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>
              </button>
              <span
                class="hs-tooltip-content hs-tooltip-shown:opacity-100 hs-tooltip-shown:visible opacity-0 inline-block absolute invisible z-20 py-1.5 px-2.5 bg-gray-900 text-xs text-white rounded-lg dark:bg-neutral-700"
                role="tooltip">
                Add new episode
              </span>
            </div>
            <div class="hs-tooltip relative inline-block">
              <button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="edit-season"
                data-hs-overlay="#edit-season"
                class="hs-tooltip-toggle size-7 flex shrink-0 justify-center items-center text-gray-500 hover:bg-gray-100 hover:text-gray-800 rounded disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:bg-gray-100 dark:hover:bg-neutral-700 dark:text-neutral-400 dark:focus:bg-neutral-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="shrink-0 size-4">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                </svg>
              </button>
              <span
                class="hs-tooltip-content hs-tooltip-shown:opacity-100 hs-tooltip-shown:visible opacity-0 inline-block absolute invisible z-20 py-1.5 px-2.5 bg-gray-900 text-xs text-white rounded-lg dark:bg-neutral-700"
                role="tooltip">
                Edit this season
              </span>
            </div>
            <div class="hs-tooltip relative inline-block">
              <button aria-haspopup="dialog" aria-expanded="false" aria-controls="delete-season"
                data-hs-overlay="#delete-season" type="button"
                class="hs-tooltip-toggle size-7 flex shrink-0 justify-center items-center text-gray-500 hover:bg-gray-100 hover:text-gray-800 rounded disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:bg-gray-100 dark:hover:bg-neutral-700 dark:text-neutral-400 dark:focus:bg-neutral-700">
                <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round">
                  <rect width="20" height="5" x="2" y="4" rx="2"></rect>
                  <path d="M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9"></path>
                  <path d="M10 13h4"></path>
                </svg>
              </button>
              <span
                class="hs-tooltip-content hs-tooltip-shown:opacity-100 hs-tooltip-shown:visible opacity-0 inline-block absolute invisible z-20 py-1.5 px-2.5 bg-gray-900 text-xs text-white rounded-lg dark:bg-neutral-700"
                role="tooltip">
                Remove this season
              </span>
            </div>
          </div>
        </div>
        <!-- End Segment Button Group -->
      </div>
      <!-- End Heading -->

      <!-- Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-5 gap-3 lg:gap-5">
        <!-- Card -->
        {% for episode in season_1.slice(0,5) %}
        <div
          class="flex flex-col justify-between p-1 bg-white border border-gray-200 rounded-2xl dark:bg-neutral-900 dark:border-neutral-700">
          <div class="relative w-full">
            <img class="bg-gray-100 w-full object-cover rounded-xl dark:bg-neutral-800"
              src="{{ episode.thumbnail_img }}" alt="Store Image">
            <div class="absolute top-2 right-2 flex items-center bg-black bg-opacity-75 rounded-full p-1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"
                class="h-4 w-4 text-white">
                <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" />
                <path fill-rule="evenodd"
                  d="M1.38 8.28a.87.87 0 0 1 0-.566 7.003 7.003 0 0 1 13.238.006.87.87 0 0 1 0 .566A7.003 7.003 0 0 1 1.379 8.28ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
                  clip-rule="evenodd" />
              </svg>
              <span class="ml-1 text-white text-xs">{{ episode.view_count }}</span>
            </div>
          </div>
          <div class="p-4 space-y-1">
            <div class="flex space-x-2">
              <h2 class="font-medium text-sm text-gray-800 dark:text-neutral-200">
                {{ episode.title }}
              </h2>
              <div x-data="{
            popoverOpen: false,
            popoverArrow: true,
            popoverPosition: 'bottom',
            popoverHeight: 0,
            popoverOffset: 8,
            popoverHeightCalculate() {
                this.$refs.popover{{ episode.id }}.classList.add('invisible'); 
                this.popoverOpen=true; 
                let that=this;
                $nextTick(function(){ 
                    that.popoverHeight = that.$refs.popover{{ episode.id }}.offsetHeight;
                    that.popoverOpen=false; 
                    that.$refs.popover{{ episode.id }}.classList.remove('invisible');
                    that.$refs.popoverInner{{ episode.id }}.setAttribute('x-transition', '');
                    that.popoverPositionCalculate();
                });
            },
            popoverPositionCalculate(){
                if(window.innerHeight < (this.$refs.popoverButton{{ episode.id }}.getBoundingClientRect().top + this.$refs.popoverButton{{ episode.id }}.offsetHeight + this.popoverOffset + this.popoverHeight)){
                    this.popoverPosition = 'top';
                } else {
                    this.popoverPosition = 'bottom';
                }
            }
        }" x-init="
            that = this;
            window.addEventListener('resize', function(){
                popoverPositionCalculate();
            });
            $watch('popoverOpen', function(value){
                if(value){ popoverPositionCalculate(); }
            });
        " class="relative">

                <button x-ref="popoverButton{{ episode.id }}" @click="popoverOpen=!popoverOpen"
                  @mouseover="popoverOpen = true" @mouseleave="popoverOpen = false">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-4 h-5 text-gray-400 hover:cursor-pointer">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
                  </svg>
                </button>


                <div x-ref="popover{{ episode.id }}" x-show="popoverOpen"
                  x-init="setTimeout(function(){ popoverHeightCalculate(); }, 100);" x--trap.inert="popoverOpen"
                  @click.away="popoverOpen=false;" @keydown.escape.window="popoverOpen=false"
                  :class="{ 'top-0 mt-10' : popoverPosition == 'bottom', 'bottom-0 mb-10' : popoverPosition == 'top' }"
                  class="z-50 absolute w-[300px] max-w-lg -translate-x-1/2 left-1/2" x-cloak>
                  <div x-ref="popoverInner{{ episode.id }}" x-show="popoverOpen"
                    class="w-full p-4 bg-white border rounded-md shadow-sm border-neutral-200/70">
                    <div x-show="popoverArrow && popoverPosition == 'bottom'"
                      class="absolute top-0 inline-block w-5 mt-px overflow-hidden -translate-x-2 -translate-y-2.5 left-1/2">
                      <div
                        class="w-2.5 h-2.5 origin-bottom-left transform rotate-45 bg-white border-t border-l rounded-sm">
                      </div>
                    </div>
                    <div x-show="popoverArrow  && popoverPosition == 'top'"
                      class="absolute bottom-0 inline-block w-5 mb-px overflow-hidden -translate-x-2 translate-y-2.5 left-1/2">
                      <div
                        class="w-2.5 h-2.5 origin-top-left transform -rotate-45 bg-white border-b border-l rounded-sm">
                      </div>
                    </div>
                    <div class="grid gap-4">
                      <span class="text-gray-500 text-sm">{{ episode.short_description}}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div>
              <ul class="mt-1">
                <div class="text-sm">
                  <span class="font-medium text-gray-500 hover:cursor-pointer">{{ episode.duration }}</span>
                </div>
              </ul>
            </div>

            <div>
              <ul class="mt-1">
                <div class="text-sm">
                  {% for genre in episode.genres %}
                  <span class="font-medium text-gray-500 hover:cursor-pointer">{{ genre.name }}</span>
                  {% if genre.has_next %}
                  <span class="font-medium text-gray-500">·</span>
                  {% endif %}
                  {% endfor %}
                </div>
              </ul>
            </div>
          </div>
          <a href="/flimix/library/series/episodes/detail/"
            class="px-4 pb-4 mt-auto inline-flex items-center gap-x-1 text-sm text-gray-800 underline underline-offset-4 hover:text-primary-600 focus:outline-none focus:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400 dark:focus:text-primary-400">
            View Details
            <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6"></path>
            </svg>
          </a>
        </div>
        {% endfor %}
        <div id="season-1-more-episodes">
          <!-- Additional episodes will be loaded here -->
        </div>
      </div>
      <div class="flex justify-center mt-3">
        <a x-cloak x-show="!showMoreEpisodes" @click="showMoreEpisodes=!showMoreEpisodes"
          :hx-get="`${previewPath}/flimix/library/series/partials/season1_more_episodes/`"
          hx-target="#season-1-more-episodes" hx-swap="outerHTML"
          class="inline-flex items-center gap-x-1.5 text-xs text-gray-800 bg-white border border-gray-200 hover:bg-gray-100 py-1.5 px-2.5 rounded-full focus:outline-none focus:bg-gray-100 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-200 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700"
          href="#">
          Show all episodes
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" class="shrink-0 size-3.5 rotate-90">
            <path stroke-linecap="round" stroke-linejoin="round" d="m5.25 4.5 7.5 7.5-7.5 7.5m6-15 7.5 7.5-7.5 7.5" />
          </svg>
        </a>
      </div>
    </div>
    <div x-data="{showMoreEpisodes:false}">
      <div class="mb-4 flex items-center gap-2">

        <div class="grow">
          <h2 class="font-medium text-gray-800 dark:text-neutral-200">
            Season 2: Bloodletting (7 episodes)
          </h2>
        </div>
        <div
          class="inline-block p-0.5 bg-white border border-gray-200 rounded-lg shadow-sm transition ease-out dark:bg-neutral-800 dark:border-neutral-700">
          <div class="flex items-center">
            <div class="hs-tooltip relative inline-block">
              <button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="create-episode"
                data-hs-overlay="#create-episode"
                class="hs-tooltip-toggle size-7 flex shrink-0 justify-center items-center text-gray-500 hover:bg-gray-100 hover:text-gray-800 rounded disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:bg-gray-100 dark:hover:bg-neutral-700 dark:text-neutral-400 dark:focus:bg-neutral-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="shrink-0 size-4">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>
              </button>
              <span
                class="hs-tooltip-content hs-tooltip-shown:opacity-100 hs-tooltip-shown:visible opacity-0 inline-block absolute invisible z-20 py-1.5 px-2.5 bg-gray-900 text-xs text-white rounded-lg dark:bg-neutral-700"
                role="tooltip">
                Add new episode
              </span>
            </div>
            <div class="hs-tooltip relative inline-block">
              <button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="edit-season"
                data-hs-overlay="#edit-season"
                class="hs-tooltip-toggle size-7 flex shrink-0 justify-center items-center text-gray-500 hover:bg-gray-100 hover:text-gray-800 rounded disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:bg-gray-100 dark:hover:bg-neutral-700 dark:text-neutral-400 dark:focus:bg-neutral-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="shrink-0 size-4">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                </svg>
              </button>
              <span
                class="hs-tooltip-content hs-tooltip-shown:opacity-100 hs-tooltip-shown:visible opacity-0 inline-block absolute invisible z-20 py-1.5 px-2.5 bg-gray-900 text-xs text-white rounded-lg dark:bg-neutral-700"
                role="tooltip">
                Edit this season
              </span>
            </div>
            <div class="hs-tooltip relative inline-block">
              <button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="delete-season"
                data-hs-overlay="#delete-season"
                class="hs-tooltip-toggle size-7 flex shrink-0 justify-center items-center text-gray-500 hover:bg-gray-100 hover:text-gray-800 rounded disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:bg-gray-100 dark:hover:bg-neutral-700 dark:text-neutral-400 dark:focus:bg-neutral-700">
                <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round">
                  <rect width="20" height="5" x="2" y="4" rx="2"></rect>
                  <path d="M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9"></path>
                  <path d="M10 13h4"></path>
                </svg>
              </button>
              <span
                class="hs-tooltip-content hs-tooltip-shown:opacity-100 hs-tooltip-shown:visible opacity-0 inline-block absolute invisible z-20 py-1.5 px-2.5 bg-gray-900 text-xs text-white rounded-lg dark:bg-neutral-700"
                role="tooltip">
                Remove this season
              </span>
            </div>
          </div>
        </div>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-5 gap-3 lg:gap-5">
        <!-- Card -->
        {% for episode in season_2.slice(0,5) %}
        <div
          class="flex flex-col justify-between p-1 bg-white border border-gray-200 rounded-2xl dark:bg-neutral-900 dark:border-neutral-700">
          <div class="relative w-full">
            <img class="bg-gray-100 w-full object-cover rounded-xl dark:bg-neutral-800"
              src="{{ episode.thumbnail_img }}" alt="Store Image">
            <div class="absolute top-2 right-2 flex items-center bg-black bg-opacity-75 rounded-full p-1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"
                class="h-4 w-4 text-white">
                <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" />
                <path fill-rule="evenodd"
                  d="M1.38 8.28a.87.87 0 0 1 0-.566 7.003 7.003 0 0 1 13.238.006.87.87 0 0 1 0 .566A7.003 7.003 0 0 1 1.379 8.28ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
                  clip-rule="evenodd" />
              </svg>
              <span class="ml-1 text-white text-xs">{{ episode.view_count }}</span>
            </div>
          </div>
          <div class="p-4 space-y-1">
            <div class="flex space-x-2">
              <h2 class="font-medium text-sm text-gray-800 dark:text-neutral-200">
                {{ episode.title }}
              </h2>
              <div x-data="{
          popoverOpen: false,
          popoverArrow: true,
          popoverPosition: 'bottom',
          popoverHeight: 0,
          popoverOffset: 8,
          popoverHeightCalculate() {
              this.$refs.popover{{ episode.id }}.classList.add('invisible'); 
              this.popoverOpen=true; 
              let that=this;
              $nextTick(function(){ 
                  that.popoverHeight = that.$refs.popover{{ episode.id }}.offsetHeight;
                  that.popoverOpen=false; 
                  that.$refs.popover{{ episode.id }}.classList.remove('invisible');
                  that.$refs.popoverInner{{ episode.id }}.setAttribute('x-transition', '');
                  that.popoverPositionCalculate();
              });
          },
          popoverPositionCalculate(){
              if(window.innerHeight < (this.$refs.popoverButton{{ episode.id }}.getBoundingClientRect().top + this.$refs.popoverButton{{ episode.id }}.offsetHeight + this.popoverOffset + this.popoverHeight)){
                  this.popoverPosition = 'top';
              } else {
                  this.popoverPosition = 'bottom';
              }
          }
      }" x-init="
          that = this;
          window.addEventListener('resize', function(){
              popoverPositionCalculate();
          });
          $watch('popoverOpen', function(value){
              if(value){ popoverPositionCalculate(); }
          });
      " class="relative">

                <button x-ref="popoverButton{{ episode.id }}" @click="popoverOpen=!popoverOpen"
                  @mouseover="popoverOpen = true" @mouseleave="popoverOpen = false">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-4 h-5 text-gray-400 hover:cursor-pointer">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
                  </svg>
                </button>


                <div x-ref="popover{{ episode.id }}" x-show="popoverOpen"
                  x-init="setTimeout(function(){ popoverHeightCalculate(); }, 100);" x--trap.inert="popoverOpen"
                  @click.away="popoverOpen=false;" @keydown.escape.window="popoverOpen=false"
                  :class="{ 'top-0 mt-10' : popoverPosition == 'bottom', 'bottom-0 mb-10' : popoverPosition == 'top' }"
                  class="z-50 absolute w-[300px] max-w-lg -translate-x-1/2 left-1/2" x-cloak>
                  <div x-ref="popoverInner{{ episode.id }}" x-show="popoverOpen"
                    class="w-full p-4 bg-white border rounded-md shadow-sm border-neutral-200/70">
                    <div x-show="popoverArrow && popoverPosition == 'bottom'"
                      class="absolute top-0 inline-block w-5 mt-px overflow-hidden -translate-x-2 -translate-y-2.5 left-1/2">
                      <div
                        class="w-2.5 h-2.5 origin-bottom-left transform rotate-45 bg-white border-t border-l rounded-sm">
                      </div>
                    </div>
                    <div x-show="popoverArrow  && popoverPosition == 'top'"
                      class="absolute bottom-0 inline-block w-5 mb-px overflow-hidden -translate-x-2 translate-y-2.5 left-1/2">
                      <div
                        class="w-2.5 h-2.5 origin-top-left transform -rotate-45 bg-white border-b border-l rounded-sm">
                      </div>
                    </div>
                    <div class="grid gap-4">
                      <span class="text-gray-500 text-sm">{{ episode.short_description}}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div>
              <ul class="mt-1">
                <div class="text-sm">
                  <span class="font-medium text-gray-500 hover:cursor-pointer">{{ episode.duration }}</span>
                </div>
              </ul>
            </div>

            <div>
              <ul class="mt-1">
                <div class="text-sm">
                  {% for genre in episode.genres %}
                  <span class="font-medium text-gray-500 hover:cursor-pointer">{{ genre.name }}</span>
                  {% if genre.has_next %}
                  <span class="font-medium text-gray-500">·</span>
                  {% endif %}
                  {% endfor %}
                </div>
              </ul>
            </div>
          </div>
          <a href="/flimix/library/series/episodes/detail/"
            class="px-4 pb-4 mt-auto inline-flex items-center gap-x-1 text-sm text-gray-800 underline underline-offset-4 hover:text-primary-600 focus:outline-none focus:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400 dark:focus:text-primary-400">
            View Details
            <svg cass="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6"></path>
            </svg>
          </a>
        </div>
        {% endfor %}
        <div id="season-2-more-episodes">
          <!-- Additional episodes will be loaded here -->
        </div>
      </div>
      <div class="flex justify-center mt-3">
        <a x-cloak x-show="!showMoreEpisodes" @click="showMoreEpisodes=!showMoreEpisodes"
          :hx-get="`${previewPath}/flimix/library/series/partials/season2_more_episodes/`"
          hx-target="#season-2-more-episodes" hx-swap="outerHTML"
          class="inline-flex items-center gap-x-1.5 text-xs text-gray-800 bg-white border border-gray-200 hover:bg-gray-100 py-1.5 px-2.5 rounded-full focus:outline-none focus:bg-gray-100 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-200 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700"
          href="#">
          Show all episodes
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" class="shrink-0 size-3.5 rotate-90">
            <path stroke-linecap="round" stroke-linejoin="round" d="m5.25 4.5 7.5 7.5-7.5 7.5m6-15 7.5 7.5-7.5 7.5" />
          </svg>
        </a>
      </div>
    </div>
  </div>
</div>
{% include "./create_season.html" %}
{% include "./create_episode.html" %}
{% include "./edit_season.html" %}
{% include "./delete_season.html" %}