<div class="flex flex-col space-y-4 relative">
  <div class="flex justify-between items-center">
    <div class="text-xl md:text-2xl font-semibold text-gray-900">Courses</div>
  </div>
  <div x-data="{ selectedCategories: [], showAll: false, categories: getAllCategories() }" class="border-b border-gray-200">
    <div class="flex overflow-x-auto hide-scrollbar pb-1">
      <nav class="-mb-px flex space-x-2" aria-label="Category filters">

        <button 
          @click="selectedCategories.length === categories.length ? selectedCategories = [] : selectedCategories = categories.map(category => category.name)" 
          :class="selectedCategories.length === categories.length ? 'bg-blue-100 text-blue-600 border-blue-600' : 'bg-white text-gray-600 border-gray-300 hover:bg-blue-100'"
          class="snap-start inline-flex items-center gap-x-2 py-2 px-3 text-sm whitespace-nowrap border hover:text-blue-500 rounded-lg">
          All
        </button>

        {% for category in categories.slice(0, 6) %}
          <button 
            @click="selectedCategories.includes('{{ category.name }}') ? selectedCategories = selectedCategories.filter(c => c !== '{{ category.name }}') : selectedCategories.push('{{ category.name }}')" 
            :class="selectedCategories.includes('{{ category.name }}') ? 'bg-blue-100 text-blue-600 border-blue-600' : 'bg-white text-gray-600 border-gray-300 hover:bg-blue-100'"
            class="snap-start inline-flex items-center gap-x-2 py-2 px-3 text-sm whitespace-nowrap border hover:text-blue-500 rounded-lg">
            {{ category.name }}
          </button>
        {% endfor %}
        <button 
          @click="showAll = !showAll" 
          :class="showAll ? 'bg-blue-100 text-blue-600 border-blue-600' : 'bg-white text-gray-600 border-gray-300 hover:bg-blue-100'"
          class="snap-start inline-flex items-center gap-x-2 py-2 px-3 text-sm whitespace-nowrap border hover:text-blue-500 rounded-lg">
          View All
        </button>
      </nav>
    </div>
    {% if categories.length > 6 %}
    <div x-show="showAll" x-transition:enter="transition ease-out duration-300 transform" x-transition:enter-start="opacity-0 translate-y-2" x-transition:enter-end="opacity-100 translate-y-0" x-transition:leave="transition ease-in duration-200 transform" x-transition:leave-start="opacity-100 translate-y-0" x-transition:leave-end="opacity-0 translate-y-2" class="mt-2 bg-white shadow-lg rounded-lg p-4 w-1/3 absolute z-10 right-0 top-full mt-1">
      <div class="grid grid-cols-2 gap-2">
        {% for category in categories %}
          <button 
            @click="selectedCategories.includes('{{ category.name }}') ? selectedCategories = selectedCategories.filter(c => c !== '{{ category.name }}') : selectedCategories.push('{{ category.name }}')" 
            :class="selectedCategories.includes('{{ category.name }}') ? 'bg-blue-100 text-blue-600 border-blue-600' : 'bg-white text-gray-600 border-gray-300 hover:bg-blue-100'"
            class="snap-start inline-flex items-center gap-x-2 py-2 px-3 text-sm text-left overflow-hidden whitespace-normal border hover:text-blue-500 rounded-lg">
            {{ category.name }}
          </button>
        {% endfor %}
      </div>
      <button 
        @click="showAll = false" 
        class="mt-2 py-2 px-4 bg-blue-600 text-white rounded-full font-medium text-sm focus:outline-none transition duration-150 ease-in-out">
        Save & continue
      </button>
    </div>
    {% endif %}
  </div>
</div>

<script>
  function getAllCategories() {
    return [
      {
        "id":1,
        "name":"Free Courses"
      },
      {
        "id":2,
        "name":"NEET 2025"
      },
      {
        "id":3,
        "name":"UPSC Intensive Program"
      },
      {
        "id":4,
        "name":"Mains 2023 Courses"
      },
      {
        "id": 5,
        "name": "Mains 2024 Courses"
      },
      {
        "id": 6,
        "name": "Mains 2025 Courses"
      },
      {
        "id": 7,
        "name": "Prelims 2023 Courses"
      },
      {
        "id": 8,
        "name": "Prelims 2024 Courses"
      }
    ]
  }
</script>