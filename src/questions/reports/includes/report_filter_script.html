<script>
  function report_filter_components(){
    return {
      showFilterReport:false,
      exams : JSON.parse('{{ exam_data |dump |safe }}'),
      subjects : JSON.parse('{{ subjects |dump |safe }}'),
      chapters : JSON.parse('{{ chapters |dump |safe }}'),
      search_value: null,
      selected_filters:[],

      filterQuestionReport(key,value){
        const currentUrl = new URL(window.location);
        const searchParams = new URLSearchParams(currentUrl.search);
        searchParams.set(key, value);
        currentUrl.search = searchParams.toString();
        window.location.href = currentUrl.href;
      },

      isItemSelected(item,type) {
        return this.selected_filters.some(e => e.id === item.id && e.type === type);
      },

      addToSelectedFilter(filter,type){
        if (this.isItemSelected(filter,type)){
          return
        }
        filter.type = type;
        this.selected_filters.push(filter)
      },

      removeSelectedFilter(filter) {
       this.selected_filters = this.selected_filters.filter(item => item.id !== filter.id || item.type !== filter.type);
    },

    getSearchParameterValue() {
    const searchParams = new URLSearchParams(window.location.search);
    for (let [key, value] of searchParams) {
        if (key) {
            return value;
        }
    }
    return ;
  }
    }
  }
</script>
