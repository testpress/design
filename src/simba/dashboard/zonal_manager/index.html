---
role: "Zonal Manager"
view: "Dashboard"
permalink: simba/{{ role | lower | slugify }}/dashboard/
tags: simba
user:
  first_name: James
  category: staff
  franchisemember: true
---
{% extends "../base_dashboard.html" %}

{% block extra_head %}
<link rel="stylesheet" href="{{ '/node_modules/apexcharts/dist/apexcharts.css' | url }}">
<style type="text/css">
  .apexcharts-tooltip.apexcharts-theme-light
  {
    background-color: transparent !important;
    border: none !important;
    box-shadow: none !important;
  }
</style>
{% endblock extra_head %}

{% block greeting %}
  Good morning, {{ user.first_name }}.
{% endblock greeting %}
{% block subtext %}
Here’s how your zone is performing this month.
{% endblock subtext %}
{% block cta_action %}
<div class="flex justify-end items-center gap-x-2">
<!-- Download Dropdown -->
<div class="hs-dropdown [--auto-close:inside] [--placement:top-right] relative inline-flex">
  <button id="month" type="button" class="py-2 px-2.5 inline-flex items-center gap-x-1.5 text-xs font-medium rounded-lg border border-stone-200 bg-white text-stone-800 shadow-2xs hover:bg-stone-50 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-stone-50 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700" aria-haspopup="menu" aria-expanded="false" aria-label="Dropdown">
    This Month
    <svg class="shrink-0 size-3.5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
  </button>

  <!-- Download Dropdown -->
  <div class="hs-dropdown-menu hs-dropdown-open:opacity-100 w-auto transition-[opacity,margin] duration opacity-0 hidden z-10 bg-white rounded-xl shadow-xl dark:bg-neutral-900" role="menu" aria-orientation="vertical" aria-labelledby="month">
    <div class="p-1 space-y-0.5" x-data="{
      months: [],
      init() {
        const now = new Date();
        for (let i = 0; i < 12; i++) {
          const date = new Date(now.getFullYear(), now.getMonth() - i, 1);
          const label = i === 0 ? 'This Month' : date.toLocaleString('default', { month: 'long', year: 'numeric' });
          this.months.push(label);
        }
      }
    }">
    <template x-for="month in months" :key="month">
      <a href="#" class="w-full flex gap-x-3 py-2 px-3 rounded-lg text-sm text-gray-800 hover:bg-gray-100 dark:text-neutral-300 dark:hover:bg-neutral-800 focus:outline-hidden focus:bg-gray-100 dark:focus:bg-neutral-800">
        <span x-text="month"></span>
      </a>
    </template>
    </div>
  </div>
  <!-- End Download Dropdown -->
</div>
<!-- End Download Dropdown -->
<!-- End Download Dropdown -->
</div>
{% endblock cta_action %}
{% block dashboard_content %}
{% include './stats.html' %}
{% include './performance_chart.html' %}
{% include './product_wise_performance.html' %}
<div class="grid grid-cols-1 sm:grid-cols-2 gap-2 md:gap-3 lg:gap-5">

</div>

<!-- End Stats Grid -->
{% endblock dashboard_content %}


{% block extra_scripts %}
<script src="/node_modules/preline/dist/preline.js"></script>
<script src="{{ '/node_modules/lodash/lodash.min.js' | url }}"></script>
<script src="{{ '/node_modules/apexcharts/dist/apexcharts.min.js' | url }}"></script>
<script src="https://preline.co/pro/assets/js/hs-apexcharts-helpers.js"></script>
<script>
  window.addEventListener('load', () => {
    // Apex Orders Bar Chart
    (function () {
      const branch_performance = [
        { branch: 'Tiruppur', target: 4000, achieved: 3800 },     // 95%
        { branch: 'Trichy', target: 3000, achieved: 2900 },       // 96.6%
        { branch: 'Chidambaram', target: 6000, achieved: 3300 },  // 55%
        { branch: 'Tiruvanamalai', target: 2500, achieved: 1400 },// 56%
        { branch: 'Namakkal', target: 3500, achieved: 1800 },     // 51%
        { branch: 'Nagercoil', target: 5000, achieved: 4200 },    // 84%
        { branch: 'Coimbatore', target: 4500, achieved: 3000 },   // 66.6%
      ];

      const sortedData = branch_performance
        .map(item => ({
          ...item,
          percentage: (item.achieved / item.target) * 100
        }))
        .sort((a, b) => b.percentage - a.percentage);

      const categories = sortedData.map(item => item.branch);
      const targetData = sortedData.map(item => item.target);
      const achievedData = sortedData.map(item => item.achieved);

      const achievedColors = sortedData.map(item =>
        item.percentage >= 60 ? '#16a34a' : '#dc2626'
      );
      console.log(achievedColors)

      buildChart('#hs-orders-bar-chart', (mode) => ({
        chart: {
          type: 'bar',
          height: 250,
          toolbar: {
            show: false
          },
          zoom: {
            enabled: false
          }
        },
        series: [
          { name: 'Target', data: targetData },
          { name: 'Achieved', data: achievedData }
        ],
        colors: ['#3b82f6', "#3b82f6"],
        plotOptions: {
          bar: {
            horizontal: false,
            columnWidth: '14px',
            borderRadius: 0,
          }
        },
        legend: {
          show: false
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          show: true,
          width: 2,
          colors: ['transparent']
        },
        xaxis: {
          categories: categories,
          axisBorder: {
            show: false
          },
          axisTicks: {
            show: false
          },
          crosshairs: {
            show: false
          },
          labels: {
            style: {
              colors: '#a8a29e',
              fontSize: '13px',
              fontFamily: 'Inter, ui-sans-serif',
              fontWeight: 400
            },
            offsetX: -2,
            formatter: (title) => title
          }
        },
        yaxis: {
          labels: {
            align: 'left',
            minWidth: 0,
            maxWidth: 140,
            style: {
              colors: '#a8a29e',
              fontSize: '13px',
              fontFamily: 'Inter, ui-sans-serif',
              fontWeight: 400
            },
            formatter: (value) => value >= 1000 ? `${value / 1000}k` : value
          }
        },
        tooltip: {
  custom: function({ series, seriesIndex, dataPointIndex, w }) {
    const label = w.globals.labels[dataPointIndex];
    const target = series[0][dataPointIndex];
    const achieved = series[1][dataPointIndex];
    const achievedPercent = (achieved / target) * 100;
    const achievedColor = achievedPercent >= 60 ? '#16a34a' : '#dc2626';

    return `
      <div class="border border-gray-200 dark:border-neutral-800 bg-white rounded-xl shadow-xl w-36">
        <div class="px-2 py-1.5 font-semibold text-[13px] flex items-center">
            <span>${label}</span>
            <span class="ms-auto">${achievedPercent.toFixed(0)}%</span>
        </div>
        <div class="border-t border-gray-200 dark:border-neutral-800"></div>
        <div class="space-y-1.5 p-2">
          <div class="flex items-center gap-x-2 text-xs text-stone-600">
            <span class="w-3 h-3 bg-blue-500 rounded-sm inline-block"></span>
            <span class="">Target</span>
            <span class="ms-auto">₹${target}</span>
          </div>
          <div class="flex items-center gap-x-2  text-xs text-stone-600">
            <span class="w-3 h-3 rounded-sm inline-block" style="background:${achievedColor}"></span>
            <span class="">Achieved</span>
            <span class="ms-auto">₹${achieved}</span>
          </div>
        </div>
      </div
    `;
  }
},


        states: {
          hover: {
            filter: {
              type: 'darken',
              value: 0.9
            }
          }
        },
        responsive: [{
          breakpoint: 568,
          options: {
            chart: {
              height: 300
            },
            plotOptions: {
              bar: {
                columnWidth: '14px'
              }
            },
            stroke: {
              width: 10
            },
            responsive: [{
              breakpoint: 568,
              options: {
                chart: {
                  height: 300
                },
                plotOptions: {
                  bar: {
                    columnWidth: '14px'
                  }
                },
                stroke: {
                  width: 10
                },
                labels: {
                  style: {
                    colors: '#a8a29e',
                    fontSize: '11px',
                    fontFamily: 'Inter, ui-sans-serif',
                    fontWeight: 400
                  },
                  offsetX: -2,
                  formatter: (title) => title.slice(0, 3)
                },
                yaxis: {
                  labels: {
                    align: 'left',
                    minWidth: 0,
                    maxWidth: 140,
                    style: {
                      colors: '#a8a29e',
                      fontSize: '11px',
                      fontFamily: 'Inter, ui-sans-serif',
                      fontWeight: 400
                    },
                    formatter: (value) => value >= 1000 ? `${value / 1000}k` : value
                  }
                },
              },
            }]
          },
        }]
      }), {
        fill: {
        colors: [({ seriesIndex, dataPointIndex, w }) => {
          if (seriesIndex === 1) { // Achieved series (2nd series)
            const percentage = (achievedData[dataPointIndex] / targetData[dataPointIndex]) * 100;
            return percentage >= 60 ? '#16a34a' : '#dc2626';
          }
          return '#3b82f6'; // Target series (1st series)
        }]
      },
        grid: {
          borderColor: '#e5e5e5'
        },
        xaxis: {
          labels: {
            style: {
              colors: '#a8a29e',
            }
          }
        },
        yaxis: {
          labels: {
            style: {
              colors: '#a8a29e'
            }
          }
        }
      }, {
        colors: ['#22c55e', '#737373'],
        grid: {
          borderColor: '#404040'
        },
        xaxis: {
          labels: {
            style: {
              colors: '#a3a3a3',
            }
          }
        },
        yaxis: {
          labels: {
            style: {
              colors: '#a3a3a3'
            }
          }
        }
      });
    })();
  });


</script>
{% endblock extra_scripts %}