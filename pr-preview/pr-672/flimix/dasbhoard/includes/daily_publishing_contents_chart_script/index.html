<script src="https://preline.co/pro/assets/vendor/lodash/lodash.min.js"></script>
<script src="https://preline.co/pro/assets/vendor/apexcharts/dist/apexcharts.min.js"></script>
<script src="https://preline.co/pro/assets/js/hs-apexcharts-helpers.js"></script>

<script>
  window.addEventListener('load', () => {
    // Generate last 7 days dates
    const today = new Date();
    const dates = [];
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    
    for (let i = 6; i >= 0; i--) {
      const date = new Date(today);
      date.setDate(today.getDate() - i);
      dates.push(date.getDate() + ' ' + months[date.getMonth()]);
    }

    // Data for last 7 days of content publishing
    const videoData = [8, 12, 9, 15, 11, 7, 10];
    const audioData = [5, 8, 7, 10, 6, 4, 8];
    const booksData = [3, 4, 5, 3, 6, 4, 4];

    // Apex Daily Publishing Contents Bar Chart
    (function () {
      buildChart('#hs-daily-publishing-contents-chart', (mode) => ({
        chart: {
          type: 'bar',
          height: 300,
          toolbar: {
            show: false
          },
          zoom: {
            enabled: false
          }
        },
        series: [
          {
            name: 'Video',
            data: videoData
          }, 
          {
            name: 'Audio',
            data: audioData
          },
          {
            name: 'Books',
            data: booksData
          }
        ],
        colors: ['#3b82f6', '#10b981', '#f97316'],
        plotOptions: {
          bar: {
            horizontal: false,
            columnWidth: '70%',
            borderRadius: 2,
          }
        },
        legend: {
          show: true,
          position: 'top',
          horizontalAlign: 'right',
          fontSize: '13px',
          fontFamily: 'Inter, ui-sans-serif',
          fontWeight: 400,
          markers: {
            width: 10,
            height: 10,
            radius: 2
          },
          itemMargin: {
            horizontal: 12,
            vertical: 0
          }
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          show: true,
          width: 2,
          colors: ['transparent']
        },
        xaxis: {
          categories: dates,
          axisBorder: {
            show: false
          },
          axisTicks: {
            show: false
          },
          crosshairs: {
            show: false
          },
          labels: {
            style: {
              colors: '#a8a29e',
              fontSize: '13px',
              fontFamily: 'Inter, ui-sans-serif',
              fontWeight: 400
            },
            offsetX: -2
          }
        },
        yaxis: {
          labels: {
            align: 'left',
            minWidth: 0,
            maxWidth: 140,
            style: {
              colors: '#a8a29e',
              fontSize: '13px',
              fontFamily: 'Inter, ui-sans-serif',
              fontWeight: 400
            },
            formatter: (value) => value >= 1000 ? `${value / 1000}k` : value
          }
        },
        tooltip: {
          custom: function (props) {
            const { categories } = props.ctx.opts.xaxis;
            const { dataPointIndex } = props;

            return buildTooltip(props, {
              title: categories[dataPointIndex],
              mode,
              hasCategory: false,
              hasTextLabel: true,
              wrapperExtClasses: 'min-w-36',
              isValueDivided: false,
              valuePrefix: '',
              labelDivider: ':',
              labelExtClasses: 'ms-2'
            });
          }
        },
        states: {
          hover: {
            filter: {
              type: 'darken',
              value: 0.9
            }
          }
        },
        responsive: [{
          breakpoint: 568,
          options: {
            chart: {
              height: 250
            },
            plotOptions: {
              bar: {
                columnWidth: '70%'
              }
            },
            stroke: {
              width: 10
            },
            labels: {
              style: {
                colors: '#a8a29e',
                fontSize: '11px',
                fontFamily: 'Inter, ui-sans-serif',
                fontWeight: 400
              },
              offsetX: -2
            },
            yaxis: {
              labels: {
                align: 'left',
                minWidth: 0,
                maxWidth: 140,
                style: {
                  colors: '#a8a29e',
                  fontSize: '11px',
                  fontFamily: 'Inter, ui-sans-serif',
                  fontWeight: 400
                },
                formatter: (value) => value >= 1000 ? `${value / 1000}k` : value
              }
            },
          },
        }]
      }), {
        colors: ['#3b82f6', '#10b981', '#f97316'],
        grid: {
          borderColor: '#e5e5e5'
        },
        xaxis: {
          labels: {
            style: {
              colors: '#a8a29e',
            }
          }
        },
        yaxis: {
          labels: {
            style: {
              colors: '#a8a29e'
            }
          }
        }
      }, {
        colors: ['#3b82f6', '#10b981', '#f97316'],
        grid: {
          borderColor: '#404040'
        },
        xaxis: {
          labels: {
            style: {
              colors: '#a3a3a3',
            }
          }
        },
        yaxis: {
          labels: {
            style: {
              colors: '#a3a3a3'
            }
          }
        }
      });
    })();
  });
</script>
