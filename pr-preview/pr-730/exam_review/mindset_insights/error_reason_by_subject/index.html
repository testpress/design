<div class="flex flex-col bg-white border border-gray-200 shadow-2xs rounded-xl" x-cloak
  x-show="!loading.errors && errorSummaryForChart.bySubject && errorSummaryForChart.bySubject.length > 0">
  <div class="py-3 px-5 border-b border-gray-200 flex justify-between items-center">
    <h2 class="text-base font-semibold text-gray-900">
      Error Breakdown by Subject
      <span
        x-show="selectedSectionId !== 'overall'"
        x-text="`(${sections.find(s => s.section_id === selectedSectionId)?.section_name || ''})`"
        class="text-gray-500 font-normal"
      ></span>
    </h2>
  </div>
  <div class="p-5">
    <p class="text-sm text-gray-500 mb-4">
      Finding the 'why' for each subject error in the selected section.
    </p>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
      <template x-for="topic in errorSummaryForChart.bySubject" :key="topic.id">
      <div class="p-4 border border-gray-200 rounded-lg">
          <h3 class="font-semibold text-gray-800" x-text="topic.name"></h3>
          <p class="text-sm text-gray-500" x-text="topic.errors + (topic.errors === 1 ? ' error' : ' errors') + ' reflected'"></p>
          <div x-show="topic.series.length > 0" class="flex flex-col sm:flex-row items-center gap-4 mt-2">
            <div class="flex-shrink-0">
              <div :id="'subject-chart-' + topic.id" class="min-h-[10rem] min-w-[10rem]"></div>
            </div>
            <ul class="space-y-1 w-full">
              <template x-for="(label, index) in topic.labels" :key="label">
                <li class="flex items-center justify-between text-sm">
                  <div class="flex items-center gap-x-2">
                    <span class="size-2.5 rounded-sm inline-block" :style="'background-color:' + topic.colors[index]"></span>
                    <span class="text-gray-600" x-text="label"></span>
                  </div>
                  <span class="font-medium text-gray-700" x-text="topic.series[index]"></span>
                </li>
              </template>
            </ul>
          </div>
          <div x-show="topic.errors === 0" class="mt-4 text-center py-5 bg-gray-50 rounded-lg">
            <p class="text-sm text-emerald-700 font-medium">No errors for this topic. Good work!</p>
          </div>
          <div x-show="topic.errors > 0 && topic.series.length === 0" class="mt-4 text-center py-5 bg-gray-50 rounded-lg">
            <p class="text-sm text-gray-500">No reflections were provided for the mistakes in this topic.</p>
          </div>
        </div>
      </template>
    </div>
  </div>
</div>