<!doctype html>
<html class=" ">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Eleventy v3.0.0">
  <title>Create Report Card</title>
  <link rel="stylesheet" href="/pr-preview/pr-703/css/tailwind.css" />
  
<link rel="stylesheet" href="https://rsms.me/inter/inter.css">
<script>
  tailwind.config = {
    theme: {
      extend: {
        fontFamily: {
          sans: ['Inter var',],
        },
      }
    }
  }
</script>
<style>
  [data-tooltip]:hover span {
    display: block;
  }
</style>
 

  <script defer src="https://unpkg.com/alpinejs@3.4.2/dist/cdn.min.js"></script>
  <script src="/node_modules/preline/dist/preline.js"></script>

   <style>
    [x-cloak] {
      display: none !important;
    }
  </style>
</head>



<body class="h-full overflow-y-scroll min-h-screen bg-gray-100">
  <div class="min-h-full" x-data="{ previewPath: window.location.pathname.match(/(\/pr-preview\/pr-\d+)?/)[0] || '' }">
    <nav class="bg-white shadow-sm" x-data="{open: false}">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex">
          <div class="flex-shrink-0 flex items-center">
            <img class="block lg:hidden h-8 w-auto"
              src="https://brilliantpala.org/wp-content/uploads/2021/12/brilliant-logo-2.webp" alt="Workflow">
            <img class="hidden lg:block h-8 w-auto"
              src="https://brilliantpala.org/wp-content/uploads/2021/12/brilliant-logo-2.webp" alt="Workflow">
          </div>
          <div class="hidden lg:flex sm:-my-px sm:ml-6 sm:space-x-8">
            <!-- Current: "border-indigo-500 text-gray-900", Default: "border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" -->
            <a href="#"
              class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Courses</a>

            <a href="#"
              class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Exams</a>

              <a href="/pr-preview/pr-703/questions/reports"
              class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Questions</a>

              <div class="relative inline-block flex" x-data="{showdropdown:false}">
                <div class="flex">
                  <button type="button" @click="showdropdown=!showdropdown" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                    <p class="ml-2 whitespace-nowrap">Memberships</p>
                    <svg class="ml-2 h-5 w-5 flex-none text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"></path>
                    </svg>
                  </button>
                  <div class="absolute right-0 z-50 w-48 origin-top-right top-full rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none" x-show="showdropdown" @click.away="showdropdown=false" style="display: none;">
                    <div class="py-1" role="none">
                      <!-- Active: "bg-gray-100 text-gray-900", Not Active: "text-gray-700" -->
                      <a href="#" class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 text-gray-900 hover:curson-pointer" role="menuitem" tabindex="-1" id="menu-item-0">Members Management</a>
                      <a href="#" class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 text-gray-900 hover:curson-pointer" role="menuitem" tabindex="-1" id="menu-item-1">Batch Management</a>
                      <a href="#" class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 text-gray-900 hover:curson-pointer" role="menuitem" tabindex="-1" id="menu-item-2">Roles management</a>
                    </div>
                  </div>
                </div>
              </div>

              <div class="relative inline-block flex" x-data="{showdropdown:false}">
                <div class="flex">
                  <button type="button" @click="showdropdown=!showdropdown" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                    <p class="ml-2 whitespace-nowrap">Evaluate</p>
                    <svg class="ml-2 h-5 w-5 flex-none text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"></path>
                    </svg>
                  </button>
                  <div class="absolute right-0 z-50 w-48 origin-top-right top-full rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none" x-show="showdropdown" @click.away="showdropdown=false" style="display: none;">
                    <div class="py-1" role="none">
                      <!-- Active: "bg-gray-100 text-gray-900", Not Active: "text-gray-700" -->
                      <a href="#" class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 text-gray-900 hover:curson-pointer" role="menuitem" tabindex="-1" id="menu-item-0">Exam Evaluations</a>
                      <a href="/pr-preview/pr-703/testpress/assignment_submissions/" class="text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100 hover:curson-pointer" role="menuitem" tabindex="-1" id="menu-item-1">Assignment Evaluations</a>
                    </div>
                  </div>
                </div>
              </div>
              

            <a href="/pr-preview/pr-703/doubts/"
              class="border-indigo-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
              aria-current="page">Doubts</a>

              <a href="/reported_forum_thread/"
              class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
              aria-current="page">Discussion</a>
          </div>
        </div>
        <div x-data="globalSearch()" x-init="watchSearchOpen" class="hidden lg:flex sm:ml-6 items-center">
          
          <button @click="search_open = true" type="button"
            class="bg-white p-1 mr-2 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            <span class="sr-only">Global search</span>
            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
            </svg>
          </button>
          <div x-cloak x-show="search_open" @keydown.window.escape="search_open = false" class="relative z-50" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
    x-transition:enter="ease-out duration-300"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="ease-in duration-200"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0">
  </div>

  <div class="fixed inset-0 z-10">
    <div class="m-3 flex h-[calc(100%-3.5rem)] min-h-[calc(100%-3.5rem)] items-center transition-all ease-out sm:mx-auto sm:w-full sm:max-w-lg">
<div @click.away="search_open = false;" class="relative transform overflow-hidden rounded-lg bg-white  text-left shadow-xl transition-all sm:my-8 sm:w-full">
    <!-- Input -->
    <div class="relative">
      <div class="pointer-events-none absolute inset-y-0 start-0 z-20 flex items-center pl-3">
        <svg class="w-4 h-4 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8" />
          <path d="m21 21-4.3-4.3" />
        </svg>
      </div>
      <input x-model="searchQuery" type="text" value="Refund" class="block w-full rounded-t-lg border-transparent border-b-stone-200 bg-white py-3 pl-10 pr-8 text-sm placeholder:text-stone-500 focus:border-transparent focus:border-b-stone-200 focus:outline-none focus:ring-0 disabled:pointer-events-none disabled:opacity-50" placeholder="Search or type a command" autofocus />
      <div class="pointer-events-none absolute inset-y-0 end-0 z-20 flex hidden items-center pr-1">
        <button type="button" class="inline-flex size-6 shrink-0 items-center justify-center rounded-full text-gray-500 hover:text-blue-600 focus:text-blue-600 focus:outline-none" aria-label="Close">
          <span class="sr-only">Close</span>
          <svg class="size-4 shrink-0" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10" />
            <path d="m15 9-6 6" />
            <path d="m9 9 6 6" />
          </svg>
        </button>
      </div>
    </div>
    <!-- End Input -->

    <!-- Body -->
    <div class="overflow-hidden">
      <!-- List Group -->
      <div :class="{'mb-4 border-b': searchQuery.trim().length > 0, 'pb-4 last:mb-0 last:border-0 last:pb-0': true}" class="border-stone-200 border-b last:mb-0 last:border-0 last:pb-0 p-4 shadow-sm">
        <span class="mb-2 block text-xs text-stone-500"> Filters </span>

        <div class="flex flex-wrap gap-1 sm:gap-2">
          <!-- Loop through filterItems -->
          <template x-for="(filter, index) in filterItems" :key="index">
            <a 
              :class="selectedFilters.includes(filter) ? 'bg-stone-200 text-stone-900' : ''" 
              class="inline-flex items-center gap-x-1.5 rounded-full border border-stone-200 px-2.5 py-1.5 text-xs text-stone-800 hover:bg-stone-200 focus:outline-none cursor-pointer" 
              href="#" 
              @click.prevent="selectedFilters.includes(filter) ? selectedFilters = selectedFilters.filter(f => f !== filter) : selectedFilters.push(filter)"
            >
              <span x-text="filter"></span>
            </a>
          </template>
        </div>
      </div>

      <div x-show="searchQuery.trim().length > 0" class="overflow-hidden overflow-y-auto max-h-98 mb-4 border-b pb-4 last:mb-0 last:border-0 last:pb-0 px-4 pt-2" style="max-height: 33rem;">
        <span class="mb-2 block text-xs text-stone-500 dark:text-neutral-500">Results </span>

        <!-- List Group -->
        <ul>
          <!-- Loop through results that have 'learning' in title or description -->
          <template x-for="(result, index) in results.filter(r => (r.title.toLowerCase().includes('learning') || r.description.toLowerCase().includes('learning')))" :key="result.id">
            <li class="py-3 flex items-center border-t border-gray-200 cursor-pointer group hover:bg-gray-200" :class="{ 'border-t': index !== 0 }">
              <!-- Icon based on type -->
              <span class="mr-3">
                <img :src="iconMapping[result.type]" class="w-10 h-10" alt="Live Stream">
              </span>
    
              <!-- Result content with highlighted 'learning' -->
              <div>
                <p class="truncate">
                  <a class="truncate font-semibold text-sm text-gray-800 hover:text-blue-600 decoration-2 hover:underline focus:outline-none focus:underline" href="#">
                    <span x-html="highlight(result.title)"></span>
                  </a>
                </p>
                <p class="text-sm text-gray-500" x-html="highlight(result.description)"></p>
                <span class="mt-2 py-0.5 px-2 inline-flex items-center gap-x-1.5 bg-white border border-gray-200 text-gray-800 text-xs rounded-lg group-hover:bg-white" x-show="result.tags">
                  <!-- SVG Icon -->
                  <svg class="shrink-0 size-3 text-sm text-gray-800" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z"></path>
                    <circle cx="7.5" cy="7.5" r=".5" fill="currentColor"></circle>
                  </svg>
                  <span class="mb-0.5" x-html="highlight(result.tags)"></span>
                </span> 
              </div>
            </li>
          </template>
        </ul>
        <!-- End List Group -->
      </div>
    </div>
    <!-- End Body -->
    <!-- Footer -->
    <div class="flex flex-wrap items-center justify-between gap-2 border-t border-stone-200 p-4">
      <div class="inline-flex items-center gap-x-2">
        <div class="flex size-5 flex-col items-center justify-center rounded border border-stone-200 bg-white text-xs uppercase text-stone-400 shadow-sm">
          <svg class="size-3 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="9 10 4 15 9 20" />
            <path d="M20 4v7a4 4 0 0 1-4 4H4" />
          </svg>
        </div>
        <span class="text-xs text-stone-400"> to close </span>
      </div>

      <div class="inline-flex items-center gap-x-4">
        <div class="inline-flex items-center gap-x-2">
          <div class="flex size-5 flex-col items-center justify-center rounded border border-stone-200 bg-white text-xs uppercase text-stone-400 shadow-sm">
            <svg class="size-3.5 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M22 14.596C21.828 15.1189 20.888 16 19.5969 16C18.3057 16 16.9265 14.6624 16.9265 12.8974V12.0687C16.9265 10.2373 18.2022 9.00142 19.5969 9.00142C20.9918 9.00142 21.7942 9.69876 22 10.5666M14.5417 10.3109C14.3233 9.6198 13.3292 8.96537 12.1831 9.00142C11.0374 9.03732 10.0119 9.83333 10.0119 10.777C10.0119 11.7208 10.6901 12.0632 12.1839 12.2081C13.6774 12.353 14.49 13.1331 14.5417 13.9596C14.5934 14.7861 13.8083 16 12.1839 16C10.7604 16 9.69525 14.6894 9.63548 13.9379M7.25295 14.7213C6.82726 15.5884 5.94455 15.9999 4.75814 15.9999C3.57172 15.9999 2 15.088 2 12.7831V12.1113C2 10.5911 3.16477 9.00113 4.75814 9.00113C6.35166 9.00113 7.41158 10.5059 7.25295 12.2838H2.47754" /></svg>
          </div>
          <span class="text-xs text-stone-400"> to select </span>
        </div>

        <div class="inline-flex items-center gap-x-2">
          <div class="flex size-5 flex-col items-center justify-center rounded border border-stone-200 bg-white text-xs uppercase text-stone-400 shadow-sm">
            <svg class="size-3 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 5v14" />
              <path d="m19 12-7 7-7-7" />
            </svg>
          </div>
          <div class="flex size-5 flex-col items-center justify-center rounded border border-stone-200 bg-white text-xs uppercase text-stone-400 shadow-sm">
            <svg class="size-3 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m5 12 7-7 7 7" />
              <path d="M12 19V5" />
            </svg>
          </div>
          <span class="text-xs text-stone-400"> to navigate </span>
        </div>
      </div>
    </div>
    <!-- End Footer -->
  </div>
</div>
</div>
</div>
          <button type="button"
            class="bg-white p-1 mr-2 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            <span class="sr-only">View notifications</span>
            <!-- Heroicon name: outline/bell -->
            <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
              stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
            </svg>
          </button>

          <!-- Profile dropdown -->
          <div @keydown.escape.stop="open = false;" @click.away="open=false" class="ml-3 relative">
            <div>
              <button type="button" @click="open=true"
                class="bg-white flex text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                id="user-menu-button" aria-expanded="false" aria-haspopup="true">
                <span class="sr-only">Open user menu</span>
                <img class="h-8 w-8 rounded-full"
                  src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
                  alt="">
              </button>
            </div>
            
            <!--
            Dropdown menu, show/hide based on menu state.

            Entering: "transition ease-out duration-200"
              From: "transform opacity-0 scale-95"
              To: "transform opacity-100 scale-100"
            Leaving: "transition ease-in duration-75"
              From: "transform opacity-100 scale-100"
              To: "transform opacity-0 scale-95"
          -->
            <div x-show="open" x-transition:enter="transition ease-out duration-200"
              x-transition:enter-start="transform opacity-0 scale-95"
              x-transition:enter-end="transform opacity-100 scale-100"
              x-transition:leave="transition ease-in duration-75"
              x-transition:leave-start="transform opacity-100 scale-100"
              x-transition:leave-end="transform opacity-0 scale-95"
              class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none"
              role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1">
              <!-- Active: "bg-gray-100", Not Active: "" -->
              <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1"
                id="user-menu-item-0">Your Profile</a>

              <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1"
                id="user-menu-item-1">Settings</a>

              <a href="#" class="block px-4 py-2 text-sm text-gray-700" role="menuitem" tabindex="-1"
                id="user-menu-item-2">Sign out</a>
            </div>
          </div>
        </div>
        <div x-data="globalSearch()" x-init="watchSearchOpen" @keydown.escape.stop="open = false;" @click.away="open=false" class="space-x-2 flex lg:hidden items-center">
          <!-- Mobile menu button -->
          <button type="button" @click="search_open = true" 
            class="bg-white inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            aria-controls="mobile-menu" aria-expanded="false">
            <span class="sr-only">Global search</span>
            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
            </svg>
          </button>  
          <div x-cloak x-show="search_open" @keydown.window.escape="search_open = false" class="relative z-50" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
    x-transition:enter="ease-out duration-300"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="ease-in duration-200"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0">
  </div>

  <div class="fixed inset-0 z-10">
    <div class="m-3 flex h-[calc(100%-3.5rem)] min-h-[calc(100%-3.5rem)] items-center transition-all ease-out sm:mx-auto sm:w-full sm:max-w-lg">
<div @click.away="search_open = false;" class="relative transform overflow-hidden rounded-lg bg-white  text-left shadow-xl transition-all sm:my-8 sm:w-full">
    <!-- Input -->
    <div class="relative">
      <div class="pointer-events-none absolute inset-y-0 start-0 z-20 flex items-center pl-3">
        <svg class="w-4 h-4 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8" />
          <path d="m21 21-4.3-4.3" />
        </svg>
      </div>
      <input x-model="searchQuery" type="text" value="Refund" class="block w-full rounded-t-lg border-transparent border-b-stone-200 bg-white py-3 pl-10 pr-8 text-sm placeholder:text-stone-500 focus:border-transparent focus:border-b-stone-200 focus:outline-none focus:ring-0 disabled:pointer-events-none disabled:opacity-50" placeholder="Search or type a command" autofocus />
      <div class="pointer-events-none absolute inset-y-0 end-0 z-20 flex hidden items-center pr-1">
        <button type="button" class="inline-flex size-6 shrink-0 items-center justify-center rounded-full text-gray-500 hover:text-blue-600 focus:text-blue-600 focus:outline-none" aria-label="Close">
          <span class="sr-only">Close</span>
          <svg class="size-4 shrink-0" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10" />
            <path d="m15 9-6 6" />
            <path d="m9 9 6 6" />
          </svg>
        </button>
      </div>
    </div>
    <!-- End Input -->

    <!-- Body -->
    <div class="overflow-hidden">
      <!-- List Group -->
      <div :class="{'mb-4 border-b': searchQuery.trim().length > 0, 'pb-4 last:mb-0 last:border-0 last:pb-0': true}" class="border-stone-200 border-b last:mb-0 last:border-0 last:pb-0 p-4 shadow-sm">
        <span class="mb-2 block text-xs text-stone-500"> Filters </span>

        <div class="flex flex-wrap gap-1 sm:gap-2">
          <!-- Loop through filterItems -->
          <template x-for="(filter, index) in filterItems" :key="index">
            <a 
              :class="selectedFilters.includes(filter) ? 'bg-stone-200 text-stone-900' : ''" 
              class="inline-flex items-center gap-x-1.5 rounded-full border border-stone-200 px-2.5 py-1.5 text-xs text-stone-800 hover:bg-stone-200 focus:outline-none cursor-pointer" 
              href="#" 
              @click.prevent="selectedFilters.includes(filter) ? selectedFilters = selectedFilters.filter(f => f !== filter) : selectedFilters.push(filter)"
            >
              <span x-text="filter"></span>
            </a>
          </template>
        </div>
      </div>

      <div x-show="searchQuery.trim().length > 0" class="overflow-hidden overflow-y-auto max-h-98 mb-4 border-b pb-4 last:mb-0 last:border-0 last:pb-0 px-4 pt-2" style="max-height: 33rem;">
        <span class="mb-2 block text-xs text-stone-500 dark:text-neutral-500">Results </span>

        <!-- List Group -->
        <ul>
          <!-- Loop through results that have 'learning' in title or description -->
          <template x-for="(result, index) in results.filter(r => (r.title.toLowerCase().includes('learning') || r.description.toLowerCase().includes('learning')))" :key="result.id">
            <li class="py-3 flex items-center border-t border-gray-200 cursor-pointer group hover:bg-gray-200" :class="{ 'border-t': index !== 0 }">
              <!-- Icon based on type -->
              <span class="mr-3">
                <img :src="iconMapping[result.type]" class="w-10 h-10" alt="Live Stream">
              </span>
    
              <!-- Result content with highlighted 'learning' -->
              <div>
                <p class="truncate">
                  <a class="truncate font-semibold text-sm text-gray-800 hover:text-blue-600 decoration-2 hover:underline focus:outline-none focus:underline" href="#">
                    <span x-html="highlight(result.title)"></span>
                  </a>
                </p>
                <p class="text-sm text-gray-500" x-html="highlight(result.description)"></p>
                <span class="mt-2 py-0.5 px-2 inline-flex items-center gap-x-1.5 bg-white border border-gray-200 text-gray-800 text-xs rounded-lg group-hover:bg-white" x-show="result.tags">
                  <!-- SVG Icon -->
                  <svg class="shrink-0 size-3 text-sm text-gray-800" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z"></path>
                    <circle cx="7.5" cy="7.5" r=".5" fill="currentColor"></circle>
                  </svg>
                  <span class="mb-0.5" x-html="highlight(result.tags)"></span>
                </span> 
              </div>
            </li>
          </template>
        </ul>
        <!-- End List Group -->
      </div>
    </div>
    <!-- End Body -->
    <!-- Footer -->
    <div class="flex flex-wrap items-center justify-between gap-2 border-t border-stone-200 p-4">
      <div class="inline-flex items-center gap-x-2">
        <div class="flex size-5 flex-col items-center justify-center rounded border border-stone-200 bg-white text-xs uppercase text-stone-400 shadow-sm">
          <svg class="size-3 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="9 10 4 15 9 20" />
            <path d="M20 4v7a4 4 0 0 1-4 4H4" />
          </svg>
        </div>
        <span class="text-xs text-stone-400"> to close </span>
      </div>

      <div class="inline-flex items-center gap-x-4">
        <div class="inline-flex items-center gap-x-2">
          <div class="flex size-5 flex-col items-center justify-center rounded border border-stone-200 bg-white text-xs uppercase text-stone-400 shadow-sm">
            <svg class="size-3.5 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M22 14.596C21.828 15.1189 20.888 16 19.5969 16C18.3057 16 16.9265 14.6624 16.9265 12.8974V12.0687C16.9265 10.2373 18.2022 9.00142 19.5969 9.00142C20.9918 9.00142 21.7942 9.69876 22 10.5666M14.5417 10.3109C14.3233 9.6198 13.3292 8.96537 12.1831 9.00142C11.0374 9.03732 10.0119 9.83333 10.0119 10.777C10.0119 11.7208 10.6901 12.0632 12.1839 12.2081C13.6774 12.353 14.49 13.1331 14.5417 13.9596C14.5934 14.7861 13.8083 16 12.1839 16C10.7604 16 9.69525 14.6894 9.63548 13.9379M7.25295 14.7213C6.82726 15.5884 5.94455 15.9999 4.75814 15.9999C3.57172 15.9999 2 15.088 2 12.7831V12.1113C2 10.5911 3.16477 9.00113 4.75814 9.00113C6.35166 9.00113 7.41158 10.5059 7.25295 12.2838H2.47754" /></svg>
          </div>
          <span class="text-xs text-stone-400"> to select </span>
        </div>

        <div class="inline-flex items-center gap-x-2">
          <div class="flex size-5 flex-col items-center justify-center rounded border border-stone-200 bg-white text-xs uppercase text-stone-400 shadow-sm">
            <svg class="size-3 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 5v14" />
              <path d="m19 12-7 7-7-7" />
            </svg>
          </div>
          <div class="flex size-5 flex-col items-center justify-center rounded border border-stone-200 bg-white text-xs uppercase text-stone-400 shadow-sm">
            <svg class="size-3 shrink-0 text-stone-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m5 12 7-7 7 7" />
              <path d="M12 19V5" />
            </svg>
          </div>
          <span class="text-xs text-stone-400"> to navigate </span>
        </div>
      </div>
    </div>
    <!-- End Footer -->
  </div>
</div>
</div>
</div>      
          <button type="button" @click="open=!open"
            class="bg-white inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            aria-controls="mobile-menu" aria-expanded="false">
            <span class="sr-only">Open main menu</span>
            <!--
            Heroicon name: outline/menu

            Menu open: "hidden", Menu closed: "block"
          -->
            <svg :class="{ 'hidden': open, 'block': !open }" class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg"
              fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
            <!--
            Heroicon name: outline/x

            Menu open: "block", Menu closed: "hidden"
          -->
            <svg :class="{ 'hidden': !open, 'block': open }" class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg"
              fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu, show/hide based on menu state. -->
    <div x-show="open" class="lg:hidden" id="mobile-menu">
      <div class="pt-2 pb-3 space-y-1">
        <!-- Current: "bg-indigo-50 border-indigo-500 text-indigo-700", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800" -->
        <a href="#"
          class="bg-indigo-50 border-indigo-500 text-indigo-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium"
          aria-current="page">Courses</a>

        <a href="#"
          class="border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-base font-medium">Exams</a>

        <a href="#"
          class="border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-base font-medium">Videos</a>

        <a href="#"
          class="border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-base font-medium">Students</a>
      </div>
      <div class="pt-4 pb-3 border-t border-gray-200">
        <div class="flex items-center px-4">
          <div class="flex-shrink-0">
            <img class="h-10 w-10 rounded-full"
              src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
              alt="">
          </div>
          <div class="ml-3">
            <div class="text-base font-medium text-gray-800">Tom Cook</div>
            <div class="text-sm font-medium text-gray-500">tom@example.com</div>
          </div>
          <button type="button"
            class="ml-auto bg-white flex-shrink-0 p-1 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            <span class="sr-only">View notifications</span>
            <!-- Heroicon name: outline/bell -->
            <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
              stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
            </svg>
          </button>
        </div>
        <div class="mt-3 space-y-1">
          <a href="#"
            class="block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100">Your
            Profile</a>

          <a href="#"
            class="block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100">Settings</a>

          <a href="#"
            class="block px-4 py-2 text-base font-medium text-gray-500 hover:text-gray-800 hover:bg-gray-100">Sign
            out</a>
        </div>
      </div>
    </div>
  </nav>
  <script>
    function globalSearch() {
      return {
        search_open: false, 
        searchQuery: '',
        selectedFilters: [],
        filterItems: ['Course', 'Chapter', 'Video', 'Exam', 'Post', 'Notes', 'Live stream', 'Attachment', 'Discussion', 'Store'],
        results: [
          { id: 1, title: 'Introduction to Machine Learning', description: 'A course on machine learning concepts.', type: 'course', tags:'programming' },
          { id: 2, title: 'Supervised Learning Basics', description: 'Chapter covering supervised learning algorithms.', type: 'chapter', tags:'programming' },
          { id: 3, title: 'Neural Networks learning', description: 'A video explaining the basics of neural networks.', type: 'video' },
          { id: 4, title: 'Machine Learning Final Exam', description: 'Final exam for the machine learning course.', type: 'exam' },
          { id: 5, title: 'Python for Data Science learning', description: 'Notes on Python for data science.', type: 'notes' },
          { id: 6, title: 'Live Stream: ML Workshop', description: 'Join our live stream learning on ML workshop.', type: 'live_stream' },
          { id: 7, title: 'Video Conference: ML Q&A', description: 'A video conference to learning answer ML questions.', type: 'video_conference' },
          { id: 8, title: 'Testpress Post', description: 'Learning post is good.', type: 'post' },
          { id: 9, title: 'ML learning Group', description: 'Join the ML discussion forum.', type: 'discussion' },
          { id: 10, title: 'CAT test series learning', description: 'All the available mock tests for practice', type: 'store' },
        ],
        iconMapping: {
          'course': 'https://static.testpress.in/static/courses/general/1442850373_115.png', 
          'chapter': 'https://static.testpress.in/static/courses/general/1442850373_115.png', 
          'video': 'https://static.testpress.in/static/img/videoicon.png', 
          'exam': 'https://static.testpress.in/static/img/examicon.png',
          'notes': 'https://static.testpress.in/static/img/bookicon.png', 
          'attachment': 'https://static.testpress.in/static/img/fileicon.png', 
          'video_conference': 'https://static.testpress.in/static/img/live_conference.png', 
          'live_stream': 'https://static.testpress.in/static/img/live.png', 
          'post': 'https://static.testpress.in/static/img/posts.svg',
          'discussion': 'https://static.testpress.in/static/img/discussion.png', 
          'store': 'https://static.testpress.in/static/img/market.svg',        
        },
  
        highlight(text) {
          const query = this.searchQuery.toLowerCase();
          if (!query || query.length === 0) return text;
          return text.replace(new RegExp(query, 'gi'), (match) => `<span class='bg-yellow-200'>${match}</span>`);
        },
  
        toggleScrollLock(open) {
          if (open) {
            document.body.classList.add('overflow-hidden');
          } else {
            document.body.classList.remove('overflow-hidden');
          }
        },
  
        watchSearchOpen() {
          this.$watch('searchQuery', (value) => {
            if (value.trim().length > 0) {
              this.toggleScrollLock(true);
            } else {
              this.toggleScrollLock(false);
            }
          });
        }
      };
    }
  </script>
    
<div x-data="reportBuilder()" x-init="init()" class="max-w-6xl mx-auto xl:px-8 py-8">
  <div class="lg:px-0 lg:col-span-9 px-4">
    <div>
      <div class="lg:mx-0 mb-4 max-w-7xl sm:flex sm:items-baseline sm:justify-between">
  <div class="sm:flex-auto">
    <nav class="hidden sm:flex" aria-label="Breadcrumb">
    <ol role="list" class="flex items-center space-x-4">
        <li>
            <div>
                <a href="#"
                   class="text-sm font-medium text-gray-600 hover:text-gray-700">Courses</a>
            </div>
        </li>
        <li>
            <div class="flex items-center">
                <svg class="w-5 h-5 text-gray-400 shrink-0" xmlns="http://www.w3.org/2000/svg"
                     viewBox="0 0 20 20"
                     fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd"
                          d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                          clip-rule="evenodd"></path>
                </svg>
                <span class="ml-4 text-sm font-medium text-gray-600 hover:text-gray-700">NEET 2024</span>
            </div>
        </li>
        
        
    </ol>
</nav>
    <h1 class="text-3xl font-semibold text-gray-900">
      Report Card Builder
    </h1>
    <p class="text-sm text-gray-600 mt-1">Configure report structure, sections, groups, and mapped academic items.</p>
  </div>
</div>
      
      <div data-hs-stepper='{"currentIndex":1}'>
        <nav aria-label="Progress">
  <ol role="list" class="space-y-4 md:flex md:space-x-8 md:space-y-0">
    <li class="md:flex-1" data-hs-stepper-nav-item='{"index": 1}'>
      <a href="#" class="hs-stepper-active:border-emerald-600 hs-stepper-active:hover:border-emerald-800 border-gray-200 hover:border-gray-300 group flex flex-col border-l-4 py-2 pl-4 md:border-l-0 md:border-t-4 md:pb-0 md:pl-0 md:pt-4 border-emerald-600 hover:border-emerald-800">
        <span class="hs-stepper-active:text-emerald-600 hs-stepper-active:group-hover:text-emerald-800 text-gray-500 group-hover:text-gray-700 text-sm font-medium">Step 1</span>
        <span class="text-sm font-medium">Report Details</span>
      </a>
    </li>
    <li class="md:flex-1" data-hs-stepper-nav-item='{"index": 2}'>
      <a href="#" class="hs-stepper-active:border-emerald-600 hs-stepper-active:hover:border-emerald-800 border-gray-200 hover:border-gray-300 group flex flex-col border-l-4 py-2 pl-4 md:border-l-0 md:border-t-4 md:pb-0 md:pl-0 md:pt-4 border-gray-200 hover:border-gray-300">
        <span class="hs-stepper-active:text-emerald-600 hs-stepper-active:group-hover:text-emerald-800 text-gray-500 group-hover:text-gray-700 text-sm font-medium">Step 2</span>
        <span class="text-sm font-medium">Sections &amp; Groups</span>
      </a>
    </li>
    <li class="md:flex-1" data-hs-stepper-nav-item='{"index": 3}'>
      <a href="#" class="hs-stepper-active:border-emerald-600 hs-stepper-active:hover:border-emerald-800 border-gray-200 hover:border-gray-300 group flex flex-col border-l-4 py-2 pl-4 md:border-l-0 md:border-t-4 md:pb-0 md:pl-0 md:pt-4 border-gray-200 hover:border-gray-300">
        <span class="hs-stepper-active:text-emerald-600 hs-stepper-active:group-hover:text-emerald-800 text-gray-500 group-hover:text-gray-700 text-sm font-medium">Step 3</span>
        <span class="text-sm font-medium">Items &amp; Mapping</span>
      </a>
    </li>
    <li class="md:flex-1" data-hs-stepper-nav-item='{"index": 4}'>
      <a href="#" class="hs-stepper-active:border-emerald-600 hs-stepper-active:hover:border-emerald-800 border-gray-200 hover:border-gray-300 group flex flex-col border-l-4 py-2 pl-4 md:border-l-0 md:border-t-4 md:pb-0 md:pl-0 md:pt-4 border-gray-200 hover:border-gray-300">
        <span class="hs-stepper-active:text-emerald-600 hs-stepper-active:group-hover:text-emerald-800 text-gray-500 group-hover:text-gray-700 text-sm font-medium">Step 4</span>
        <span class="text-sm font-medium">Review &amp; Publish</span>
      </a>
    </li>
  </ol>
</nav>
        
        <div class="mt-4 bg-white px-4 py-6 sm:p-6 shadow sm:rounded-xl">
          <div data-hs-stepper-content-item='{"index": 1}'>
  <h2 class="text-base/7 font-semibold text-gray-900">Report Details</h2>
  <p class="mt-1 text-sm/6 text-gray-600">Define the top-level report card properties.</p>

  <div class="space-y-5 mt-6">
    <div class="space-y-2">
      <label class="block text-sm font-medium text-gray-800">Title</label>
      <input x-model="report.title" type="text" placeholder="e.g., SAT Progress Report" class="py-2 px-3 block w-full border-gray-200 rounded-lg text-sm text-gray-800 focus:border-emerald-600 focus:ring-emerald-600">
      <p class="text-xs text-gray-500 mt-2">The main heading of the report card visible to students.</p>
    </div>

    <div class="space-y-2">
      <label class="block text-sm font-medium text-gray-800">Description</label>
      <textarea x-model="report.description" rows="3" placeholder="Short context for parents and students." class="block w-full rounded-lg border-0 py-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-emerald-600 sm:text-sm sm:leading-6"></textarea>
      <p class="text-xs text-gray-500 mt-2">Displayed below the title to provide context about the report card.</p>
    </div>

    <div class="grid sm:grid-cols-2 gap-4">
      <div class="space-y-2 relative">
        <label class="block text-sm font-medium text-gray-800">Course (optional auto-filter)</label>
        <div class="relative">
             <select x-model="report.course" data-hs-select='{
                "placeholder": "Select course",
                "toggleTag": "<button type=\"button\" aria-expanded=\"false\"><span data-icon></span><span class=\"text-gray-800 dark:text-neutral-200\" data-title></span></button>",
                "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-hidden focus:ring-2 focus:ring-emerald-500",
                "dropdownClasses": "max-h-64 p-1 pt-0 space-y-0.5 z-50 w-full overflow-hidden overflow-y-auto bg-white rounded-xl shadow-xl",
                "optionClasses": "hs-selected:bg-gray-100 py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg",
                "optionTemplate": "<div><div class=\"flex items-center\"><div class=\"me-2\" data-icon></div><div class=\"text-gray-800\" data-title></div></div></div>",
                "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
              }' class="hidden">
              <option value="">Select course</option>
              <option value="1">SAT Foundation</option>
              <option value="2">JEE Mains Batch A</option>
              <option value="3">NEET Crash Course</option>
            </select>
        </div>
        <p class="text-xs text-gray-500 mt-2">Link this report card to a specific course to filter exams and chapter contents when creating sections.</p>
      </div>
    </div>

    <div class="flex gap-3 items-start">
      <div class="flex h-6 shrink-0 items-center">
        <div class="group grid size-4 grid-cols-1">
          <input id="remarks" x-model="report.remarks_enabled" type="checkbox" class="col-start-1 row-start-1 appearance-none rounded-sm text-emerald-600 focus:ring-emerald-600 border border-gray-300 bg-white checked:border-emerald-600 checked:bg-emerald-600">
          <svg class="pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white" viewBox="0 0 14 14" fill="none">
            <path class="opacity-0 group-has-checked:opacity-100" d="M3 8L6 11L11 3.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            <path class="opacity-0 group-has-indeterminate:opacity-100" d="M3 7H11" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
        </div>
      </div>
      <div class="text-sm">
        <label for="remarks" class="font-medium text-gray-900">Enable teacher remarks</label>
        <p class="text-gray-500">Allows adding overall remarks on the report card.</p>
      </div>
    </div>
  </div>
</div>
          <div data-hs-stepper-content-item='{"index": 2}' style="display: none;">
  <div class="flex items-start justify-between gap-3">
    <div>
      <h2 class="text-base/7 font-semibold text-gray-900">Sections &amp; Groups</h2>
      <p class="mt-1 text-sm/6 text-gray-600">Organize report sections, types, and scoring preferences.</p>
    </div>
    
    <button type="button" class="py-1.5 px-2 inline-flex items-center gap-x-1 text-xs font-medium rounded-full border border-dashed border-stone-200 bg-white text-stone-800 hover:bg-stone-50 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-stone-50 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700" @click="openSectionModal()">
      <svg class="shrink-0 size-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 12h14"></path>
        <path d="M12 5v14"></path>
      </svg>
      Add section
    </button>
  </div>

  <div class="mt-6 space-y-4">
    <template x-for="(section, index) in sections" :key="section.id">
      <div class="bg-white rounded-xl transition-all" :class="selectedSectionId === section.id ? 'shadow-sm ring-1 ring-emerald-600' : 'border border-gray-100 hover:border-gray-200'">
        
        <div class="p-4 flex items-center justify-between cursor-pointer" @click="selectSection(section.id)">
          <div class="flex items-center gap-3">
            <div class="size-8 rounded-full bg-gray-50 flex items-center justify-center text-gray-500">
              <span class="text-xs font-semibold" x-text="index + 1"></span>
            </div>
            <div>
              <p class="text-sm font-semibold text-gray-900" x-text="section.title || 'Untitled section'"></p>
              <div class="flex items-center gap-2 mt-0.5">
                <span class="text-xs text-gray-500 capitalize" x-text="section.section_type"></span>
                <span x-show="section.show_total_score" class="inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-medium bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100">Show total</span>
              </div>
            </div>
          </div>
          
          <div class="flex items-center gap-2">
            <div class="flex justify-center items-center -space-x-px">
                <button type="button" class="py-2 px-2.5 inline-flex items-center gap-x-1.5 text-xs font-medium first:rounded-s-lg last:rounded-e-lg border border-stone-200 bg-white text-stone-800 shadow-2xs hover:bg-stone-50 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-stone-50" @click.stop="openSectionModal(section.id)">
                    Edit
                </button>
                <div class="hs-dropdown relative inline-flex [--auto-close:inside] [--placement:bottom-right] first:rounded-s-lg last:rounded-e-lg border border-stone-200 bg-white shadow-2xs hover:bg-stone-50">
                  <button :id="`hs-dropdown-section-actions-${section.id}`" type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-e-lg text-stone-800 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-stone-50" @click.stop aria-haspopup="menu" aria-expanded="false" aria-label="Dropdown">
                      <svg class="shrink-0 size-3.5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="1"></circle>
                        <circle cx="12" cy="5" r="1"></circle>
                        <circle cx="12" cy="19" r="1"></circle>
                      </svg>
                    </button>
                    <div class="hs-dropdown-menu hs-dropdown-open:opacity-100 w-40 transition-[opacity,margin] duration opacity-0 hidden z-10 bg-white rounded-xl shadow-md" role="menu" aria-orientation="vertical">
                        <div class="p-1">
                            <button type="button" class="w-full flex items-center gap-x-3 py-1.5 px-2 rounded-lg text-[13px] font-normal text-gray-800 hover:bg-gray-100" @click.stop="moveSection(index, -1)" :disabled="index===0">Move Up</button>
                            <button type="button" class="w-full flex items-center gap-x-3 py-1.5 px-2 rounded-lg text-[13px] font-normal text-gray-800 hover:bg-gray-100" @click.stop="moveSection(index, 1)" :disabled="index===sections.length-1">Move Down</button>
                            <div class="border-t border-gray-100 my-1"></div>
                            <button type="button" class="w-full flex items-center gap-x-3 py-2 px-3 rounded-lg text-sm text-red-600 hover:bg-gray-100" @click.stop="deleteSection(index)">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="shrink-0 size-3.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path>
                              </svg>
                              Delete
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <button type="button" class="size-8 inline-flex justify-center items-center rounded-lg hover:bg-gray-100 text-gray-500" :aria-expanded="selectedSectionId === section.id" :aria-label="`Toggle details for ${section.title || 'Untitled section'}`">  
              <svg class="size-5 transition-transform duration-200" :class="selectedSectionId === section.id ? 'rotate-180 text-emerald-600' : ''" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path d="m6 9 6 6 6-6" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>

        <div x-show="selectedSectionId === section.id" x-collapse>
          <div class="px-4 pb-6 pt-2">
            <div class="pl-11 space-y-6">
              
              <div>
                <div class="flex items-center justify-between mb-3">
                  <h3 class="text-sm font-semibold text-gray-900">Groups</h3>
                  <button type="button" class="py-1.5 px-2 inline-flex items-center gap-x-1 text-xs font-medium rounded-full border border-dashed border-stone-200 bg-white text-stone-800 hover:bg-stone-50" @click.stop="openGroupModal(section.id)">
                      <svg class="shrink-0 size-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M5 12h14"></path>
                        <path d="M12 5v14"></path>
                      </svg>
                      Add group
                  </button>
                </div>

                <div class="space-y-3">
                  <template x-for="(group, gIndex) in section.groups" :key="group.id">
                    <div class="border border-gray-200 rounded-lg p-3 bg-white">
                      <div class="flex items-start justify-between gap-3">
                        <div>
                          <p class="text-sm font-semibold text-gray-900" x-text="group.title || 'Untitled group'"></p>
                          <p class="text-[11px] text-gray-500 mt-1">
                            <span x-text="`${group.minimum_marks || 0} (min) - ${group.maximum_marks || 100} (max) | Rounded nearest to - ${group.rounding_precision || 1}`"></span>
                          </p>
                        </div>
                        <div class="flex items-center gap-2">
                          <span x-show="group.show_average" class="inline-flex items-center px-2 py-1 rounded-full bg-emerald-50 text-emerald-700 text-[11px] font-medium ring-1 ring-emerald-100">Avg</span>
                          <span x-show="group.show_total" class="inline-flex items-center px-2 py-1 rounded-full bg-emerald-50 text-emerald-700 text-[11px] font-medium ring-1 ring-emerald-100">Total</span>
                          
                          <div class="h-4 w-px bg-gray-200 mx-1"></div>

                          <div class="flex justify-center items-center -space-x-px">
                            <button type="button" class="py-2 px-2.5 inline-flex items-center gap-x-1.5 text-xs font-medium first:rounded-s-lg last:rounded-e-lg border border-stone-200 bg-white text-stone-800 shadow-2xs hover:bg-stone-50" @click.stop="openGroupModal(section.id, group.id)" title="Edit Group">
                                Edit
                            </button>
                            <div class="hs-dropdown relative inline-flex [--auto-close:inside] [--placement:bottom-right] first:rounded-s-lg last:rounded-e-lg border border-stone-200 bg-white shadow-2xs hover:bg-stone-50">
                                <button :id="`hs-dropdown-group-actions-${group.id}`" type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-e-lg text-stone-800 focus:outline-hidden focus:bg-stone-50" @click.stop aria-haspopup="menu" aria-expanded="false" aria-label="Dropdown">                                  <svg class="shrink-0 size-3.5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="1"></circle>
                                    <circle cx="12" cy="5" r="1"></circle>
                                    <circle cx="12" cy="19" r="1"></circle>
                                  </svg>
                                </button>
                                <div class="hs-dropdown-menu hs-dropdown-open:opacity-100 w-40 transition-[opacity,margin] duration opacity-0 hidden z-10 bg-white rounded-xl shadow-md" role="menu" aria-orientation="vertical">
                                    <div class="p-1">
                                        <button type="button" class="w-full flex items-center gap-x-3 py-1.5 px-2 rounded-lg text-[13px] font-normal text-gray-800 hover:bg-gray-100" @click.stop="moveGroup(section.id, gIndex, -1)" :disabled="gIndex===0">Move Up</button>
                                        <button type="button" class="w-full flex items-center gap-x-3 py-1.5 px-2 rounded-lg text-[13px] font-normal text-gray-800 hover:bg-gray-100" @click.stop="moveGroup(section.id, gIndex, 1)" :disabled="gIndex===section.groups.length-1">Move Down</button>
                                        <div class="border-t border-gray-100 my-1"></div>
                                        <button type="button" class="w-full flex items-center gap-x-3 py-2 px-3 rounded-lg text-sm text-red-600 hover:bg-gray-100" @click.stop="deleteGroup(section.id, gIndex)">
                                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="shrink-0 size-3.5">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path>
                                          </svg>
                                          Delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </template>
                  <p class="text-xs text-gray-500 italic" x-show="!section.groups.length">No groups added. Add at least one group.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </template>
    
    <div x-show="!sections.length" class="text-center py-10 rounded-xl border-2 border-dashed border-gray-200">
      <p class="text-gray-500 text-sm">No sections created yet.</p>
      <button type="button" class="mt-2 text-sm text-emerald-600 font-medium hover:underline" @click="openSectionModal()">Create your first section</button>
    </div>
  </div>
</div>
          <div data-hs-stepper-content-item='{"index": 3}' style="display: none;">
  <div class="flex items-start justify-between gap-3">
    <div>
      <h2 class="text-base/7 font-semibold text-gray-900">Items &amp; Mapping</h2>
      <p class="mt-1 text-sm/6 text-gray-600">Attach exams, exam sections, or other learning items to groups.</p>
    </div>
    <div class="flex items-center gap-2">
      <div class="relative">
         <select x-model="selectedSectionId" @change="selectSection(selectedSectionId)" data-hs-select='{
            "placeholder": "Select Section",
            "toggleTag": "<button type=\"button\" aria-expanded=\"false\"><span data-icon></span><span class=\"text-gray-800 dark:text-neutral-200\" data-title></span></button>",
            "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-hidden focus:ring-2 focus:ring-emerald-500",
            "dropdownClasses": "max-h-64 p-1 pt-0 space-y-0.5 z-50 w-full overflow-hidden overflow-y-auto bg-white rounded-xl shadow-xl",
            "optionClasses": "hs-selected:bg-gray-100 py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg",
            "optionTemplate": "<div><div class=\"flex items-center\"><div class=\"me-2\" data-icon></div><div class=\"text-gray-800\" data-title></div></div></div>",
            "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
          }' class="hidden">
             <template x-for="section in sections" :key="section.id">
                <option :value="section.id" x-text="section.title || 'Untitled section'"></option>
             </template>
         </select>
      </div>
      
      <div class="relative">
          <select x-model="selectedGroupId" data-hs-select='{
            "placeholder": "Select Group",
            "toggleTag": "<button type=\"button\" aria-expanded=\"false\"><span data-icon></span><span class=\"text-gray-800 dark:text-neutral-200\" data-title></span></button>",
            "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-hidden focus:ring-2 focus:ring-emerald-500",
            "dropdownClasses": "max-h-64 p-1 pt-0 space-y-0.5 z-50 w-full overflow-hidden overflow-y-auto bg-white rounded-xl shadow-xl",
            "optionClasses": "hs-selected:bg-gray-100 py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg",
            "optionTemplate": "<div><div class=\"flex items-center\"><div class=\"me-2\" data-icon></div><div class=\"text-gray-800\" data-title></div></div></div>",
            "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
          }' class="hidden">
            <template x-for="group in activeGroupList" :key="group.id">
                <option :value="group.id" x-text="group.title || 'Untitled group'"></option>
            </template>
        </select>
      </div>

      <button type="button" class="py-1.5 px-2 inline-flex items-center gap-x-1 text-xs font-medium rounded-full border border-dashed border-stone-200 bg-white text-stone-800 hover:bg-stone-50 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-stone-50" @click="openItemModal()">
        <svg class="shrink-0 size-3" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M5 12h14"></path>
            <path d="M12 5v14"></path>
        </svg>
        Add item
      </button>
    </div>
  </div>

  <div class="mt-6 rounded-xl overflow-hidden border border-gray-200">
    <div class="px-4 py-3 bg-gray-50 border-b border-gray-200 flex items-center justify-between">
      <div>
        <p class="text-sm font-semibold text-gray-900" x-text="activeGroup?.title || 'Items'"></p>
        <p class="text-xs text-gray-500">Mapped learning objects for the selected group.</p>
      </div>
      <span class="text-xs text-gray-500" x-text="(activeGroup?.items?.length || 0) + ' items'"></span>
    </div>
    
    <div class="divide-y divide-gray-100 bg-white">
      <template x-for="(item, index) in (activeGroup?.items || [])" :key="item.id">
        <div class="px-4 py-3 flex items-center gap-3 hover:bg-gray-50 transition-colors">
          <div class="w-10 h-10 rounded-lg bg-emerald-50 text-emerald-600 flex items-center justify-center text-xs font-semibold uppercase ring-1 ring-emerald-100" x-text="item.item_type[0]"></div>
          
          <div class="flex-1 min-w-0">
            <p class="text-sm font-semibold text-gray-900 line-clamp-1" x-text="item.title"></p>
            <p class="text-xs text-gray-500">
              <span class="capitalize" x-text="item.item_type"></span>
               <span class="capitalize" x-text="item.content_type"></span>
            </p>
          </div>

          <div class="text-right flex items-center gap-4">
            <div class="hs-dropdown relative inline-flex [--auto-close:inside] [--placement:bottom-right]">
                <button :id="`hs-dropdown-item-actions-${item.id}`" type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-lg border border-stone-200 bg-white text-stone-800 shadow-2xs hover:bg-stone-50 focus:outline-hidden focus:bg-stone-50" aria-haspopup="menu" aria-expanded="false" aria-label="Dropdown">
                  <svg class="shrink-0 size-3.5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="1"></circle>
                    <circle cx="12" cy="5" r="1"></circle>
                    <circle cx="12" cy="19" r="1"></circle>
                  </svg>
                </button>
                  <div class="hs-dropdown-menu hs-dropdown-open:opacity-100 w-40 transition-[opacity,margin] duration opacity-0 hidden z-10 bg-white rounded-xl shadow-md" role="menu" aria-orientation="vertical" :aria-labelledby="`hs-dropdown-item-actions-${item.id}`">
                    <div class="p-1">
                        <button type="button" class="w-full flex items-center gap-x-3 py-1.5 px-2 rounded-lg text-[13px] font-normal text-gray-800 hover:bg-gray-100" @click="moveItem(index, -1)" :disabled="index===0">Move Up</button>
                        <button type="button" class="w-full flex items-center gap-x-3 py-1.5 px-2 rounded-lg text-[13px] font-normal text-gray-800 hover:bg-gray-100" @click="moveItem(index, 1)" :disabled="index===(activeGroup?.items?.length||1)-1">Move Down</button>
                        <button type="button" class="w-full flex items-center gap-x-3 py-1.5 px-2 rounded-lg text-[13px] font-normal text-gray-800 hover:bg-gray-100" @click="openItemModal(item.id)">Edit</button>
                        <div class="border-t border-gray-100 my-1"></div>
                        <button type="button" class="w-full flex items-center gap-x-3 py-2 px-3 rounded-lg text-sm text-red-600 hover:bg-gray-100" @click="removeItem(index)">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="shrink-0 size-3.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path>
                          </svg>
                          Delete
                        </button>
                    </div>
                </div>
            </div>
          </div>
        </div>
      </template>
      
      <div class="px-4 py-8 text-center" x-show="!(activeGroup?.items?.length)">
         <p class="text-sm text-gray-500">No items yet for this group.</p>
         <button type="button" class="mt-2 text-sm font-medium text-emerald-600 hover:text-emerald-700" @click="openItemModal()">Add your first item</button>
      </div>
    </div>
  </div>
</div>
          <div data-hs-stepper-content-item='{"index": 4}' style="display: none;">
  <div class="flex items-start justify-between gap-3">
    <div>
      <h2 class="text-base/7 font-semibold text-gray-900">Review &amp; Publish</h2>
      <p class="mt-1 text-sm/6 text-gray-600">Double check your configuration before publishing.</p>
    </div>
  </div>

  <div class="mt-6 space-y-6">
    <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
            <h3 class="text-base font-semibold text-gray-800">Report Overview</h3>
        </div>
        <div class="px-6 py-4">
            <dl class="grid sm:grid-cols-2 gap-x-6 gap-y-4">
                <div>
                    <dt class="text-sm font-medium text-gray-500">Report Title</dt>
                    <dd class="mt-1 text-sm font-semibold text-gray-900" x-text="report.title || ''"></dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-500">Course</dt>
                    <dd class="mt-1 text-sm text-gray-900" x-text="report.course ? (courses.find(c => c.id == report.course)?.name || report.course) : 'No specific course linked'"></dd>
                </div>
                <div class="sm:col-span-2">
                    <dt class="text-sm font-medium text-gray-500">Description</dt>
                    <dd class="mt-1 text-sm text-gray-900" x-text="report.description || 'No description provided.'"></dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-500">Teacher Remarks</dt>
                    <dd class="mt-1">
                        <span class="inline-flex items-center gap-x-1.5 py-1 px-2 rounded-full text-xs font-medium border border-gray-200 bg-white text-gray-800" x-text="report.remarks_enabled ? 'Enabled' : 'Disabled'"></span>
                    </dd>
                </div>
            </dl>
        </div>
    </div>

    <div class="space-y-4">
      <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wide">Structure Preview</h3>
      
      <template x-for="section in sections" :key="section.id">
        <div class="flex flex-col bg-white border border-gray-200 shadow-sm rounded-xl overflow-hidden">
          <div class="bg-gray-50 border-b border-gray-200 px-5 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
               <span class="size-6 inline-flex items-center justify-center rounded-full bg-white border border-gray-200 text-xs font-semibold text-gray-600">S</span>
               <div>
                   <h4 class="text-sm font-bold text-gray-800" x-text="section.title || 'Untitled Section'"></h4>
                   <p class="text-xs text-gray-500 capitalize" x-text="section.section_type"></p>
               </div>
            </div>
            <div x-show="section.show_total_score">
                <span class="inline-flex items-center gap-x-1.5 py-1 px-2 rounded-md text-xs font-medium bg-emerald-100 text-emerald-800">
                  Total Score Visible
                </span>
            </div>
          </div>

          <div class="divide-y divide-gray-100">
            <template x-for="group in section.groups" :key="group.id">
              <div class="px-5 py-4">
                <div class="flex items-start justify-between mb-2">
                    <div class="flex items-center gap-2">
                        <h5 class="text-sm font-semibold text-gray-800" x-text="group.title || 'Untitled Group'"></h5>
                        <div class="flex gap-1">
                            <span x-show="group.show_average" class="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-emerald-50 text-emerald-700 border border-emerald-100">Avg</span>
                            <span x-show="group.show_total" class="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-emerald-50 text-emerald-700 border border-emerald-100">Total</span>
                        </div>
                    </div>
                    <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded" x-text="`${group.minimum_marks || 0} - ${group.maximum_marks || 100}`"></span>
                </div>
                
                <div class="mt-3 border border-gray-200 rounded-lg overflow-hidden" x-show="group.items && group.items.length > 0">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Item</th>
                                <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Type</th>
                                <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Source</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 bg-white">
                            <template x-for="item in (group.items || [])" :key="item.id">
                                <tr>
                                    <td class="px-3 py-2 whitespace-nowrap text-xs font-medium text-gray-800" x-text="item.title"></td>
                                    <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-500 capitalize" x-text="item.item_type"></td>
                                    <td class="px-3 py-2 whitespace-nowrap text-xs text-gray-500 capitalize" x-text="item.content_type"></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
                <div class="mt-2" x-show="!group.items || group.items.length === 0">
                    <span class="text-xs text-red-500 italic">No items mapped to this group.</span>
                </div>
              </div>
            </template>
            <div x-show="!section.groups.length" class="px-5 py-4 text-sm text-gray-500 italic">
                No groups in this section.
            </div>
          </div>
        </div>
      </template>
      
      <div x-show="!sections.length" class="text-center py-10 bg-white rounded-xl border border-dashed border-gray-300">
        <p class="text-gray-500 text-sm">No sections added yet.</p>
      </div>
    </div>
  </div>
</div>
        </div>
        <div class="mt-5 flex justify-between items-center gap-x-2">
  <button type="button" class="py-2 px-3 inline-flex items-center gap-x-1 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none" data-hs-stepper-back-btn="">
    <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="m15 18-6-6 6-6"></path>
    </svg>
    Back
  </button>
  <button type="button" class="py-2 px-3 inline-flex items-center gap-x-1 text-sm font-medium rounded-lg border border-transparent bg-emerald-600 text-white hover:bg-emerald-700 focus:outline-none focus:bg-emerald-700 disabled:opacity-50 disabled:pointer-events-none" data-hs-stepper-next-btn="">
    Next
    <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="m9 18 6-6-6-6"></path>
    </svg>
  </button>
  
  <div data-hs-stepper-finish-btn="" style="display: none;" class="flex items-center gap-2">
    <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none">
        Save as Draft
    </button>
    <button type="button" class="py-2 px-3 inline-flex items-center gap-x-1 text-sm font-medium rounded-lg border border-transparent bg-emerald-600 text-white hover:bg-emerald-700 focus:outline-none focus:bg-emerald-700 disabled:opacity-50 disabled:pointer-events-none" @click="publish">
        Publish report
    </button>
  </div>
</div>
      </div>
    </div>
  </div>

  <div id="section-modal" class="hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto [--close-when-click-inside:true] pointer-events-none" role="dialog" tabindex="-1" aria-labelledby="section-modal-label">
  <div class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-2xl sm:w-full m-3 sm:mx-auto h-[calc(100%-3.5rem)] min-h-[calc(100%-3.5rem)] flex items-center">
    <div class="w-full max-h-full flex flex-col bg-white rounded-xl pointer-events-auto shadow-[0_10px_40px_10px_rgba(0,0,0,0.08)]">
      <div class="py-3 px-4 flex justify-between items-center border-b border-gray-200">
        <div>
          <h3 id="section-modal-label" class="font-medium text-gray-800" x-text="sectionModal.mode === 'edit' ? 'Edit section' : 'Add section'"></h3>
          <p class="text-xs text-gray-500">Title, type, and total toggle.</p>
        </div>
        <button type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-800 hover:bg-gray-200 focus:outline-none focus:bg-gray-200" aria-label="Close" data-hs-overlay="#section-modal">
          <span class="sr-only">Close</span>
          <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>

      <div class="overflow-y-auto p-4 space-y-4">
        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-800">Title</label>
          <input x-model="sectionModal.form.title" type="text" class="py-2 px-3 block w-full border-gray-200 rounded-lg text-sm text-gray-800 focus:border-emerald-600 focus:ring-emerald-600" placeholder="e.g., SAT Projection">
          <p class="text-xs text-gray-500 mt-2">The name of this section as it will appear on the report card.</p>
        </div>
        
        <div class="space-y-2 relative">
            <label class="block text-sm font-medium text-gray-800">Section type</label>
             <div class="relative">
                <select x-model="sectionModal.form.section_type" data-hs-select='{
                    "placeholder": "Select Type",
                    "toggleTag": "<button type=\"button\" aria-expanded=\"false\"><span data-icon></span><span class=\"text-gray-800 dark:text-neutral-200\" data-title></span></button>",
                    "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-hidden focus:ring-2 focus:ring-emerald-500",
                    "dropdownClasses": "max-h-64 p-1 pt-0 space-y-0.5 z-50 w-full overflow-hidden overflow-y-auto bg-white rounded-xl shadow-xl",
                    "optionClasses": "hs-selected:bg-gray-100 py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg",
                    "optionTemplate": "<div><div class=\"flex items-center\"><div class=\"me-2\" data-icon></div><div class=\"text-gray-800\" data-title></div></div></div>",
                    "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
                  }' class="hidden">
                  <option value="scholastic">Scholastic</option>
                  <option value="co_scholastic">Co-Scholastic</option>
                  <option value="attendance">Attendance</option>
                </select>
             </div>
             <p class="text-xs text-gray-500 mt-2">Choose the section type</p>
        </div>

        <div class="flex gap-3 pt-2">
            <div class="flex h-6 shrink-0 items-center">
              <div class="group grid size-4 grid-cols-1">
                <input x-model="sectionModal.form.show_total_score" type="checkbox" class="col-start-1 row-start-1 appearance-none rounded-sm text-emerald-600 focus:ring-emerald-600 border border-gray-300 bg-white checked:border-emerald-600 checked:bg-emerald-600 indeterminate:border-emerald-600 indeterminate:bg-emerald-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:checked:bg-gray-100 forced-colors:appearance-auto">
                <svg class="pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25" viewBox="0 0 14 14" fill="none">
                  <path class="opacity-0 group-has-checked:opacity-100" d="M3 8L6 11L11 3.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                  <path class="opacity-0 group-has-indeterminate:opacity-100" d="M3 7H11" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
              </div>
            </div>
            <div class="text-sm/6">
              <label class="font-medium text-gray-900">Display aggregated total</label>
              <p class="text-xs text-gray-500 mt-1">If enabled, the sum of all group scores within this section will be shown.</p>
            </div>
        </div>
      </div>

      <div class="px-4 py-3 border-t border-gray-200 flex justify-end items-center gap-2">
        <button type="button" class="py-2 px-3 text-nowrap inline-flex justify-center items-center text-start bg-white border border-gray-200 text-gray-800 text-sm font-medium rounded-lg shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none" data-hs-overlay="#section-modal">
          Cancel
        </button>
        <button type="button" class="py-2 px-3 text-nowrap inline-flex justify-center items-center gap-x-2 text-start bg-emerald-600 border border-emerald-600 text-white text-sm font-medium rounded-lg shadow-sm hover:bg-emerald-700 disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:ring-1 focus:ring-emerald-300" @click="saveSectionModal" data-hs-overlay="#section-modal">
            Save
        </button>
      </div>
    </div>
  </div>
</div>
  <div id="group-modal" class="hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto [--close-when-click-inside:true] pointer-events-none" role="dialog" tabindex="-1" aria-labelledby="group-modal-label">
  <div class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-2xl sm:w-full m-3 sm:mx-auto h-[calc(100%-3.5rem)] min-h-[calc(100%-3.5rem)] flex items-center">
    <div class="w-full max-h-full flex flex-col bg-white rounded-xl pointer-events-auto shadow-[0_10px_40px_10px_rgba(0,0,0,0.08)]">
      <div class="py-3 px-4 flex justify-between items-center border-b border-gray-200">
        <div>
          <h3 id="group-modal-label" class="font-medium text-gray-800" x-text="groupModal.mode === 'edit' ? 'Edit group' : 'Add group'"></h3>
          <p class="text-xs text-gray-500">Configure title, limits, rounding, and display flags.</p>
        </div>
        <button type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-800 hover:bg-gray-200 focus:outline-none focus:bg-gray-200" aria-label="Close" data-hs-overlay="#group-modal">
          <span class="sr-only">Close</span>
          <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>

      <div class="overflow-y-auto p-4 space-y-4">
        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-800">Title</label>
          <input x-model="groupModal.form.title" type="text" class="py-2 px-3 block w-full border-gray-200 rounded-lg text-sm text-gray-800 focus:border-emerald-600 focus:ring-emerald-600" placeholder="e.g., English">
          <p class="text-xs text-gray-500 mt-2">The specific subject or category name for grouping (e.g., 'Mathematics' or 'English').</p>
        </div>

        <div class="grid sm:grid-cols-3 gap-4">
          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-800">Minimum marks</label>
            <input x-model="groupModal.form.minimum_marks" type="number" class="py-2 px-3 block w-full border-gray-200 rounded-lg text-sm text-gray-800 focus:border-emerald-600 focus:ring-emerald-600">
            <p class="text-xs text-gray-500 mt-2">Lowest possible mark.</p>
          </div>
          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-800">Maximum marks</label>
            <input x-model="groupModal.form.maximum_marks" type="number" class="py-2 px-3 block w-full border-gray-200 rounded-lg text-sm text-gray-800 focus:border-emerald-600 focus:ring-emerald-600">
            <p class="text-xs text-gray-500 mt-2">Highest possible mark.</p>
          </div>
          <div class="space-y-2 relative">
            <label class="block text-sm font-medium text-gray-800">Rounding</label>
            <div class="relative">
                <select x-model="groupModal.form.rounding_precision" data-hs-select='{
                    "placeholder": "Select",
                    "toggleTag": "<button type=\"button\" aria-expanded=\"false\"><span data-icon></span><span class=\"text-gray-800 dark:text-neutral-200\" data-title></span></button>",
                    "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-hidden focus:ring-2 focus:ring-emerald-500",
                    "dropdownClasses": "max-h-64 p-1 pt-0 space-y-0.5 z-50 w-full overflow-hidden overflow-y-auto bg-white rounded-xl shadow-xl",
                    "optionClasses": "hs-selected:bg-gray-100 py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg",
                    "optionTemplate": "<div><div class=\"flex items-center\"><div class=\"me-2\" data-icon></div><div class=\"text-gray-800\" data-title></div></div></div>",
                    "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
                  }' class="hidden">
                  <option value="1">Nearest 1</option>
                  <option value="5">Nearest 5</option>
                  <option value="10">Nearest 10</option>
                </select>
            </div>
            <p class="text-xs text-gray-500 mt-2">How decimals are handled.</p>
          </div>
        </div>
        
        <div class="flex flex-col gap-3">
            <div class="flex gap-3">
                <div class="flex h-6 shrink-0 items-center">
                  <div class="group grid size-4 grid-cols-1">
                    <input x-model="groupModal.form.show_average" type="checkbox" class="col-start-1 row-start-1 appearance-none rounded-sm text-emerald-600 focus:ring-emerald-600 border border-gray-300 bg-white checked:border-emerald-600 checked:bg-emerald-600 indeterminate:border-emerald-600 indeterminate:bg-emerald-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:checked:bg-gray-100 forced-colors:appearance-auto">
                    <svg class="pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25" viewBox="0 0 14 14" fill="none">
                      <path class="opacity-0 group-has-checked:opacity-100" d="M3 8L6 11L11 3.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path class="opacity-0 group-has-indeterminate:opacity-100" d="M3 7H11" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                  </div>
                </div>
                <div class="text-sm/6">
                  <label class="font-medium text-gray-900">Show average</label>
                  <p class="text-xs text-gray-500 mt-1">Display the average score.</p>
                </div>
            </div>

            <div class="flex gap-3">
                <div class="flex h-6 shrink-0 items-center">
                  <div class="group grid size-4 grid-cols-1">
                    <input x-model="groupModal.form.show_total" type="checkbox" class="col-start-1 row-start-1 appearance-none rounded-sm text-emerald-600 focus:ring-emerald-600 border border-gray-300 bg-white checked:border-emerald-600 checked:bg-emerald-600 indeterminate:border-emerald-600 indeterminate:bg-emerald-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:checked:bg-gray-100 forced-colors:appearance-auto">
                    <svg class="pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25" viewBox="0 0 14 14" fill="none">
                      <path class="opacity-0 group-has-checked:opacity-100" d="M3 8L6 11L11 3.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path class="opacity-0 group-has-indeterminate:opacity-100" d="M3 7H11" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                  </div>
                </div>
                <div class="text-sm/6">
                  <label class="font-medium text-gray-900">Show total</label>
                  <p class="text-xs text-gray-500 mt-1">Display the sum of scores.</p>
                </div>
            </div>
        </div>

      </div>

      <div class="px-4 py-3 border-t border-gray-200 flex justify-end items-center gap-2">
        <button type="button" class="py-2 px-3 text-nowrap inline-flex justify-center items-center text-start bg-white border border-gray-200 text-gray-800 text-sm font-medium rounded-lg shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none" data-hs-overlay="#group-modal">
          Cancel
        </button>
        <button type="button" class="py-2 px-3 text-nowrap inline-flex justify-center items-center gap-x-2 text-start bg-emerald-600 border border-emerald-600 text-white text-sm font-medium rounded-lg shadow-sm hover:bg-emerald-700 disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:ring-1 focus:ring-emerald-300" @click="saveGroupModal" data-hs-overlay="#group-modal">
            Save
        </button>
      </div>
    </div>
  </div>
</div>
  <div id="item-modal" class="hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto [--close-when-click-inside:true] pointer-events-none" role="dialog" tabindex="-1" aria-labelledby="item-modal-label">
  <div class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-2xl sm:w-full m-3 sm:mx-auto h-[calc(100%-3.5rem)] min-h-[calc(100%-3.5rem)] flex items-center">
    <div class="w-full max-h-full flex flex-col bg-white rounded-xl pointer-events-auto shadow-[0_10px_40px_10px_rgba(0,0,0,0.08)]">
      
      <div class="py-3 px-4 flex justify-between items-center border-b border-gray-200">
        <div>
          <h3 id="item-modal-label" class="font-medium text-gray-800" x-text="itemModal.mode === 'edit' ? 'Edit item' : 'Add item'"></h3>
          <p class="text-xs text-gray-500">Configure content and settings for this item.</p>
        </div>
        <button type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-800 hover:bg-gray-200 focus:outline-none focus:bg-gray-200" aria-label="Close" data-hs-overlay="#item-modal">
          <span class="sr-only">Close</span>
          <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>

      <div class="overflow-y-auto p-4 space-y-4">
        
        <div class="space-y-2 relative">
          <label class="block text-sm font-medium text-gray-800">Item type</label>
          <div class="relative pointer-events-none">
            <select disabled x-model="itemModal.form.item_type" data-hs-select='{
                "placeholder": "Select Item Type",
                "toggleTag": "<button type=\"button\" aria-expanded=\"false\"></button>",
                "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-gray-100 border border-gray-200 rounded-lg text-start text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500",
                "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto",
                "optionClasses": "py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100",
                "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
              }' class="hidden">
              <option value="scholastic">Scholastic (Exam / Content)</option>
              <option value="co_scholastic">Co-Scholastic (Activities)</option>
              <option value="attendance">Attendance</option>
            </select>
          </div>
          <p class="text-xs text-gray-500 mt-2">Type is inherited from the section.</p>
        </div>

        <div x-show="itemModal.form.item_type === 'scholastic'" class="space-y-4">
          
          <div class="space-y-2 relative">
            <label class="block text-sm font-medium text-gray-800">Content source</label>
            <div class="relative">
              <select x-model="itemModal.form.content_type" data-hs-select='{
                  "placeholder": "Select Source",
                  "toggleTag": "<button type=\"button\" aria-expanded=\"false\"></button>",
                  "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500",
                  "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto",
                  "optionClasses": "py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100",
                  "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
                }' class="hidden">
                <option value="exam">Exam</option>
                <option value="exam_section">Exam Section</option>
                <option value="chapter_content">Chapter Content</option>
              </select>
            </div>
            <p class="text-xs text-gray-500 mt-2">Choose the source of the score for this group (e.g., Exam, Chapter).</p>
          </div>

          <div class="space-y-1 relative" x-show="itemModal.form.content_type === 'exam'">
            <label class="block text-xs font-medium text-gray-700">Select Exam(s)</label>
             <div class="relative">
              <select multiple x-model="itemModal.form.exam" data-hs-select='{
                "placeholder": "Select exams...",
                "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full",
                "optionClasses": "py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100",
                "mode": "tags",
                "wrapperClasses": "relative ps-0.5 pe-9 flex items-center flex-wrap text-nowrap w-full border border-gray-200 rounded-lg text-start text-sm focus:border-emerald-500 focus:ring-emerald-500",
                "tagsItemTemplate": "<div class=\"flex flex-nowrap items-center relative z-10 bg-white border border-gray-200 rounded-full p-1 m-1\"><div class=\"ms-2 whitespace-nowrap text-gray-800\" data-title></div><div class=\"inline-flex shrink-0 justify-center items-center size-5 ms-2 rounded-full text-gray-800 bg-gray-200 hover:bg-gray-300 cursor-pointer\" data-remove><svg class=\"shrink-0 size-3\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M18 6 6 18\"/><path d=\"m6 6 12 12\"/></svg></div></div>",
                "tagsInputClasses": "border-0 focus:ring-0 px-2 rounded-lg order-1 text-sm outline-none",
                "optionTemplate": "<div class=\"flex items-center\"><div><div class=\"text-sm font-semibold text-gray-800\" data-title></div></div><div class=\"ms-auto\"><span class=\"hidden hs-selected:block\"><svg class=\"shrink-0 size-4 text-emerald-600\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\"><path d=\"M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z\"/></svg></span></div></div>",
                "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
              }' class="hidden">
                <option value="1">Mock Test 1</option>
                <option value="2">Mock Test 2</option>
                <option value="3">Weekly Quiz</option>
              </select>
            </div>
            <p class="text-xs text-gray-500 mt-2">Search and select the specific exams.</p>
          </div>

          <div class="space-y-1 relative" x-show="itemModal.form.content_type === 'exam_section'">
            <label class="block text-xs font-medium text-gray-700">Select Exam</label>
             <div class="relative">
              <select x-model="itemModal.form.exam" data-hs-select='{
                "placeholder": "Select exam...",
                "toggleTag": "<button type=\"button\" aria-expanded=\"false\"></button>",
                "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500",
                "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto",
                "optionClasses": "py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100",
                "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
              }' class="hidden">
                <option value="1">Mock Test 1</option>
                <option value="2">Mock Test 2</option>
                <option value="3">Weekly Quiz</option>
              </select>
            </div>
          </div>

          <div class="space-y-1 relative" x-show="itemModal.form.content_type === 'exam_section'">
            <label class="block text-xs font-medium text-gray-700">Select Exam Section</label>
            <div class="relative">
               <select x-model="itemModal.form.exam_section" data-hs-select='{
                "placeholder": "Select section...",
                "toggleTag": "<button type=\"button\" aria-expanded=\"false\"></button>",
                "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500",
                "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto",
                "optionClasses": "py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100",
                "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
              }' class="hidden">
                <option value="english">English Section</option>
                <option value="math">Math Section</option>
                <option value="science">Science Section</option>
              </select>
            </div>
            <p class="text-xs text-gray-500 mt-2">Search and select the specific exam and its section.</p>
          </div>

          <div class="space-y-1 relative" x-show="itemModal.form.content_type === 'chapter_content'">
            <label class="block text-xs font-medium text-gray-700">Select Content</label>
             <div class="relative">
               <select multiple x-model="itemModal.form.chapter_content" data-hs-select='{
                "placeholder": "Select chapter content(s)...",
                "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full",
                "optionClasses": "py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100",
                "mode": "tags",
                "wrapperClasses": "relative ps-0.5 pe-9 flex items-center flex-wrap text-nowrap w-full border border-gray-200 rounded-lg text-start text-sm focus:border-emerald-500 focus:ring-emerald-500",
                "tagsItemTemplate": "<div class=\"flex flex-nowrap items-center relative z-10 bg-white border border-gray-200 rounded-full p-1 m-1\"><div class=\"ms-2 whitespace-nowrap text-gray-800\" data-title></div><div class=\"inline-flex shrink-0 justify-center items-center size-5 ms-2 rounded-full text-gray-800 bg-gray-200 hover:bg-gray-300 cursor-pointer\" data-remove><svg class=\"shrink-0 size-3\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M18 6 6 18\"/><path d=\"m6 6 12 12\"/></svg></div></div>",
                "tagsInputClasses": "border-0 focus:ring-0 px-2 rounded-lg order-1 text-sm outline-none",
                "optionTemplate": "<div class=\"flex items-center\"><div><div class=\"text-sm font-semibold text-gray-800\" data-title></div></div><div class=\"ms-auto\"><span class=\"hidden hs-selected:block\"><svg class=\"shrink-0 size-4 text-emerald-600\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\"><path d=\"M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z\"/></svg></span></div></div>",
                "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
              }' class="hidden">
                <option value="vid1">Video: Intro to Algebra</option>
                <option value="quiz1">Quiz: Algebra Basics</option>
                <option value="notes1">Notes: Formula Sheet</option>
              </select>
            </div>
            <p class="text-xs text-gray-500 mt-2">Search and select the specific chapter contents.</p>
          </div>
        </div>

        <div x-show="itemModal.form.item_type !== 'scholastic'" class="space-y-4">
          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-800">Title</label>
            <input x-model="itemModal.form.title" type="text" class="py-2 px-3 block w-full border-gray-200 rounded-lg text-sm focus:border-emerald-600 focus:ring-emerald-600 placeholder:text-gray-400" placeholder="e.g., Debate Club or Total Attendance">
            <p class="text-xs text-gray-500 mt-2">Name of the activity or metric.</p>
          </div>
        </div>

        <div x-show="itemModal.form.item_type === 'co_scholastic'" class="space-y-4">
          <div class="grid sm:grid-cols-2 gap-4">
            <div class="space-y-2 relative">
              <label class="block text-sm font-medium text-gray-800">Scoring Type</label>
              <div class="relative">
                <select x-model="itemModal.form.scoring_type" data-hs-select='{
                    "placeholder": "Select Scoring",
                    "toggleTag": "<button type=\"button\" aria-expanded=\"false\"></button>",
                    "toggleClasses": "hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 relative py-2 ps-3 pe-9 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border border-gray-200 rounded-lg text-start text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500",
                    "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto",
                    "optionClasses": "py-2 px-4 w-full text-sm text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100",
                    "extraMarkup": "<div class=\"absolute top-1/2 end-3 -translate-y-1/2\"><svg class=\"shrink-0 size-3.5 text-gray-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m7 15 5 5 5-5\"/><path d=\"m7 9 5-5 5 5\"/></svg></div>"
                  }' class="hidden">
                  <option value="grade">Grade</option>
                  <option value="numerical">Numerical</option>
                </select>
              </div>
              <p class="text-xs text-gray-500 mt-2">Grading method used.</p>
            </div>
            
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-800">Max Marks</label>
              <input x-model="itemModal.form.maximum_marks" type="number" class="py-2 px-3 block w-full border-gray-200 rounded-lg text-sm focus:border-emerald-600 focus:ring-emerald-600" placeholder="e.g., 10">
              <p class="text-xs text-gray-500 mt-2">Maximum score achievable.</p>
            </div>
          </div>
        </div>

        <div x-show="itemModal.form.item_type === 'attendance'" class="space-y-4">
          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-800">Total Classes</label>
            <input x-model="itemModal.form.total_classes" type="number" class="py-2 px-3 block w-full border-gray-200 rounded-lg text-sm focus:border-emerald-600 focus:ring-emerald-600" placeholder="e.g., 50">
            <p class="text-xs text-gray-500 mt-2">Total sessions held.</p>
          </div>
        </div>

        <div x-show="itemModal.form.item_type !== 'scholastic'" class="flex gap-3 pt-2">
          <div class="flex h-6 shrink-0 items-center">
            <div class="group grid size-4 grid-cols-1">
              <input x-model="itemModal.form.remarks_enabled" type="checkbox" class="col-start-1 row-start-1 appearance-none rounded-sm text-emerald-600 focus:ring-emerald-600 border border-gray-300 bg-white checked:border-emerald-600 checked:bg-emerald-600">
              <svg class="pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white" viewBox="0 0 14 14" fill="none">
                <path class="opacity-0 group-has-checked:opacity-100" d="M3 8L6 11L11 3.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
              </svg>
            </div>
          </div>
          <div class="text-sm/6">
            <label class="font-medium text-gray-900">Enable Remarks</label>
            <p class="text-xs text-gray-500">Allows adding remarks</p>
          </div>
        </div>

      </div>

      <div class="px-4 py-3 border-t border-gray-200 flex justify-end items-center gap-2">
        <button type="button" class="py-2 px-3 text-nowrap inline-flex justify-center items-center text-start bg-white border border-gray-200 text-gray-800 text-sm font-medium rounded-lg shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none" data-hs-overlay="#item-modal">
          Cancel
        </button>
        <button type="button" class="py-2 px-3 text-nowrap inline-flex justify-center items-center gap-x-2 text-start bg-emerald-600 border border-emerald-600 text-white text-sm font-medium rounded-lg shadow-2xs hover:bg-emerald-700 disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:ring-1 focus:ring-emerald-300" @click="saveItemModal" data-hs-overlay="#item-modal">
            Save
        </button>
      </div>
    </div>
  </div>
</div>
  <div id="confirmation-modal" class="hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto [--close-when-click-inside:true] pointer-events-none" role="dialog" tabindex="-1" aria-labelledby="confirmation-modal-label">
  <div class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-lg sm:w-full m-3 sm:mx-auto min-h-[calc(100%-3.5rem)] flex items-center">
    <div class="w-full flex flex-col bg-white border shadow-sm rounded-xl pointer-events-auto dark:bg-neutral-800 dark:border-neutral-700 dark:shadow-neutral-700/70">
      <div class="py-3 px-4 flex justify-between items-center border-b border-gray-200 dark:border-neutral-700">
        <h3 id="confirmation-modal-label" class="font-bold text-gray-800 dark:text-white" x-text="confirmationModal.title || 'Confirm Action'">
          Confirm Action
        </h3>
        <button type="button" class="flex justify-center items-center size-7 text-sm font-semibold rounded-full border border-transparent text-gray-800 hover:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:text-white dark:hover:bg-neutral-700" data-hs-overlay="#confirmation-modal">
          <span class="sr-only">Close</span>
          <svg class="flex-shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 6 6 18"></path>
            <path d="m6 6 12 12"></path>
          </svg>
        </button>
      </div>
      <div class="p-4 overflow-y-auto">
        <p class="text-gray-800 dark:text-neutral-400" x-text="confirmationModal.message || 'Are you sure you want to proceed?'">
          Are you sure you want to proceed?
        </p>
      </div>
      <div class="flex justify-end items-center gap-x-2 py-3 px-4 border-t border-gray-200 dark:border-neutral-700">
        <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-800" data-hs-overlay="#confirmation-modal">
          Cancel
        </button>
        <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-red-600 text-white hover:bg-red-700 disabled:opacity-50 disabled:pointer-events-none" @click="confirmAction()" data-hs-overlay="#confirmation-modal">
          Confirm
        </button>
      </div>
    </div>
  </div>
</div>
</div>

  </div>

  
<script>
  function reportBuilder() {
    const generateId = () => self.crypto.randomUUID();

    const defaultGroup = (title) => ({
      id: generateId(),
      title,
      description: '',
      maximum_marks: '',
      minimum_marks: '',
      rounding_precision: 1,
      show_average: true,
      show_total: true,
      items: []
    });

    const defaultSection = (title, type = 'scholastic') => ({
      id: generateId(),
      title,
      description: '',
      section_type: type,
      show_total_score: true,
      groups: [defaultGroup('English'), defaultGroup('Math')]
    });

    const moveInArray = (arr, index, direction) => {
      const target = index + direction;
      if (target >= 0 && target < arr.length) {
        [arr[index], arr[target]] = [arr[target], arr[index]];
      }
      return arr;
    };

    return {
      courses: [
        { id: 1, name: "SAT Foundation" },
        { id: 2, name: "IBS Fundamentals" },
        { id: 3, name: "ILETS Crackers 2026" }
      ],
      report: {
        title: 'SAT Progress Report',
        description: 'Auto-computed projection using weekly practice exams.',
        course: 'SAT Foundation',
        state: 'draft',
        remarks_enabled: true
      },
      sections: [defaultSection('SAT Projection')],
      selectedSectionId: null,
      selectedGroupId: null,

      sectionModal: { mode: 'create', editingId: null, form: {} },
      groupModal:   { mode: 'create', editingId: null, sectionId: null, form: {} },
      itemModal:    { mode: 'create', editingId: null, groupId: null, form: {} },
      confirmationModal: { title: '', message: '', action: null },

      init() {
        if (this.sections.length > 0) {
          this.selectedSectionId = this.sections[0].id;
          if (this.sections[0].groups.length > 0) {
            this.selectedGroupId = this.sections[0].groups[0].id;
          }
        }
      },

      get activeSection() {
        return this.sections.find(s => s.id === this.selectedSectionId) || null;
      },

      get activeGroupList() {
        return this.activeSection ? this.activeSection.groups : [];
      },

      get activeGroup() {
        return this.activeGroupList.find(g => g.id === this.selectedGroupId) || null;
      },

      selectSection(id) {
        this.selectedSectionId = id;
        const section = this.sections.find(s => s.id === id);
        this.selectedGroupId = (section && section.groups.length > 0) ? section.groups[0].id : null;
      },

      addSection() {
        const section = defaultSection('New Section', 'scholastic');
        this.sections.push(section);
        this.selectSection(section.id);
      },

      moveSection(index, direction) {
        this.sections = moveInArray([...this.sections], index, direction);
      },

      deleteSection(index) {
        this.openConfirmationModal(
          'Delete Section',
          'Are you sure you want to delete this section? This action cannot be undone.',
          () => {
            this.sections.splice(index, 1);
            if (this.sections.length > 0) {
              this.selectSection(this.sections[0].id);
            } else {
              this.selectedSectionId = null;
              this.selectedGroupId = null;
            }
          }
        );
      },

      moveGroup(sectionId, index, direction) {
        const section = this.sections.find(s => s.id === sectionId);
        if (section) moveInArray(section.groups, index, direction);
      },

      deleteGroup(sectionId, index) {
        const section = this.sections.find(s => s.id === sectionId);
        if (!section) return;

        this.openConfirmationModal(
          'Delete Group',
          'Are you sure you want to delete this group?',
          () => {
             section.groups.splice(index, 1);
             if (!section.groups.find(g => g.id === this.selectedGroupId)) {
               this.selectedGroupId = section.groups.length ? section.groups[0].id : null;
             }
          }
        );
      },

      moveItem(index, direction) {
        if (this.activeGroup) moveInArray(this.activeGroup.items, index, direction);
      },

      removeItem(index) {
        if (!this.activeGroup) return;

        this.openConfirmationModal(
          'Remove Item',
          'Are you sure you want to remove this item?',
          () => {
            this.activeGroup.items.splice(index, 1);
          }
        );
      },

      saveDraft() {
        console.log('Draft saved', this.report, this.sections);
      },

      publish() {
        console.log('Published', this.report, this.sections);
      },

      openSectionModal(id = null) {
        this.sectionModal.mode = id ? 'edit' : 'create';
        this.sectionModal.editingId = id;
        
        const defaults = { title: '', description: '', section_type: 'scholastic', show_total_score: true };
        
        if (id) {
          const section = this.sections.find(s => s.id === id);
          this.sectionModal.form = section ? { ...section } : defaults;
        } else {
          this.sectionModal.form = defaults;
        }
        window.HSOverlay?.open('#section-modal');
      },

      saveSectionModal() {
        if (this.sectionModal.mode === 'edit') {
          const section = this.sections.find(s => s.id === this.sectionModal.editingId);
          if (section) Object.assign(section, this.sectionModal.form);
        } else {
          const newSection = {
            id: generateId(),
            ...this.sectionModal.form,
            title: this.sectionModal.form.title || 'Untitled section',
            groups: []
          };
          this.sections.push(newSection);
          this.selectSection(newSection.id);
        }
        this.$nextTick(() => {
            window.HSDropdown?.autoInit();
            window.HSSelect?.autoInit(); 
        });
      },

      openGroupModal(sectionId, groupId = null) {
        this.groupModal.sectionId = sectionId;
        this.groupModal.mode = groupId ? 'edit' : 'create';
        this.groupModal.editingId = groupId;

        const defaults = { 
          title: '', description: '', maximum_marks: '', minimum_marks: '', 
          rounding_precision: 1, show_average: true, show_total: true 
        };

        if (groupId) {
          const group = this.sections.find(s => s.id === sectionId)?.groups.find(g => g.id === groupId);
          this.groupModal.form = group ? { ...group } : defaults;
        } else {
          this.groupModal.form = defaults;
        }
        window.HSOverlay?.open('#group-modal');
      },

      saveGroupModal() {
        const section = this.sections.find(s => s.id === this.groupModal.sectionId);
        if (!section) return;

        if (this.groupModal.mode === 'edit') {
          const group = section.groups.find(g => g.id === this.groupModal.editingId);
          if (group) Object.assign(group, this.groupModal.form);
        } else {
          const newGroup = {
            id: generateId(),
            ...this.groupModal.form,
            title: this.groupModal.form.title || 'Untitled group',
            items: []
          };
          section.groups.push(newGroup);
          this.selectedGroupId = newGroup.id;
        }
        this.$nextTick(() => {
            window.HSDropdown?.autoInit();
            window.HSSelect?.autoInit();
        });      
      },

      openItemModal(itemId = null) {
        if (!this.activeGroup) return;
        this.itemModal.groupId = this.activeGroup.id;
        this.itemModal.mode = itemId ? 'edit' : 'create';
        this.itemModal.editingId = itemId;

        const sectionType = this.activeSection ? this.activeSection.section_type : 'scholastic';
        const defaults = {
          item_type: sectionType,
          content_type: 'exam',
          exam: [], 
          exam_section: '', 
          chapter_content: [], 
          title: '',
          scoring_type: 'grade',
          maximum_marks: '',
          total_classes: '',
          remarks_enabled: false
        };

        if (itemId) {
          const item = this.activeGroup.items.find(i => i.id === itemId);
          this.itemModal.form = item ? JSON.parse(JSON.stringify(item)) : defaults;
        } else {
          this.itemModal.form = defaults;
        }
        
        this.$nextTick(() => {
            window.HSDropdown?.autoInit();
            window.HSOverlay?.open('#item-modal');
        });
      },

      saveItemModal() {
        if (!this.activeGroup) return;

        const form = this.itemModal.form;
        
        if (this.itemModal.mode === 'create' && form.item_type === 'scholastic') {
            let itemsToCreate = [];

            if (form.content_type === 'exam' && Array.isArray(form.exam) && form.exam.length > 0) {
               form.exam.forEach(ex => {
                   itemsToCreate.push({ ...form, exam: ex, title: 'Exam ' + ex });
               });
            } else if (form.content_type === 'chapter_content' && Array.isArray(form.chapter_content) && form.chapter_content.length > 0) {
               form.chapter_content.forEach(cc => {
                   itemsToCreate.push({ ...form, chapter_content: cc, title: 'Content ' + cc });
               });
            } else {
               itemsToCreate.push({ ...form, title: form.title || 'New Item' });
            }

            itemsToCreate.forEach(newItem => {
                this.activeGroup.items.push({
                    id: generateId(),
                    ...newItem
                });
            });

        } else {
            if (this.itemModal.mode === 'edit') {
              const item = this.activeGroup.items.find(i => i.id === this.itemModal.editingId);
              if (item) Object.assign(item, form);
            } else {
              this.activeGroup.items.push({
                id: generateId(),
                ...form,
                title: form.title || 'New Item'
              });
            }
        }
        this.$nextTick(() => window.HSDropdown?.autoInit());
      },

      openConfirmationModal(title, message, action) {
        this.confirmationModal.title = title;
        this.confirmationModal.message = message;
        this.confirmationModal.action = action;
        window.HSOverlay?.open('#confirmation-modal');
      },

      confirmAction() {
        if (this.confirmationModal.action) {
          this.confirmationModal.action();
        }
        this.confirmationModal.action = null; 
      }
    };
  }
</script>

</body>


</html>
