<!doctype html>
<html class=" ">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Eleventy v3.0.0">
  <title>Mindset Report</title>
  <link rel="stylesheet" href="/pr-preview/pr-732/css/tailwind.css" />
  
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  <script>
    sans = [
        'ui-sans-serif',
        'system-ui',
        '-apple-system',
        'BlinkMacSystemFont',
        '"Segoe UI"',
        'Roboto',
        '"Helvetica Neue"',
        'Arial',
        '"Noto Sans"',
        'sans-serif',
        '"Apple Color Emoji"',
        '"Segoe UI Emoji"',
        '"Segoe UI Symbol"',
        '"Noto Color Emoji"',
    ]
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter var', ...sans],
          },
        }
      }
    }
  </script>
  
  <link rel="stylesheet" href="/pr-preview/pr-732/node_modules/apexcharts/dist/apexcharts.css">


  <script defer src="https://unpkg.com/alpinejs@3.4.2/dist/cdn.min.js"></script>
  <script src="/node_modules/preline/dist/preline.js"></script>

   <style>
    [x-cloak] {
      display: none !important;
    }
  </style>
</head>

 
  <body class="antialiased h-full overflow-y-scroll min-h-screen bg-gray-100">
    <div class="min-h-full">
      
  <div x-data="mindsetInsightsComponent()" x-init="init()" class="py-5 max-w-7xl mx-auto lg:px-8 px-4 space-y-5">
    <div>
      <div x-cloak aria-live="assertive" class="pointer-events-none fixed inset-0 flex items-end px-4 py-6 sm:items-start sm:p-6 z-50">
  <div class="flex w-full flex-col items-center space-y-4 sm:items-end">
    <div
      x-cloak
      x-show="showReflectionReminderToast"
      x-transition:enter="transform ease-out duration-300 transition"
      x-transition:enter-start="translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2"
      x-transition:enter-end="translate-y-0 opacity-100 sm:translate-x-0"
      x-transition:leave="transition ease-in duration-100"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"
      class="pointer-events-auto w-full max-w-sm overflow-hidden rounded-lg bg-white shadow-lg outline outline-1 outline-black/5 ring-1 ring-black/5 dark:bg-gray-800 dark:-outline-offset-1 dark:outline-white/10"
    >
      <div class="p-4">
        <div class="flex items-start">
          <div class="shrink-0">
            <svg 
                class="size-6 text-gray-400" 
                xmlns="http://www.w3.org/2000/svg" 
                width="24" 
                height="24" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                stroke-width="2" 
                stroke-linecap="round" 
                stroke-linejoin="round"
              >
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 16v-4"/>
                <path d="M12 8h.01"/>
              </svg>
          </div>
          <div class="ml-3 w-0 flex-1 pt-0.5">
            <p class="text-sm font-medium text-gray-900 dark:text-white">Pending Reflections</p>
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
              You have <span x-text="pendingReflectionsCount"></span> errors that haven't been reflected on yet. Reflecting on your mistakes helps identify patterns and improve your exam performance.
            </p>
            <div class="mt-3 flex space-x-7">
              <a href="/exam_review/answers/" class="rounded-md text-sm font-medium text-emerald-600 hover:text-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 dark:text-emerald-400 dark:hover:text-emerald-300">Reflect now</a>
            </div>
          </div>
          <div class="ml-4 flex shrink-0">
            <button @click="showReflectionReminderToast = false" type="button" class="inline-flex rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 dark:bg-gray-800 dark:text-gray-400 dark:hover:text-gray-300">
              <span class="sr-only">Close</span>
              <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
      <nav class="sm:hidden mb-2" aria-label="Back">
  <a href="/exam_review/dashboard/" class="flex items-center text-sm font-medium text-gray-500 hover:text-gray-700">
    <svg class="-ml-1 mr-1 h-5 w-5 flex-shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
      <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
    </svg>
    Back
  </a>
</nav>
<nav class="hidden sm:flex mb-2" aria-label="Breadcrumb">
  <ol role="list" class="flex items-center space-x-4">
    <li>
      <div class="flex items-center">
        <a href="#" class="text-sm font-medium text-gray-500 hover:text-gray-700">
          IBPS PO Prelims
        </a>
      </div>
    </li>
    <li>
      <div class="flex items-center">
        <svg class="size-5 shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
          <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"></path>
        </svg>
        <a href="/exam_review/dashboard/" class="ml-4 text-sm font-medium text-gray-500 hover:text-gray-700" aria-current="page">
          Review
        </a>
      </div>
    </li>
    <li>
      <div class="flex items-center">
        <svg class="size-5 shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
          <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"></path>
        </svg>
        <a href="#" class="ml-4 text-sm font-medium text-gray-500 hover:text-gray-700" aria-current="page">
          Mindset Insights
        </a>
      </div>
    </li>
  </ol>
</nav>
      <div>
  <div class="flex flex-wrap justify-between items-end gap-2">
    <div>
      <h1 class="text-lg md:text-xl font-semibold text-gray-800">
        Exam Mindset Insights for IBPS PO Prelims
      </h1>
      <div class="text-sm text-gray-500">
        <span class="text-gray-500">
          Analysis of your reflections and behavioral exam-taking patterns.
        </span>
      </div>
    </div>
    
    <div class="flex items-center gap-x-3">
      <a 
        href="/exam_review/consolidated_mindset_insights/" 
        class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-800 dark:focus:bg-neutral-800"
      >
        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21.21 15.89A10 10 0 1 1 8 2.83"/>
          <path d="M22 12A10 10 0 0 0 12 2v10z"/>
        </svg>
        View Overall Report
      </a>
    </div>
  </div>
</div>
    </div>
    <div class="flex flex-col bg-white border border-gray-200 shadow-2xs rounded-xl dark:bg-neutral-800 dark:border-neutral-700">
  <div class="py-3 px-5 flex justify-between items-center border-b border-gray-200 dark:border-neutral-700">
    <h2 class="inline-block font-semibold text-gray-800 dark:text-neutral-200">
      Pre-Exam Mindset
    </h2>
  </div>

  <div x-show="loading.preTest">
    <div class="h-[50vh] flex flex-col justify-center items-center text-center">
  <div role="status">
    <svg
      aria-hidden="true"
      class="inline w-10 h-10 text-gray-200 animate-spin dark:text-gray-600 fill-emerald-600"
      viewBox="0 0 100 101"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
        fill="currentColor"
      />
      <path
        d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
        fill="currentFill"
      />
    </svg>
    <span class="sr-only">Loading...</span>
  </div>
</div>
  </div>

  <div class="p-5" x-cloak x-show="!loading.preTest">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-start">
      <div class="text-gray-700">
        <div class="space-y-2">
          <h3 class="text-md font-semibold text-gray-800 underline underline-offset-2">About Pre-Exam Mindset</h3>
          <p class="text-sm text-gray-600">
            Doing your best on a exam starts with the right mindset.
            This screener provides insight into how you were
            feeling in the moments just before the exam began. A low score on a positive trait (like Focus) or a high score on a negative one (like Anxiety) can indicate a barrier to performing your best.
          </p>
        </div>
        <div class="my-5 border-b border-gray-200 dark:border-neutral-700"></div>
        <template x-if="preTestNotes && preTestNotes.length > 0">
          <dl>
            <template x-for="(note, idx) in preTestNotes" :key="note.id || idx">
              <div class="my-6">
                <dt class="flex w-full items-start justify-between text-left text-gray-900 dark:text-neutral-200">
                  <span class="text-sm font-medium" x-text="note.label"></span>
                  <span class="inline-flex items-center rounded-md bg-gray-50 dark:bg-neutral-700 px-2 py-1 text-xs font-medium text-gray-600 dark:text-neutral-300 ring-1 ring-inset ring-gray-500/10 dark:ring-neutral-600">Text Response</span>
                </dt>
                <dd class="mt-2 pr-12">
                  <p class="text-sm text-gray-600 dark:text-neutral-400" x-text="note.response || 'No response provided.'"></p>
                </dd>
              </div>
            </template>
          </dl>
        </template>
        <template x-if="!preTestNotes || preTestNotes.length === 0">
          <div class="text-sm text-gray-500">
            No pre-exam text responses were provided.
          </div>
        </template>
      </div>

      <div>
        <template x-if="preTestRatings && preTestRatings.length > 0">
          <div>
            <template x-for="(rating, index) in preTestRatings" :key="rating.id">
              <div class="mb-4 space-y-2">
                <div class="flex items-center gap-x-2">
                  <h4 class="text-sm font-medium dark:text-neutral-200" x-text="rating.label"></h4>
                </div>
                <template x-if="rating.type === 'positive'">
                  <fieldset disabled>
  <legend class="sr-only" x-text="rating.label"></legend>
  <div class="flex gap-2">
    <label :for="rating.id + '-1'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-red-100/50 text-red-700 border border-red-200 hover:bg-red-100/80 has-[:checked]:bg-red-500/90 has-[:checked]:border-red-600 has-[:checked]:text-white dark:bg-red-900/50 dark:border-red-800 dark:text-red-300 dark:hover:bg-red-900/70 dark:has-[:checked]:bg-red-500 dark:has-[:checked]:border-red-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-1'" :name="rating.id + '-rating'" value="1" class="hidden" :checked="sanitizeScore(rating.score) == 1">
      <span>1</span>
    </label>
    <label :for="rating.id + '-2'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-orange-100/50 text-orange-700 border border-orange-200 hover:bg-orange-100/80 has-[:checked]:bg-orange-500 has-[:checked]:border-orange-600 has-[:checked]:text-white dark:bg-orange-900/50 dark:border-orange-800 dark:text-orange-300 dark:hover:bg-orange-900/70 dark:has-[:checked]:bg-orange-600 dark:has-[:checked]:border-orange-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-2'" :name="rating.id + '-rating'" value="2" class="hidden" :checked="sanitizeScore(rating.score) == 2">
      <span>2</span>
    </label>
    <label :for="rating.id + '-3'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-yellow-100/50 text-yellow-700 border border-yellow-200 hover:bg-yellow-100/80 has-[:checked]:bg-yellow-500 has-[:checked]:border-yellow-600 has-[:checked]:text-white dark:bg-yellow-900/50 dark:border-yellow-800 dark:text-yellow-300 dark:hover:bg-yellow-900/70 dark:has-[:checked]:bg-yellow-600 dark:has-[:checked]:border-yellow-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-3'" :name="rating.id + '-rating'" value="3" class="hidden" :checked="sanitizeScore(rating.score) == 3">
      <span>3</span>
    </label>
    <label :for="rating.id + '-4'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-lime-100/50 text-lime-700 border border-lime-200 hover:bg-lime-100/80 has-[:checked]:bg-lime-500 has-[:checked]:border-lime-600 has-[:checked]:text-white dark:bg-lime-900/50 dark:border-lime-800 dark:text-lime-300 dark:hover:bg-lime-900/70 dark:has-[:checked]:bg-lime-600 dark:has-[:checked]:border-lime-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-4'" :name="rating.id + '-rating'" value="4" class="hidden" :checked="sanitizeScore(rating.score) == 4">
      <span>4</span>
    </label>
    <label :for="rating.id + '-5'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-green-100/50 text-green-700 border border-green-200 hover:bg-green-100/80 has-[:checked]:bg-green-600 has-[:checked]:border-green-700 has-[:checked]:text-white dark:bg-green-900/50 dark:border-green-800 dark:text-green-300 dark:hover:bg-green-900/70 dark:has-[:checked]:bg-green-600 dark:has-[:checked]:border-green-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-5'" :name="rating.id + '-rating'" value="5" class="hidden" :checked="sanitizeScore(rating.score) == 5">
      <span>5</span>
    </label>
  </div>
</fieldset>
                </template>
                <template x-if="rating.type === 'negative'">
                  <fieldset disabled>
  <legend class="sr-only" x-text="rating.label"></legend>
  <div class="flex gap-2">
    <label :for="rating.id + '-1'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-green-100/50 text-green-700 border border-green-200 hover:bg-green-100/80 has-[:checked]:bg-green-600 has-[:checked]:border-green-700 has-[:checked]:text-white dark:bg-green-900/50 dark:border-green-800 dark:text-green-300 dark:hover:bg-green-900/70 dark:has-[:checked]:bg-green-600 dark:has-[:checked]:border-green-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-1'" :name="rating.id + '-rating'" value="1" class="hidden" :checked="sanitizeScore(rating.score) == 1">
      <span>1</span>
    </label>
    <label :for="rating.id + '-2'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-lime-100/50 text-lime-700 border border-lime-200 hover:bg-lime-100/80 has-[:checked]:bg-lime-500 has-[:checked]:border-lime-600 has-[:checked]:text-white dark:bg-lime-900/50 dark:border-lime-800 dark:text-lime-300 dark:hover:bg-lime-900/70 dark:has-[:checked]:bg-lime-600 dark:has-[:checked]:border-lime-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-2'" :name="rating.id + '-rating'" value="2" class="hidden" :checked="sanitizeScore(rating.score) == 2">
      <span>2</span>
    </label>
    <label :for="rating.id + '-3'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-yellow-100/50 text-yellow-700 border border-yellow-200 hover:bg-yellow-100/80 has-[:checked]:bg-yellow-500 has-[:checked]:border-yellow-600 has-[:checked]:text-white dark:bg-yellow-900/50 dark:border-yellow-800 dark:text-yellow-300 dark:hover:bg-yellow-900/70 dark:has-[:checked]:bg-yellow-600 dark:has-[:checked]:border-yellow-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-3'" :name="rating.id + '-rating'" value="3" class="hidden" :checked="sanitizeScore(rating.score) == 3">
      <span>3</span>
    </label>
    <label :for="rating.id + '-4'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-orange-100/50 text-orange-700 border border-orange-200 hover:bg-orange-100/80 has-[:checked]:bg-orange-500 has-[:checked]:border-orange-600 has-[:checked]:text-white dark:bg-orange-900/50 dark:border-orange-800 dark:text-orange-300 dark:hover:bg-orange-900/70 dark:has-[:checked]:bg-orange-600 dark:has-[:checked]:border-orange-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-4'" :name="rating.id + '-rating'" value="4" class="hidden" :checked="sanitizeScore(rating.score) == 4">
      <span>4</span>
    </label>
    <label :for="rating.id + '-5'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-red-100/50 text-red-700 border border-red-200 hover:bg-red-100/80 has-[:checked]:bg-red-500/90 has-[:checked]:border-red-600 has-[:checked]:text-white dark:bg-red-900/50 dark:border-red-800 dark:text-red-300 dark:hover:bg-red-900/70 dark:has-[:checked]:bg-red-600 dark:has-[:checked]:border-red-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-5'" :name="rating.id + '-rating'" value="5" class="hidden" :checked="sanitizeScore(rating.score) == 5">
      <span>5</span>
    </label>
  </div>
</fieldset>
                </template>
                </div>
            </template>
          </div>
        </template>
        <template x-if="!preTestRatings || preTestRatings.length === 0">
          <div class="text-sm text-gray-500">
            No pre-exam scale responses were provided.
          </div>
        </template>
      </div>
    </div>
  </div>
</div>
    <div class="flex flex-col bg-white border border-gray-200 shadow-2xs rounded-xl dark:bg-neutral-800 dark:border-neutral-700">
  <div class="py-3 px-5 flex justify-between items-center border-b border-gray-200 dark:border-neutral-700">
    <h2 class="inline-block font-semibold text-gray-800 dark:text-neutral-200">
      Post-Exam Reflection
    </h2>
  </div>
  <div x-show="loading.postTest">
    <div class="h-[50vh] flex flex-col justify-center items-center text-center">
  <div role="status">
    <svg
      aria-hidden="true"
      class="inline w-10 h-10 text-gray-200 animate-spin dark:text-gray-600 fill-emerald-600"
      viewBox="0 0 100 101"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
        fill="currentColor"
      />
      <path
        d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
        fill="currentFill"
      />
    </svg>
    <span class="sr-only">Loading...</span>
  </div>
</div>
  </div>
  <div class="p-5" x-cloak x-show="!loading.postTest">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-start">
      <div class="text-gray-700">
        <div class="space-y-2">
          <h3 class="text-md font-semibold text-gray-800 underline underline-offset-2">About Post-Exam Reflection</h3>
          <p class="text-sm text-gray-600">
            Reflecting on your exam performance helps identify what went well and where you can improve.
            If you felt rushed or anxious, it might affect your results. Use this insight to focus your future study and exam strategies.
          </p>
        </div>
        <div class="my-5 border-b border-gray-200 dark:border-neutral-700"></div>
        <template x-if="postTestNotes && postTestNotes.length > 0">
          <dl>
            <template x-for="(note, idx) in postTestNotes" :key="note.id || idx">
              <div class="my-6">
                <dt class="flex w-full items-start justify-between text-left text-gray-900 dark:text-neutral-200">
                  <span class="text-sm font-medium" x-text="note.label"></span>
                  <span class="inline-flex items-center rounded-md bg-gray-50 dark:bg-neutral-700 px-2 py-1 text-xs font-medium text-gray-600 dark:text-neutral-300 ring-1 ring-inset ring-gray-500/10 dark:ring-neutral-600">Text Response</span>
                </dt>
                <dd class="mt-2 pr-12">
                  <p class="text-sm text-gray-600 dark:text-neutral-400" x-text="note.response || 'No response provided.'"></p>
                </dd>
              </div>
            </template>
          </dl>
        </template>
        <template x-if="!postTestNotes || postTestNotes.length === 0">
          <div class="text-sm text-gray-500">
            No post-exam text responses were provided.
          </div>
        </template>
      </div>
      <div>
        <template x-if="postTestRatings && postTestRatings.length > 0">
          <div>
            <template x-for="(rating, index) in postTestRatings" :key="rating.id">
              <div class="mb-4 space-y-2">
                <div class="flex items-center gap-x-2">
                  <h4 class="text-sm font-medium dark:text-neutral-200" x-text="rating.label"></h4>
                </div>      
                <template x-if="rating.type === 'positive'">
                  <fieldset disabled>
  <legend class="sr-only" x-text="rating.label"></legend>
  <div class="flex gap-2">
    <label :for="rating.id + '-1'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-red-100/50 text-red-700 border border-red-200 hover:bg-red-100/80 has-[:checked]:bg-red-500/90 has-[:checked]:border-red-600 has-[:checked]:text-white dark:bg-red-900/50 dark:border-red-800 dark:text-red-300 dark:hover:bg-red-900/70 dark:has-[:checked]:bg-red-500 dark:has-[:checked]:border-red-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-1'" :name="rating.id + '-rating'" value="1" class="hidden" :checked="sanitizeScore(rating.score) == 1">
      <span>1</span>
    </label>
    <label :for="rating.id + '-2'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-orange-100/50 text-orange-700 border border-orange-200 hover:bg-orange-100/80 has-[:checked]:bg-orange-500 has-[:checked]:border-orange-600 has-[:checked]:text-white dark:bg-orange-900/50 dark:border-orange-800 dark:text-orange-300 dark:hover:bg-orange-900/70 dark:has-[:checked]:bg-orange-600 dark:has-[:checked]:border-orange-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-2'" :name="rating.id + '-rating'" value="2" class="hidden" :checked="sanitizeScore(rating.score) == 2">
      <span>2</span>
    </label>
    <label :for="rating.id + '-3'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-yellow-100/50 text-yellow-700 border border-yellow-200 hover:bg-yellow-100/80 has-[:checked]:bg-yellow-500 has-[:checked]:border-yellow-600 has-[:checked]:text-white dark:bg-yellow-900/50 dark:border-yellow-800 dark:text-yellow-300 dark:hover:bg-yellow-900/70 dark:has-[:checked]:bg-yellow-600 dark:has-[:checked]:border-yellow-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-3'" :name="rating.id + '-rating'" value="3" class="hidden" :checked="sanitizeScore(rating.score) == 3">
      <span>3</span>
    </label>
    <label :for="rating.id + '-4'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-lime-100/50 text-lime-700 border border-lime-200 hover:bg-lime-100/80 has-[:checked]:bg-lime-500 has-[:checked]:border-lime-600 has-[:checked]:text-white dark:bg-lime-900/50 dark:border-lime-800 dark:text-lime-300 dark:hover:bg-lime-900/70 dark:has-[:checked]:bg-lime-600 dark:has-[:checked]:border-lime-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-4'" :name="rating.id + '-rating'" value="4" class="hidden" :checked="sanitizeScore(rating.score) == 4">
      <span>4</span>
    </label>
    <label :for="rating.id + '-5'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-green-100/50 text-green-700 border border-green-200 hover:bg-green-100/80 has-[:checked]:bg-green-600 has-[:checked]:border-green-700 has-[:checked]:text-white dark:bg-green-900/50 dark:border-green-800 dark:text-green-300 dark:hover:bg-green-900/70 dark:has-[:checked]:bg-green-600 dark:has-[:checked]:border-green-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-5'" :name="rating.id + '-rating'" value="5" class="hidden" :checked="sanitizeScore(rating.score) == 5">
      <span>5</span>
    </label>
  </div>
</fieldset>
                </template>
                <template x-if="rating.type === 'negative'">
                  <fieldset disabled>
  <legend class="sr-only" x-text="rating.label"></legend>
  <div class="flex gap-2">
    <label :for="rating.id + '-1'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-green-100/50 text-green-700 border border-green-200 hover:bg-green-100/80 has-[:checked]:bg-green-600 has-[:checked]:border-green-700 has-[:checked]:text-white dark:bg-green-900/50 dark:border-green-800 dark:text-green-300 dark:hover:bg-green-900/70 dark:has-[:checked]:bg-green-600 dark:has-[:checked]:border-green-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-1'" :name="rating.id + '-rating'" value="1" class="hidden" :checked="sanitizeScore(rating.score) == 1">
      <span>1</span>
    </label>
    <label :for="rating.id + '-2'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-lime-100/50 text-lime-700 border border-lime-200 hover:bg-lime-100/80 has-[:checked]:bg-lime-500 has-[:checked]:border-lime-600 has-[:checked]:text-white dark:bg-lime-900/50 dark:border-lime-800 dark:text-lime-300 dark:hover:bg-lime-900/70 dark:has-[:checked]:bg-lime-600 dark:has-[:checked]:border-lime-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-2'" :name="rating.id + '-rating'" value="2" class="hidden" :checked="sanitizeScore(rating.score) == 2">
      <span>2</span>
    </label>
    <label :for="rating.id + '-3'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-yellow-100/50 text-yellow-700 border border-yellow-200 hover:bg-yellow-100/80 has-[:checked]:bg-yellow-500 has-[:checked]:border-yellow-600 has-[:checked]:text-white dark:bg-yellow-900/50 dark:border-yellow-800 dark:text-yellow-300 dark:hover:bg-yellow-900/70 dark:has-[:checked]:bg-yellow-600 dark:has-[:checked]:border-yellow-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-3'" :name="rating.id + '-rating'" value="3" class="hidden" :checked="sanitizeScore(rating.score) == 3">
      <span>3</span>
    </label>
    <label :for="rating.id + '-4'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-orange-100/50 text-orange-700 border border-orange-200 hover:bg-orange-100/80 has-[:checked]:bg-orange-500 has-[:checked]:border-orange-600 has-[:checked]:text-white dark:bg-orange-900/50 dark:border-orange-800 dark:text-orange-300 dark:hover:bg-orange-900/70 dark:has-[:checked]:bg-orange-600 dark:has-[:checked]:border-orange-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-4'" :name="rating.id + '-rating'" value="4" class="hidden" :checked="sanitizeScore(rating.score) == 4">
      <span>4</span>
    </label>
    <label :for="rating.id + '-5'" class="flex-1 p-3 flex items-center justify-center text-sm font-medium bg-red-100/50 text-red-700 border border-red-200 hover:bg-red-100/80 has-[:checked]:bg-red-500/90 has-[:checked]:border-red-600 has-[:checked]:text-white dark:bg-red-900/50 dark:border-red-800 dark:text-red-300 dark:hover:bg-red-900/70 dark:has-[:checked]:bg-red-600 dark:has-[:checked]:border-red-500 dark:has-[:checked]:text-white rounded-lg transition-colors">
      <input type="radio" :id="rating.id + '-5'" :name="rating.id + '-rating'" value="5" class="hidden" :checked="sanitizeScore(rating.score) == 5">
      <span>5</span>
    </label>
  </div>
</fieldset>
                </template>
                </div>
            </template>
          </div>
        </template>
        <template x-if="!postTestRatings || postTestRatings.length === 0">
          <div class="text-sm text-gray-500">
            No post-exam scale responses were provided.
          </div>
        </template>
      </div>
    </div>
  </div>
</div>
    <div x-show="!loading.errors && sections.length > 1">
      <div class="flex flex-wrap gap-2">
  <template x-for="section in sections" :key="section.section_id">
    <label
      @click="selectedSectionId = section.section_id; changeSection();"
      :class="[
        'py-2 px-3 relative flex justify-center items-center text-center text-[13px] border ring-1 ring-transparent cursor-pointer rounded-xl transition-colors duration-150 hover:border-emerald-600 hover:ring-emerald-600',
        selectedSectionId === section.section_id
          ? 'bg-emerald-100 border-emerald-200 ring-emerald-200 text-emerald-800'
          : 'bg-white border-gray-200 text-gray-800 dark:bg-neutral-800 dark:text-neutral-200 dark:border-neutral-700'
      ]"
    >
      <span class="block" x-text="section.section_name"></span>
    </label>
  </template>
</div>

    </div>
    <div class="">
  <div class="flex flex-col bg-white border border-gray-200 shadow-2xs rounded-xl dark:bg-neutral-800 dark:border-neutral-700">
    <div class="py-3 px-5 flex justify-between items-center border-b border-gray-200 dark:border-neutral-700">
      <h2 class="inline-block font-semibold text-gray-800 dark:text-neutral-200">
        Reasons for Errors
        <span
          x-show="selectedSectionId !== 'overall'"
          x-text="`(${sections.find(s => s.section_id === selectedSectionId)?.section_name || ''})`"
        ></span>
        <span x-show="selectedSectionId === 'overall'">(Overall)</span>
      </h2>
      <div x-show="!loading.errors && errorSummaryForChart.series && errorSummaryForChart.series.length > 0" class="flex items-center gap-x-2">
        <span class="text-sm font-medium text-gray-600 dark:text-neutral-300">
          Total Reflected Errors:
          <span class="text-sm font-semibold text-gray-900 dark:text-neutral-100">
            <span x-text="errorSummaryForChart.totalErrors"></span>
            <span class="text-gray-500 dark:text-neutral-400"> / </span>
            <span x-text="errorSummaryForChart.totalIncorrect"></span>
          </span>
        </span>
      </div>
    </div>

  <div x-show="loading.errors">
    <div class="h-[50vh] flex flex-col justify-center items-center text-center">
  <div role="status">
    <svg
      aria-hidden="true"
      class="inline w-10 h-10 text-gray-200 animate-spin dark:text-gray-600 fill-emerald-600"
      viewBox="0 0 100 101"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
        fill="currentColor"
      />
      <path
        d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
        fill="currentFill"
      />
    </svg>
    <span class="sr-only">Loading...</span>
  </div>
</div>
  </div>

  <div class="p-5" x-show="!loading.errors">
    <p class="text-sm text-gray-600 dark:text-neutral-400 mb-4">
      This chart breaks down the reasons you selected for your incorrect answers.
      Use it to identify and address your most common exam-taking patterns.
    </p>

    <div class="flex flex-col lg:flex-row justify-center items-center lg:justify-around gap-5">
      <div
        x-show="errorSummaryForChart.series && errorSummaryForChart.series.length > 0"
        class="flex justify-center items-center h-[310px] w-[310px]"
      >
        <div id="error-reason-chart"></div>
      </div>

      <div
        class="w-full lg:w-1/2"
        x-show="errorSummaryForChart.series && errorSummaryForChart.series.length > 0"
      >
        <ul class="space-y-2">
          <template
            x-for="(label, index) in errorSummaryForChart.labels"
            :key="label"
          >
            <li
              @click="showQuestionsForReason(label)"
              class="flex items-center justify-between p-3 bg-gray-50 rounded-lg dark:bg-neutral-900 cursor-pointer transition-all duration-200 ease-out hover:bg-gray-100 hover:shadow-md"
            >
              <div class="flex items-center gap-x-2">
                <span
                  class="size-3 rounded-sm inline-block"
                  :style="`background-color: ${colorMapper.getColor(label)}`"
                ></span>
                <span
                  class="text-sm text-gray-700 dark:text-neutral-300"
                  x-text="label"
                ></span>
              </div>
              <span
                class="text-sm font-medium text-gray-800 dark:text-neutral-200"
                x-text="
                  errorSummaryForChart.series[index] +
                  ' (' +
                  (errorSummaryForChart.totalErrors > 0
                    ? (errorSummaryForChart.series[index] / errorSummaryForChart.totalErrors * 100).toFixed(0)
                    : 0
                  ) +
                  '%)'
                "
              ></span>
            </li>
          </template>
        </ul>
      </div>

      <div
        x-show="!errorSummaryForChart || errorSummaryForChart.series.length === 0"
        class="w-full text-center py-10"
      >
        <p class="text-gray-500">
          No error reflections were provided for this section.
        </p>
        <p class="text-sm text-gray-500 mt-1">
          Reflect on your incorrect answers during review to unlock this insight.
        </p>
      </div>
    </div>
  </div>
  </div>
  <!-- Hidden button to trigger modal opening - always accessible -->
  <button
    id="hs-pro-shflo-trigger"
    data-hs-overlay="#hs-pro-shflo"
    class="hidden"
    aria-label="Open questions modal"
  ></button>
  <div id="hs-pro-shflo" class="hs-overlay hs-overlay-open:translate-x-0 hidden translate-x-full fixed top-0 end-0 transition-all duration-300 transform h-full sm:w-100 lg:w-[33%] z-[9999] flex flex-col bg-white dark:bg-neutral-800" role="dialog" tabindex="-1" aria-labelledby="hs-pro-shflo-label" @click.self.stop @hs-overlay-close.window="selectedErrorReason = null">
  <!-- Header -->
  <div class="py-3 px-6 flex justify-between items-center border-b border-gray-200 rounded-lg dark:border-neutral-700 relative z-10 bg-white dark:bg-neutral-800">
    <h3 id="hs-pro-shflo-label" class="font-medium text-gray-800 dark:text-neutral-200">
      Questions for Mistake Reasons
      <span x-show="selectedErrorReason" class="text-sm font-normal text-gray-600 dark:text-neutral-400">
        (<span x-text="selectedErrorReason"></span>)
      </span>
    </h3>
    <button 
      type="button" 
      @click="selectedErrorReason = null"
      class="py-1.5 px-2 inline-flex justify-center items-center gap-x-1 rounded-full border border-gray-200 text-xs text-gray-800 hover:bg-gray-100 focus:outline-hidden focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:hover:bg-neutral-700 dark:text-neutral-200 dark:focus:bg-neutral-700" 
      aria-label="Close" 
      data-hs-overlay="#hs-pro-shflo"
    >
      <span class="hidden lg:block">Esc</span>
      <span class="block lg:hidden">Close</span>
      <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
    </button>
  </div>
  <!-- End Header -->

  <!-- Body -->
  <div class="bg-gray-100 h-full overflow-y-auto overflow-hidden relative z-10 [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300 dark:[&::-webkit-scrollbar-track]:bg-neutral-700 dark:[&::-webkit-scrollbar-thumb]:bg-neutral-500 dark:bg-neutral-800">
    <div class="p-2 space-y-2">
        
       

      <div 
        x-show="!selectedErrorReason || 'Misread the Question' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    1. <p>What is the capital of France?</p>
  </div>

  <!-- Options -->
  <div class="mt-4">
    <fieldset aria-label="Options" class="space-y-4">
       
       
       
       
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          a
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Paris</p>
        </span>
      </div>
       
       
       
       
       
         
           
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-red-400 text-white ">
          b
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>London</p>
        </span>
      </div>
       
       
       
       
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          c
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Berlin</p>
        </span>
      </div>
       
       
       
       
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          d
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Madrid</p>
        </span>
      </div>
      
    </fieldset>
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I thought the question was asking about the capital of England, not France. Need to read more carefully.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Careless Mistake' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    2. <p>Which of the following are prime numbers? (Select all that apply)</p>
  </div>

  <!-- Options -->
  <div class="mt-4">
    <fieldset aria-label="Options" class="space-y-4">
       
       
       
       
       
         
           
         
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-emerald-400 text-white ">
          a
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>2</p>
        </span>
      </div>
       
       
       
       
       
         
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          b
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>4</p>
        </span>
      </div>
       
       
       
       
       
         
       
         
           
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-emerald-400 text-white ">
          c
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>7</p>
        </span>
      </div>
       
       
       
       
       
         
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          d
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>9</p>
        </span>
      </div>
      
    </fieldset>
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I knew that 2 and 7 are prime numbers, but I accidentally selected 4 as well. Need to double-check my answers.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Lack of Knowledge' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    3. <p>What is the value of Ï€ (pi) to 3 decimal places?</p>
  </div>

  <!-- User Answer -->
  <div class="mt-4">
    <p class="font-medium text-sm text-gray-700 dark:text-neutral-300">Your Answer</p>
    <div class="mt-2">
      
      <div class="inline-block px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg">
        <span class="text-blue-700 dark:text-blue-300 font-medium">
          2.987
        </span>
      </div>
      
    </div>
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I completely forgot the value of pi. Need to memorize basic mathematical constants.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Didn&#39;t Understand Question' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    4. <p>Explain the function of mitochondria in a cell.</p>
  </div>

  <!-- User Answer -->
  <div class="mt-4">
    <p class="font-medium text-sm text-gray-800">Your Answer</p>
    
    <p class="font-medium text-sm flex items-center mt-2 text-gray-600">The mitochondria is the powerhouse of the cell.</p>
    
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I just repeated the common phrase without actually explaining the function. The question asked for an explanation, not just a slogan.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Rushed' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    5. <p>Which of the following is NOT a programming paradigm?</p>
  </div>

  <!-- Options -->
  <div class="mt-4">
    <fieldset aria-label="Options" class="space-y-4">
       
       
       
       
       
         
           
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-red-400 text-white ">
          a
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Object-Oriented Programming</p>
        </span>
      </div>
       
       
       
       
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          b
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Algorithmic Programming</p>
        </span>
      </div>
       
       
       
       
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          c
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Functional Programming</p>
        </span>
      </div>
       
       
       
       
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          d
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Procedural Programming</p>
        </span>
      </div>
      
    </fieldset>
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I was running out of time and quickly selected an answer without thinking. &#39;Algorithmic Programming&#39; is not a standard programming paradigm - it&#39;s more of a general term.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Calculation Error' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    6. <p>Which of the following are renewable energy sources? (Select all that apply)</p>
  </div>

  <!-- Options -->
  <div class="mt-4">
    <fieldset aria-label="Options" class="space-y-4">
       
       
       
       
       
         
           
         
       
         
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-emerald-400 text-white ">
          a
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Solar Energy</p>
        </span>
      </div>
       
       
       
       
       
         
       
         
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-white text-gray-900 border-gray-300">
          b
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Wind Energy</p>
        </span>
      </div>
       
       
       
       
       
         
       
         
           
         
       
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-red-400 text-white ">
          c
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Coal</p>
        </span>
      </div>
       
       
       
       
       
         
       
         
       
         
           
         
       
       
      
      <div class="flex items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <div class="flex shrink-0 justify-center items-center size-7 border border-gray-200 rounded-full uppercase bg-emerald-400 text-white ">
          d
        </div>
        <span class="ml-3 prose prose-sm max-w-none">
          <p>Hydroelectric Power</p>
        </span>
      </div>
      
    </fieldset>
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I correctly identified solar, wind, and hydroelectric as renewable, but I also incorrectly selected coal. Coal is definitely not renewable.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Time Pressure' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    7. <p>What is the speed of light in vacuum (in m/s)?</p>
  </div>

  <!-- User Answer -->
  <div class="mt-4">
    <p class="font-medium text-sm text-gray-700 dark:text-neutral-300">Your Answer</p>
    <div class="mt-2">
      
      <span class="text-gray-400 italic">unanswered</span>
      
    </div>
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I couldn&#39;t remember the exact value and just left it blank. I know it&#39;s approximately 3 x 10^8 m/s, but I need to memorize the precise value.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Used Wrong Strategy' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    8. <p>Define photosynthesis and explain its importance.</p>
  </div>

  <!-- User Answer -->
  <div class="mt-4">
    <p class="font-medium text-sm text-gray-800">Your Answer</p>
    
    <p class="font-medium text-sm flex items-center mt-2 text-gray-600">Photosynthesis is the process by which plants convert light energy into chemical energy.</p>
    
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I only defined photosynthesis but didn&#39;t explain its importance as the question asked. I need to read questions more carefully and address all parts.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Careless Mistake' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    9. <p id="gap-fill-output"></p>
  </div>
</div>
<script>
  // Data coming from Django
  const questionText =
    "The [BLANK_1] Revolution was a turning point. It began in [BLANK_2] and changed [BLANK_3]. People moved to [BLANK_4] areas, and innovations like the steam engine revolutionized [BLANK_5].";

  const userAnswer =
    ["Industrial","German","society","urban","transport"];

  const correctAnswer =
    ["Industrial","Britan","society","urban","transport"];

  function getGapFillHTML(questionText, userAnswer = [], correctAnswer = []) {
    if (!questionText) return '';

    const blanks =
      (questionText.match(/\[BLANK_\d+\]/g) || []).length;

    const parts =
      questionText.split(/\[BLANK_\d+\]/g);

    return parts.map((part, index) => {
      const userAns = userAnswer[index] ?? '';
      const correctAns = correctAnswer[index] ?? '';

      const isCorrect =
        userAns.trim().toLowerCase() ===
        correctAns.trim().toLowerCase();

      let answerSpan = '';
      if (index < blanks) {
        const colorClass = isCorrect
          ? 'border-b-2 border-emerald-500 text-emerald-500'
          : 'border-b-2 border-red-500 text-red-500';

        const displayText = userAns || '(blank)';
        answerSpan =
          `<span class="${colorClass} font-medium px-1">${displayText}</span>`;
      }

      return part + answerSpan;
    }).join('');
  }

  // Render on DOM load
  document.addEventListener('DOMContentLoaded', () => {
    const output = document.getElementById('gap-fill-output');
    output.innerHTML = getGapFillHTML(
      questionText,
      userAnswer,
      correctAnswer
    );
  });
</script>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I knew the answer was water and oxygen, but I wrote them in the wrong order. I need to pay more attention to the sequence of the gaps.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Careless Mistake' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    10. Match the countries with their capitals:
  </div>

  <!-- Match Pairs - User Answers -->
  <div class="mt-4">
    <fieldset aria-label="Match Options" class="space-y-4 max-w-2xl">
       
       
       
       
       
       
      
      <div class="grid grid-cols-12 gap-x-4 items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <!-- Left: Question label with circled letter -->
        <div class="col-span-5 flex items-center gap-2">
          <div class="flex shrink-0 justify-center items-center size-7 border rounded-full uppercase bg-red-400 text-white border-red-400 ">
            A
          </div>
          <span>France</span>
        </div>

        <!-- Middle: Arrow icon -->
        <div class="col-span-1 flex justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-move-right text-gray-400">
            <path d="M18 8L22 12L18 16" />
            <path d="M2 12H22" />
          </svg>
        </div>

        <!-- Right: User-selected answer -->
        <div class="text-sm col-span-6">
          
          <span>Tokyo</span>
          
        </div>
      </div>
       
       
       
       
      
      <div class="grid grid-cols-12 gap-x-4 items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <!-- Left: Question label with circled letter -->
        <div class="col-span-5 flex items-center gap-2">
          <div class="flex shrink-0 justify-center items-center size-7 border rounded-full uppercase bg-red-400 text-white border-red-400 ">
            B
          </div>
          <span>Japan</span>
        </div>

        <!-- Middle: Arrow icon -->
        <div class="col-span-1 flex justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-move-right text-gray-400">
            <path d="M18 8L22 12L18 16" />
            <path d="M2 12H22" />
          </svg>
        </div>

        <!-- Right: User-selected answer -->
        <div class="text-sm col-span-6">
          
          <span>Paris</span>
          
        </div>
      </div>
       
       
       
       
      
      <div class="grid grid-cols-12 gap-x-4 items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <!-- Left: Question label with circled letter -->
        <div class="col-span-5 flex items-center gap-2">
          <div class="flex shrink-0 justify-center items-center size-7 border rounded-full uppercase bg-emerald-400 text-white border-emerald-400 ">
            C
          </div>
          <span>India</span>
        </div>

        <!-- Middle: Arrow icon -->
        <div class="col-span-1 flex justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-move-right text-gray-400">
            <path d="M18 8L22 12L18 16" />
            <path d="M2 12H22" />
          </svg>
        </div>

        <!-- Right: User-selected answer -->
        <div class="text-sm col-span-6">
          
          <span>New Delhi</span>
          
        </div>
      </div>
       
       
       
       
      
      <div class="grid grid-cols-12 gap-x-4 items-center font-medium text-sm text-gray-600 dark:text-neutral-400">
        <!-- Left: Question label with circled letter -->
        <div class="col-span-5 flex items-center gap-2">
          <div class="flex shrink-0 justify-center items-center size-7 border rounded-full uppercase bg-emerald-400 text-white border-emerald-400 ">
            D
          </div>
          <span>Germany</span>
        </div>

        <!-- Middle: Arrow icon -->
        <div class="col-span-1 flex justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-move-right text-gray-400">
            <path d="M18 8L22 12L18 16" />
            <path d="M2 12H22" />
          </svg>
        </div>

        <!-- Right: User-selected answer -->
        <div class="text-sm col-span-6">
          
          <span>Berlin</span>
          
        </div>
      </div>
       
    </fieldset>
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I knew the answer was water and oxygen, but I wrote them in the wrong order. I need to pay more attention to the sequence of the gaps.
              </p>
            </div>
          </div>
        </div>
        
      </div>
        
       

      <div 
        x-show="!selectedErrorReason || 'Careless Mistake' === selectedErrorReason"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        class="p-4 bg-white rounded-lg shadow-2xs dark:bg-neutral-900"
      >
         
         
          <div>
  <!-- Question -->
  <div class="font-medium text-sm text-gray-800 dark:text-neutral-200 prose prose-sm max-w-none flex">
    11. Describe the impact of social media on modern communication.
  </div>

  <!-- User Answer -->
  <div class="mt-4">
    <dd class="max-w-2xl">
      <ul role="list" class="divide-y divide-gray-100 dark:divide-neutral-700 rounded-md border border-gray-200 dark:border-neutral-700">
        <li class="flex items-center justify-between py-2 pl-4 pr-5 text-sm/6">
          <div class="flex w-0 flex-1 items-center">
            <svg class="size-5 shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
              <path fill-rule="evenodd" d="M15.621 4.379a3 3 0 0 0-4.242 0l-7 7a3 3 0 0 0 4.241 4.243h.001l.497-.5a.75.75 0 0 1 1.064 1.057l-.498.501-.002.002a4.5 4.5 0 0 1-6.364-6.364l7-7a4.5 4.5 0 0 1 6.368 6.36l-3.455 3.553A2.625 2.625 0 1 1 9.52 9.52l3.45-3.451a.75.75 0 1 1 1.061 1.06l-3.45 3.451a1.125 1.125 0 0 0 1.587 1.595l3.454-3.553a3 3 0 0 0 0-4.242Z" clip-rule="evenodd"></path>
            </svg>
            <div class="ml-4 flex min-w-0 flex-1 gap-2">
              
              <span
                class="truncate font-medium text-sm text-gray-800 dark:text-neutral-200"
              >
                social_media_impact.pdf
              </span>
              
            </div>
          </div>
          
        </li>
      </ul>
    </dd>
  </div>
</div>
 
        

        <!-- Notes Section -->
        
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4 mt-4">
          <div class="flex">
            <div class="ml-3">
              <p class="text-sm text-yellow-700">
                I knew the answer was water and oxygen, but I wrote them in the wrong order. I need to pay more attention to the sequence of the gaps.
              </p>
            </div>
          </div>
        </div>
        
      </div>
      
    </div>
  </div>
  <!-- End Body -->

</div>
<!-- End Cart Offcanvas -->
</div>
    <div class="flex flex-col bg-white border border-gray-200 shadow-2xs rounded-xl" x-cloak
  x-show="!loading.errors && errorSummaryForChart.bySubject && errorSummaryForChart.bySubject.length > 0">
  <div class="py-3 px-5 border-b border-gray-200 flex justify-between items-center">
    <h2 class="text-base font-semibold text-gray-900">
      Error Breakdown by Subject
      <span
        x-show="selectedSectionId !== 'overall'"
        x-text="`(${sections.find(s => s.section_id === selectedSectionId)?.section_name || ''})`"
        class="text-gray-500 font-normal"
      ></span>
    </h2>
  </div>
  <div class="p-5">
    <p class="text-sm text-gray-500 mb-4">
      Finding the 'why' for each subject error in the selected section.
    </p>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
      <template x-for="topic in errorSummaryForChart.bySubject" :key="topic.id">
      <div class="p-4 border border-gray-200 rounded-lg">
          <h3 class="font-semibold text-gray-800" x-text="topic.name"></h3>
          <p class="text-sm text-gray-500" x-text="topic.errors + (topic.errors === 1 ? ' error' : ' errors') + ' reflected'"></p>
          <div x-show="topic.series.length > 0" class="flex flex-col sm:flex-row items-center gap-4 mt-2">
            <div class="flex-shrink-0">
              <div :id="'subject-chart-' + topic.id" class="min-h-[10rem] min-w-[10rem]"></div>
            </div>
            <ul class="space-y-1 w-full">
              <template x-for="(label, index) in topic.labels" :key="label">
                <li class="flex items-center justify-between text-sm">
                  <div class="flex items-center gap-x-2">
                    <span class="size-2.5 rounded-sm inline-block" :style="'background-color:' + topic.colors[index]"></span>
                    <span class="text-gray-600" x-text="label"></span>
                  </div>
                  <span class="font-medium text-gray-700" x-text="topic.series[index]"></span>
                </li>
              </template>
            </ul>
          </div>
          <div x-show="topic.errors === 0" class="mt-4 text-center py-5 bg-gray-50 rounded-lg">
            <p class="text-sm text-emerald-700 font-medium">No errors for this topic. Good work!</p>
          </div>
          <div x-show="topic.errors > 0 && topic.series.length === 0" class="mt-4 text-center py-5 bg-gray-50 rounded-lg">
            <p class="text-sm text-gray-500">No reflections were provided for the mistakes in this topic.</p>
          </div>
        </div>
      </template>
    </div>
  </div>
</div>
    <div class="flex flex-col bg-white border border-gray-200 shadow-2xs rounded-xl dark:bg-neutral-800 dark:border-neutral-700">
  <div class="py-3 px-5 flex justify-between items-center border-b border-gray-200 dark:border-neutral-700">
    <h2 class="inline-block font-semibold text-gray-800 dark:text-neutral-200">
      Steps you can take to improve
    </h2>
  </div>

  <div x-show="loading.pathway">
    <div class="h-[50vh] flex flex-col justify-center items-center text-center">
  <div role="status">
    <svg
      aria-hidden="true"
      class="inline w-10 h-10 text-gray-200 animate-spin dark:text-gray-600 fill-emerald-600"
      viewBox="0 0 100 101"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
        fill="currentColor"
      />
      <path
        d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
        fill="currentFill"
      />
    </svg>
    <span class="sr-only">Loading...</span>
  </div>
</div>
  </div>

  <template x-if="!loading.pathway">
    <div x-cloak>
      <template x-if="pathway.topErrors && pathway.topErrors.length > 0">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-10">
          <div class="flex flex-col bg-white dark:bg-neutral-800">
            <div class="p-5 pb-4 grid grid-cols-2 items-center gap-x-4 relative z-10">
              <div>
                <h2 class="inline-block font-semibold text-lg text-gray-800 dark:text-neutral-200">
                  Top Error Reasons
                </h2>
              </div>
            </div>
            <div class="p-5 pt-0">
              <div class="w-full h-64 md:h-72 lg:h-80 flex items-center justify-center">
                <div id="hs-devices-bubble-chart" class="w-full h-full" x-show="pathway.topErrors.length > 0"></div>
                <p class="text-gray-500" x-show="pathway.topErrors.length === 0">No error reflections provided.</p>
              </div>
            </div>
            <div class="p-5" x-show="pathway.topErrors.length > 0">
              <ul class="space-y-1">
                <li class="py-3 grid grid-cols-2 justify-between items-center gap-x-4 border-b last:border-b-0 border-gray-200 dark:border-neutral-700">
                  <div>
                    <h4 class="font-medium text-gray-800 dark:text-neutral-200">
                      Error Reason
                    </h4>
                  </div>
                  <div class="text-end">
                    <h4 class="font-medium text-gray-800 dark:text-neutral-200">
                      Count
                    </h4>
                  </div>
                </li>
                <template x-for="error in pathway.topErrors" :key="error.id">
                  <li class="py-3 grid grid-cols-2 justify-between items-center gap-x-4 border-b last:border-b-0 border-gray-200 dark:border-neutral-700">
                    <div class="flex items-center">
                      <span
                        class="shrink-0 size-2.5 inline-block rounded-xs me-2.5"
                        :style="`background-color: ${colorMapper.getColor(error.reason)}`"
                      ></span>
                      <span class="text-sm text-gray-800 dark:text-neutral-200" x-text="error.reason"></span>
                    </div>
                    <div class="flex justify-end items-center gap-x-1.5">
                      <span class="text-sm text-gray-500 dark:text-neutral-500" x-text="error.count"></span>
                      <span class="text-sm text-gray-500 dark:text-neutral-500" x-text="`(${error.percentage}%)`"></span>
                    </div>
                  </li>
                </template>
              </ul>
              <template x-if="pathway.topErrors.length > 0">
                <div
                  x-data="{
                    firstErrorReason: pathway.topErrors[0].reason,
                    secondErrorReason: pathway.topErrors.length > 1 ? pathway.topErrors[1].reason : null,
                    improvementPhrase: pathway.topErrors[0].improvementPhrase
                  }"
                  class="mt-4 p-3.5 bg-emerald-50 border border-emerald-200 rounded-lg dark:bg-emerald-900/20 dark:border-emerald-700/50"
                >
                  <div class="flex">
                    <div class="flex-shrink-0">
                      <svg class="shrink-0 size-5 text-emerald-600 dark:text-emerald-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="16" x2="12" y2="12"/>
                        <line x1="12" y1="8" x2="12.01" y2="8"/>
                      </svg>
                    </div>
                    <div class="ms-3">
                      <p class="text-sm text-emerald-700 dark:text-emerald-300">
                        The two prominent reasons for the mistakes you did during the exam are
                        <strong x-text="firstErrorReason"></strong>
                        <template x-if="secondErrorReason">
                          <span> and <strong x-text="secondErrorReason"></strong></span>
                        </template>
                        as per your reflections.
                        This indicates that <strong x-text="improvementPhrase"></strong> will be most effective in boosting your score.
                      </p>
                    </div>
                  </div>
                </div>
              </template>
            </div>
          </div>
          <div>
            <div class="flex flex-col gap-6 lg:gap-10">
              <template x-for="(error, idx) in pathway.topErrors.slice(0, 2)" :key="error.id">
                <template x-data="{ strategyKey: strategyMap[error.id], strategy: improvementStrategies[strategyMap[error.id]] }" x-if="strategy">
                  <div class="p-5 flex flex-col bg-white dark:bg-neutral-800">
                    <div class="mb-4 flex items-start justify-between gap-x-3">
                      <div class="grow">
                        <p class="font-semibold text-xl md:text-2xl text-gray-800 dark:text-neutral-200" x-text="strategy.name"></p>
                      </div>
                    </div>
                    <div class="space-y-3">
                      <p class="text-sm text-gray-500 dark:text-neutral-500" x-text="'This strategy helps with errors like: ' + error.reason + '.'"></p>
                      <div>
                        <h4 class="text-sm font-semibold text-gray-800 dark:text-neutral-200">About This Strategy</h4>
                        <p class="mt-1 text-sm text-gray-700 dark:text-neutral-300" x-text="strategy.description"></p>
                      </div>
                      <div>
                        <h4 class="text-sm font-semibold text-gray-800 dark:text-neutral-200">Recommended Focus</h4>
                        <p class="mt-1 text-sm text-gray-700 dark:text-neutral-300" x-text="strategy.guidance"></p>
                      </div>
                      <div>
                        <h4 class="text-sm font-semibold text-gray-800 dark:text-neutral-200">Actionable Steps</h4>
                        <p class="mt-1 text-sm text-gray-700 dark:text-neutral-300" x-text="strategy.studentBehavior"></p>
                      </div>
                    </div>
                  </div>              
                </template>
                <template x-if="idx === 0">
                  <div class="my-5 border-t border-gray-200 dark:border-neutral-700"></div>
                </template>
              </template>
            </div>
          </div>
        </div>
      </template>
      <template x-if="!pathway.topErrors || pathway.topErrors.length === 0">
        <div class="w-full text-center py-10">
          <p class="text-gray-500">No improvement suggestions are available for this attempt.</p>
          <p class="text-sm text-gray-500 mt-1">Complete your error reflections to build your path to improvement.</p>
        </div>
      </template>
    </div>
  </template>
</div>
  </div>

    </div>

    
  <script src="https://preline.co/pro/assets/vendor/lodash/lodash.min.js"></script>
<script src="https://preline.co/pro/assets/vendor/apexcharts/dist/apexcharts.min.js"></script>
<script src="https://preline.co/pro/assets/js/hs-apexcharts-helpers.js"></script>

<script>
  function renderDonutChart(
    chartId,
    seriesData,
    seriesLabels,
    chartColors,
    chartHeight = 230,
    chartWidth = 230
  ) {
    const chartEl = document.querySelector(chartId);
    if (!chartEl) {
      console.warn(`Chart element ${chartId} not found.`);
      return;
    }
    chartEl.innerHTML = '';
    const options = (mode) => ({
      chart: {
        height: chartHeight,
        width: chartWidth,
        type: 'donut',
        zoom: { enabled: false }
      },
      plotOptions: { pie: { donut: { size: '76%' } } },
      series: seriesData,
      labels: seriesLabels,
      legend: { show: false },
      dataLabels: { enabled: false },
      stroke: { width: 5 },
      grid: { padding: { top: -12, bottom: -11, left: -12, right: -12 } },
      states: {
        hover: { filter: { type: 'none', value: 0 } },
        active: { allowMultipleDataPointsSelection: false }
      },
      tooltip: {
        enabled: true,
        custom: ({ seriesIndex, w }) => {
          if (seriesIndex < 0 || !w.globals.labels[seriesIndex]) return '';
          const label = w.globals.labels[seriesIndex];
          const value = w.globals.series[seriesIndex];
          const total = w.globals.series.reduce((a, b) => a + b, 0);
          const percentage = ((value / total) * 100).toFixed(1);
          const color = w.globals.colors[seriesIndex];
          return `
  <div class="border border-gray-300 bg-white w-36 text-gray-900 shadow-xl">
    <div class="px-2 py-1.5 font-semibold text-[13px] flex items-center">
      <span>${label}</span>
      <span class="ms-auto">${percentage}%</span>
    </div>
    <div class="border-t border-gray-200"></div>
    <div class="space-y-1.5 p-2">
      <div class="flex items-center gap-x-2 text-xs text-gray-600">
        <span class="w-3 h-3 rounded-sm inline-block" style="background:${color}"></span>
        <span>Count</span>
        <span class="ms-auto">${value}</span>
      </div>
    </div>
  </div>
          `;
        }
      }
    });
    const theme = { colors: chartColors, stroke: { colors: ['#ffffff'] } };
    buildChart(chartId, options, theme, theme);
  }

  function renderPieChart(
    chartId,
    seriesData,
    seriesLabels,
    chartColors,
    chartHeight = 310,
    chartWidth = 310
  ) {
    const chartEl = document.querySelector(chartId);
    if (!chartEl) {
      console.warn(`Chart element ${chartId} not found.`);
      return;
    }
    chartEl.innerHTML = '';

    const options = (mode) => ({
      chart: {
        height: chartHeight,
        width: chartWidth,
        type: 'pie',
        zoom: { enabled: false }
      },
      plotOptions: {
        pie: {
          expandOnClick: true,
          donut: {
            labels: {
              show: false
            }
          }
        }
      },
      series: seriesData,
      labels: seriesLabels,
      legend: { show: false },
      dataLabels: { enabled: false },
      stroke: { width: 2, colors: ['#ffffff'] },
      grid: {
        padding: { top: 10, bottom: 10, left: 10, right: 10 }
      },
      states: {
        hover: {
          filter: { type: 'darken', value: 0.95 }
        },
        active: {
          allowMultipleDataPointsSelection: false,
          filter: { type: 'darken', value: 0.85 }
        }
      },
      tooltip: {
        enabled: true,
        custom: ({ seriesIndex, w }) => {
          if (seriesIndex < 0 || !w.globals.labels[seriesIndex]) return '';
          const label = w.globals.labels[seriesIndex];
          const value = w.globals.series[seriesIndex];
          const total = w.globals.series.reduce((a, b) => a + b, 0);
          const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
          const color = w.globals.colors[seriesIndex];

          return `
  <div class="border border-gray-300 bg-white w-36 text-gray-900 shadow-xl">
    <div class="px-2 py-1.5 font-semibold text-[13px] flex items-center">
      <span class="break-words whitespace-normal w-full block">${label}</span>
      <span class="ms-auto">${percentage}%</span>
    </div>
    <div class="border-t border-gray-200"></div>
    <div class="space-y-1.5 p-2">
      <div class="flex items-center gap-x-2 text-xs text-gray-600">
        <span class="w-3 h-3 rounded-sm inline-block" style="background:${color}"></span>
        <span>Count</span>
        <span class="ms-auto">${value}</span>
      </div>
    </div>
  </div>
          `;
        }
      }
    });

    const theme = {
      colors: chartColors,
      stroke: {
        colors: ['#ffffff']
      }
    };

    buildChart(chartId, options, theme, theme);
  }

  function renderBubbleChart(chartId, seriesData, chartColors, actualPercentages) {
    const chartEl = document.querySelector(chartId);
    if (!chartEl) {
      console.warn(`Chart element ${chartId} not found.`);
      return;
    }

    chartEl.innerHTML = '';

    const textColors = (chartColors || [])
      .slice(0, seriesData.length)
      .map((hex) => {
        if (!hex) return '#1f2937';
        const h = hex.replace('#', '');
        const r = parseInt(h.substring(0, 2), 16);
        const g = parseInt(h.substring(2, 4), 16);
        const b = parseInt(h.substring(4, 6), 16);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        return brightness > 160 ? '#1f2937' : '#ffffff';
      });

    const options = () => ({
      chart: {
        height: '100%',
        type: 'bubble',
        toolbar: { show: false },
        zoom: { enabled: false }
      },
      series: seriesData,
      dataLabels: {
        style: {
          fontSize: '18px',
          fontFamily: 'Inter, ui-sans-serif',
          fontWeight: '600',
          colors: textColors
        },
        formatter: (_value, opts) => {
          const idx = opts.seriesIndex;
          return actualPercentages && actualPercentages[idx] != null
            ? `${actualPercentages[idx]}%`
            : '';
        }
      },
      fill: { opacity: 1 },
      legend: { show: false },
      plotOptions: {
        bubble: {
          zScaling: false,
          minBubbleRadius: 40
        }
      },
      grid: {
        show: false,
        padding: { top: 0, bottom: 0, left: 0, right: 0 }
      },
      xaxis: {
        min: 0,
        max: 15,
        labels: { show: false },
        axisBorder: { show: false },
        axisTicks: { show: false }
      },
      yaxis: {
        min: 0,
        max: 15,
        labels: { show: false }
      },
      tooltip: { 
        enabled: true,
        custom: ({ seriesIndex, w }) => {
          const name = w.config.series[seriesIndex].name;
          const percent = actualPercentages[seriesIndex];
          return `<div class="p-2 bg-white border border-gray-200 shadow-lg rounded-lg">
                    <div class="text-xs font-bold">${name}</div>
                    <div class="text-[10px] text-gray-500">${percent}% of total mistakes</div>
                  </div>`;
        }
      },
      states: { hover: { filter: { type: 'none' } } }
    });

    buildChart(
      chartId,
      options,
      { colors: chartColors, markers: { strokeColors: 'rgb(255, 255, 255)' } },
      { colors: chartColors, markers: { strokeColors: 'rgb(38, 38, 38)' } }
    );
  }
</script>
  <script>
  const COLOR_PALETTE = [
    '#3B82F6', // blue-500
    '#6366F1', // indigo-500
    '#8B5CF6', // purple-500
    '#EC4899', // pink-500
    '#F43F5E', // rose-500
    '#F97316', // orange-500
    '#EAB308', // yellow-500
    '#22C55E', // green-500
    '#10B981', // emerald-500
    '#14B8A6', // teal-500
    '#06B6D4', // cyan-500
    '#64748B', // slate-500
    '#9CA3AF', // gray-400
    '#F87171', // red-400
    '#A78BFA', // violet-400
  ];

  class ColorMapper {
    constructor(baseLabels = []) {
      this.mapping = {};
      this.colorIndex = 0;
      baseLabels.forEach(label => {
        this.getColor(label);
      });
    }

    getColor(label) {
      if (!this.mapping[label]) {
        this.mapping[label] = COLOR_PALETTE[this.colorIndex % COLOR_PALETTE.length];
        this.colorIndex++;
      }
      return this.mapping[label];
    }

    getColorsForLabels(labels = []) {
      return labels.map(label => this.getColor(label));
    }
  }
</script>

<script>
  function mindsetInsightsComponent() {
    return {
      data: {"preTestAnswers":{"scale_based":[{"id":"anxiety","score":1,"label":"How anxious are you feeling?","type":"negative","scaleMin":1,"scaleMax":5},{"id":"confidence","score":5,"label":"Confidence","type":"positive","scaleMin":1,"scaleMax":5},{"id":"focus","score":2,"label":"How focused are you feeling right now?","type":"positive","scaleMin":1,"scaleMax":5},{"id":"rested","score":3,"label":"How well-rested are you?","type":"positive","scaleMin":1,"scaleMax":5}],"text_based":[{"id":"pre_notes","label":"Any additional thoughts before you start?","response":"I reviewed Chapter 3 last night, but I'm still worried about the graph questions..."},{"id":"strategy_goal","label":"What is your primary goal or strategy for this exam?","response":"To manage my time better on the math section and not get stuck."}]},"postTestAnswers":{"scale_based":[{"id":"anxiety_during","score":2,"label":"Did you feel anxious while taking the exam?","type":"negative","scaleMin":1,"scaleMax":5},{"id":"rushed","score":5,"label":"Did you feel time was running out / you felt rushed?","type":"negative","scaleMin":1,"scaleMax":5},{"id":"clarity","score":3,"label":"How clear were the questions to you?","type":"positive","scaleMin":1,"scaleMax":5},{"id":"difficulty_perception","score":4,"label":"How difficult did you find this exam overall?","type":"negative","scaleMin":1,"scaleMax":5},{"id":"focus_during","score":2,"label":"How well were you able to maintain focus?","type":"positive","scaleMin":1,"scaleMax":5}],"text_based":[{"id":"held_back","label":"What held you back from performing your best?","response":"I felt the time was rushing fast and I messed up in the graph problems."},{"id":"improve_note","label":"What stood out about how you could improve?","response":"I need to practice more math problems, especially graphs and interpreting axes."},{"id":"overall_feedback","label":"Any other feedback about the exam experience?","response":"Consider a few practice graph templates in the prep materials."}]},"errorReasons":{"totalErrors":28,"totalIncorrect":35,"summary":{"ids":["rushed","calculation","lack_knowledge","time_pressure","didnt_understand","misread","careless","wrong_strategy","guessed","others"],"labels":["Rushed","Calculation Error","Lack of Knowledge","Time Pressure","Didn't Understand Question","Misread the Question","Careless Mistake","Used Wrong Strategy","Guessed","Others"],"series":[6,5,4,3,3,2,2,1,1,1]},"bySection":[{"id":"english","name":"English","totalIncorrect":15,"ids":["didnt_understand","misread","rushed","lack_knowledge","guessed","others"],"labels":["Didn't Understand Question","Misread the Question","Rushed","Lack of Knowledge","Guessed","Others"],"series":[3,2,2,1,1,1],"errors":10,"bySubject":[{"id":"rc","name":"Reading Comprehension","ids":["didnt_understand","rushed"],"labels":["Didn't Understand Question","Rushed"],"series":[2,1],"errors":3},{"id":"grammar","name":"Grammar","ids":["lack_knowledge","misread"],"labels":["Lack of Knowledge","Misread the Question"],"series":[1,1],"errors":2},{"id":"vocab","name":"Vocabulary","ids":["guessed","others"],"labels":["Guessed","Others"],"series":[1,1],"errors":2},{"id":"para_jumbles","name":"Para Jumbles","ids":["misread","didnt_understand"],"labels":["Misread the Question","Didn't Understand Question"],"series":[1,1],"errors":2},{"id":"cloze_test","name":"Cloze Test","ids":["rushed"],"labels":["Rushed"],"series":[1],"errors":1}]},{"id":"maths","name":"Maths","totalIncorrect":20,"ids":["calculation","rushed","time_pressure","lack_knowledge","careless","wrong_strategy"],"labels":["Calculation Error","Rushed","Time Pressure","Lack of Knowledge","Careless Mistake","Used Wrong Strategy"],"series":[5,4,3,3,2,1],"errors":18,"bySubject":[{"id":"arithmetic","name":"Arithmetic","ids":["calculation","rushed","time_pressure"],"labels":["Calculation Error","Rushed","Time Pressure"],"series":[2,2,1],"errors":5},{"id":"algebra","name":"Algebra","ids":["calculation","lack_knowledge"],"labels":["Calculation Error","Lack of Knowledge"],"series":[1,2],"errors":3},{"id":"geometry","name":"Geometry","ids":["lack_knowledge","wrong_strategy"],"labels":["Lack of Knowledge","Used Wrong Strategy"],"series":[1,1],"errors":2},{"id":"data_interp","name":"Data Interpretation","ids":["rushed","time_pressure","careless"],"labels":["Rushed","Time Pressure","Careless Mistake"],"series":[2,1,1],"errors":4},{"id":"number_system","name":"Number System","ids":["calculation","time_pressure"],"labels":["Calculation Error","Time Pressure"],"series":[1,1],"errors":2},{"id":"trigonometry","name":"Trigonometry","ids":["calculation","careless"],"labels":["Calculation Error","Careless Mistake"],"series":[1,1],"errors":2}]}]},"pathway":{"topErrors":[{"id":"rushed","label":"Rushed","count":6,"exampleQuestions":["Q7 - data interpretation","Q15 - paragraph summary"],"suggestedStrategy":"test_skill","suggestedImprovement":"focusing on timing discipline and exam strategy"},{"id":"lack_knowledge","label":"Lack of Knowledge","count":4,"exampleQuestions":["Q3 - algebraic simplification","Q19 - grammar rule"],"suggestedStrategy":"conceptual","suggestedImprovement":"revising weak concepts and practicing targeted questions"},{"id":"didnt_understand","label":"Didn't Understand Question","count":3,"exampleQuestions":["Q28 - data interpretation set"],"suggestedStrategy":"comprehension","suggestedImprovement":"slowing down to interpret questions carefully"}]},"improvementStrategies":{"test_skill":{"name":"Boost Exam-Taking Skills","guidance":"Focus on pacing during the exam, double-check work for small errors, and avoid rushing at the end. Practice timed quizzes to build consistency under pressure.","description":"Improving exam behavior and time management can significantly increase accuracy without needing major concept revision.","studentBehavior":"Try short timed sections and celebrate small wins (e.g., finishing one section without rushing). When you notice time slipping, pause and choose 1 quick step: simplify the problem, mark it to return, or estimate an answer."},"conceptual":{"name":"Strengthen Concept Mastery","guidance":"Review foundational ideas behind the topics where mistakes occurred. Practice similar question types to reinforce core strategies and problem-solving methods.","description":"Better command of required knowledge leads to more confident and reliable performance.","studentBehavior":"Break down the concept into 2â€“3 core rules and practice 5 focused problems. Keep notes of repeated patterns that help you solve similar problems faster next time."},"comprehension":{"name":"Improve Question Understanding","guidance":"Slow down while reading, underline key words, and restate the problem in your own words. Look out for small hints or constraints in the question.","description":"Careful reading helps avoid avoidable errors and ensures the right strategy is applied.","studentBehavior":"Before solving, spend 6â€“8 seconds paraphrasing the question out loud or in writing and underline what the question specifically asks for. This habit prevents misapplied strategies."}},"strategyMap":{"rushed":"test_skill","didnt_understand":"comprehension","misread":"comprehension","time_pressure":"test_skill","calculation":"test_skill","lack_knowledge":"conceptual","careless":"test_skill","wrong_strategy":"conceptual","guessed":"test_skill","others":"test_skill"}},
      loading: {
        preTest: true,
        postTest: true,
        errors: true,
        pathway: true
      },

      preTestRatings: [],
      preTestNotes: [],
      postTestRatings: [],
      postTestNotes: [],
      sections: [],
      selectedSectionId: null,
      errorSummaryForChart: { labels: [], series: [], totalErrors: 0, totalIncorrect: 0, bySubject: [] },
      showReflectionReminderToast: false,
      selectedErrorReason: null,
      pathway: {
        topErrors: [],
        mindsetBarriers: [],
        totalErrors: 0
      },

      improvementStrategies: {},
      strategyMap: {},
      
      colorMapper: null,
      _bubbleRendered: false,

      init() {
        requestAnimationFrame(() => {
          const src = this.data || {};
          const overallLabels = src.errorReasons?.summary?.labels || [];
          this.colorMapper = new ColorMapper(overallLabels);
          this.processReflections(src);
          this.processErrorData(src);
          this.processPathway(src);
          if (this.sections.length > 0) {
            this.selectedSectionId = this.sections[0].section_id;
            this.changeSection(false);
          }
          this.loading.preTest = false;
          this.loading.postTest = false;
          this.loading.errors = false;
          this.loading.pathway = false;
          this.$nextTick(() => {
            this.renderErrorChart();
            this.renderPathwayCharts();
            this.renderSubjectErrorCharts();
          });
        });
      },

      get pendingReflectionsCount() {
        if (!this.errorSummaryForChart) return 0;
        return this.errorSummaryForChart.totalIncorrect - this.errorSummaryForChart.totalErrors;
      },

      processReflections(src) {
        const pre = src.preTestAnswers || {};
        this.preTestRatings = Array.isArray(pre.scale_based) ? pre.scale_based : [];
        this.preTestNotes = Array.isArray(pre.text_based) ? pre.text_based : [];
        const post = src.postTestAnswers || {};
        this.postTestRatings = Array.isArray(post.scale_based) ? post.scale_based : [];
        this.postTestNotes = Array.isArray(post.text_based) ? post.text_based : [];
      },

      processErrorData(src) {
        const errorReasons = src.errorReasons || { summary: null, bySection: [] };
        const summary = errorReasons.summary || {};
        const bySection = Array.isArray(errorReasons.bySection) ? errorReasons.bySection : [];
        this.pathway.totalErrors = errorReasons.totalErrors || 0;
        const overallTotalIncorrect = errorReasons.totalIncorrect || errorReasons.totalErrors || 0;
        this.sections = [];
        if (summary.series && summary.series.length > 0) {
          this.sections.push({
            section_id: 'overall',
            section_name: 'Overall',
            data: {
              ids: summary.ids,
              labels: summary.labels,
              series: summary.series,
              totalErrors: this.pathway.totalErrors,
              totalIncorrect: overallTotalIncorrect,
              bySubject: []
            }
          });
        }
        bySection.forEach(subject => {
          const subTopics = (subject.bySubject || []).map(sub => ({
            ...sub,
            colors: this.colorMapper.getColorsForLabels(sub.labels)
          }));
          if (subject.series && subject.series.length > 0) {
            this.sections.push({
              section_id: subject.id || subject.name,
              section_name: subject.name,
              data: {
                ids: subject.ids,
                labels: subject.labels,
                series: subject.series,
                totalErrors: subject.errors || 0,
                totalIncorrect: subject.totalIncorrect || subject.errors || 0,
                bySubject: subTopics
              }
            });
          }
        });
      },

      processPathway(src) {
        this.improvementStrategies = src.improvementStrategies || {};
        this.strategyMap = src.strategyMap || {};
        const srcPathway = src.pathway || { topErrors: [] };
        if (this.pathway.totalErrors > 0) {
          this.pathway.topErrors = (srcPathway.topErrors || [])
            .sort((a, b) => b.count - a.count)
            .slice(0, 3)
            .map(err => {
              return {
                id: err.id,
                reason: err.label,
                count: err.count,
                percentage: Math.round((err.count / this.pathway.totalErrors) * 100),
                improvementPhrase: err.suggestedImprovement || "reviewing your errors"
              };
            });
        }
      },

      changeSection(renderChart = true) {
        const selected = this.sections.find(s => s.section_id === this.selectedSectionId);
        if (!selected) {
          this.errorSummaryForChart = { labels: [], series: [], totalErrors: 0, totalIncorrect: 0, bySubject: [] };
          this.showReflectionReminderToast = false;
          return;
        }
        this.errorSummaryForChart = selected.data;
        
        const hasPendingReflections = this.errorSummaryForChart.totalErrors < this.errorSummaryForChart.totalIncorrect;
        this.showReflectionReminderToast = false;
        
        if (hasPendingReflections) {
          this.$nextTick(() => {
            const TOAST_ANIMATION_RETRIGGER_DELAY_MS = 50;
            setTimeout(() => {
              this.showReflectionReminderToast = true;
            }, TOAST_ANIMATION_RETRIGGER_DELAY_MS);
          });
        }

        if (renderChart) {
          this.$nextTick(() => {
            this.renderErrorChart();
            this.renderSubjectErrorCharts();
          });
        }
      },

      renderErrorChart() {
        const chartEl = document.querySelector('#error-reason-chart');
        if (!this.errorSummaryForChart.series?.length || !this.errorSummaryForChart.totalErrors) {
          if (chartEl) chartEl.innerHTML = '';
          return;
        }
        const chartColors = this.colorMapper.getColorsForLabels(this.errorSummaryForChart.labels);
        renderPieChart(
          '#error-reason-chart',
          this.errorSummaryForChart.series,
          this.errorSummaryForChart.labels,
          chartColors
        );
      },

      renderPathwayCharts() {
        const chartEl = document.querySelector('#hs-devices-bubble-chart');
        if (!chartEl) return;
        if (!this.pathway.topErrors?.length) {
          chartEl.innerHTML = '';
          return;
        }
        const topErrors = this.pathway.topErrors;
        const prelineSeries = [
          { name: "Top Error 1", data: [[8.5, 7.5, 90]] },
          { name: "Top Error 2", data: [[4.5, 7, 70]] },
          { name: "Top Error 3", data: [[6.2, 5.2, 40]] }
        ];
        const chartColors = [];
        const actualPercentages = [];
        topErrors.forEach((error, index) => {
          if (prelineSeries[index]) {
            prelineSeries[index].name = error.reason;
            chartColors[index] = this.colorMapper.getColor(error.reason);
            actualPercentages[index] = error.percentage;
          }
        });
        const finalSeries = prelineSeries.slice(0, topErrors.length);
        const finalColors = chartColors.slice(0, topErrors.length);
        const finalPercentages = actualPercentages.slice(0, topErrors.length);
        chartEl.innerHTML = '';
        renderBubbleChart('#hs-devices-bubble-chart', finalSeries, finalColors, finalPercentages);
        this._bubbleRendered = true;
      },

      renderSubjectErrorCharts() {
        const topics = this.errorSummaryForChart.bySubject || [];
        const currentChartIds = new Set(topics.map(t => `subject-chart-${t.id}`));
        document.querySelectorAll('[id^="subject-chart-"]').forEach(el => {
          if (!currentChartIds.has(el.id)) {
            el.innerHTML = '';
          }
        });
        if (topics.length === 0) return;
        topics.forEach(topic => {
          const chartId = `#subject-chart-${topic.id}`;
          const chartEl = document.querySelector(chartId);
          if (chartEl && topic.series && topic.series.length > 0) {
            renderPieChart(
              chartId,
              topic.series,
              topic.labels,
              topic.colors,
              160,
              160
            );
          }
        });
      },
      
      sanitizeScore(score, min = 1, max = 5) {
        const s = parseInt(score, 10) || 1;
        return Math.max(min, Math.min(max, s));
      },
      
      showQuestionsForReason(reasonLabel) {
        this.selectedErrorReason = reasonLabel;
        this.$nextTick(() => {
          const triggerBtn = document.getElementById('hs-pro-shflo-trigger');
          if (triggerBtn) {
            triggerBtn.click();
          }
        });
      }
    };
  }
</script>


  </body>


</html>
