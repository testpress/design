<table class="min-w-full divide-y divide-gray-200" x-data="aiUsageTable()" @filter-changed.window="filter_by = $event.detail" @sort-changed.window="order_by = $event.detail, sortTable()">
  <thead>
  <tr>
    <th class="bg-gray-50 px-6 py-3 text-left text-sm font-semibold text-gray-900" scope="col">No</th>
    <th class="bg-gray-50 px-6 py-3 text-left text-sm font-semibold text-gray-900" scope="col">Custom Field</th>
    <th class="bg-gray-50 px-6 py-3 text-left text-sm font-semibold text-gray-900" scope="col">No of User Responses</th>
    <th class="bg-gray-50 px-6 py-3 text-left text-sm font-semibold text-gray-900" scope="col">Pages Processed</th>
    <th class="bg-gray-50 px-6 py-3 text-left text-sm font-semibold text-gray-900" scope="col">Tokens Used</th>
  </tr>
</thead>

  <tbody class="divide-y divide-gray-200 bg-white" id="table-body">
    
      <tr data-s-no="1" 
          data-custom-field="Hall Ticket"
          data-responses-yesterday="3"
          data-responses-week="12"
          data-responses-month="42"
          data-responses-year="50"
          data-pages-yesterday="15"
          data-pages-week="60"
          data-pages-month="210"
          data-pages-year="230"
          data-tokens-yesterday="120"
          data-tokens-week="480"
          data-tokens-month="3200"
          data-tokens-year="3500">
        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">1</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">Hall Ticket</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">3</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">12</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">42</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">50</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">15</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">60</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">210</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">230</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">120</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">480</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">3200</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">3500</span>
</td>

      </tr>
    
      <tr data-s-no="2" 
          data-custom-field="Admit Card"
          data-responses-yesterday="2"
          data-responses-week="8"
          data-responses-month="28"
          data-responses-year="32"
          data-pages-yesterday="7"
          data-pages-week="22"
          data-pages-month="110"
          data-pages-year="120"
          data-tokens-yesterday="90"
          data-tokens-week="350"
          data-tokens-month="2100"
          data-tokens-year="2300">
        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">2</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">Admit Card</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">2</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">8</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">28</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">32</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">7</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">22</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">110</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">120</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">90</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">350</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">2100</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">2300</span>
</td>

      </tr>
    
      <tr data-s-no="3" 
          data-custom-field="Mark Sheet"
          data-responses-yesterday="1"
          data-responses-week="5"
          data-responses-month="19"
          data-responses-year="22"
          data-pages-yesterday="4"
          data-pages-week="15"
          data-pages-month="75"
          data-pages-year="80"
          data-tokens-yesterday="60"
          data-tokens-week="220"
          data-tokens-month="1600"
          data-tokens-year="1700">
        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">3</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">Mark Sheet</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">1</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">5</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">19</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">22</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">4</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">15</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">75</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">80</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">60</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">220</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">1600</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">1700</span>
</td>

      </tr>
    
      <tr data-s-no="4" 
          data-custom-field="Report Card"
          data-responses-yesterday="1"
          data-responses-week="4"
          data-responses-month="13"
          data-responses-year="15"
          data-pages-yesterday="3"
          data-pages-week="10"
          data-pages-month="60"
          data-pages-year="65"
          data-tokens-yesterday="40"
          data-tokens-week="150"
          data-tokens-month="1200"
          data-tokens-year="1300">
        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">4</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">Report Card</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">1</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">4</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">13</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">15</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">3</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">10</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">60</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">65</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">40</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">150</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">1200</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">1300</span>
</td>

      </tr>
    
      <tr data-s-no="5" 
          data-custom-field="Payment Receipt"
          data-responses-yesterday="1"
          data-responses-week="3"
          data-responses-month="11"
          data-responses-year="13"
          data-pages-yesterday="2"
          data-pages-week="7"
          data-pages-month="38"
          data-pages-year="42"
          data-tokens-yesterday="30"
          data-tokens-week="80"
          data-tokens-month="900"
          data-tokens-year="1000">
        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">5</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">Payment Receipt</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">1</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">3</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">11</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">13</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">2</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">7</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">38</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">42</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">30</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">80</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">900</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">1000</span>
</td>

      </tr>
    
      <tr data-s-no="6" 
          data-custom-field="ID Card"
          data-responses-yesterday="1"
          data-responses-week="2"
          data-responses-month="9"
          data-responses-year="10"
          data-pages-yesterday="1"
          data-pages-week="5"
          data-pages-month="30"
          data-pages-year="33"
          data-tokens-yesterday="20"
          data-tokens-week="60"
          data-tokens-month="700"
          data-tokens-year="750">
        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">6</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">ID Card</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">1</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">2</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">9</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">10</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">1</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">5</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">30</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">33</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">20</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">60</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">700</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">750</span>
</td>

      </tr>
    
      <tr data-s-no="7" 
          data-custom-field="Transfer Certificate"
          data-responses-yesterday="0"
          data-responses-week="2"
          data-responses-month="7"
          data-responses-year="8"
          data-pages-yesterday="1"
          data-pages-week="3"
          data-pages-month="22"
          data-pages-year="24"
          data-tokens-yesterday="10"
          data-tokens-week="40"
          data-tokens-month="500"
          data-tokens-year="550">
        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">7</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">Transfer Certificate</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">0</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">2</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">7</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">8</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">1</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">3</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">22</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">24</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">10</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">40</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">500</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">550</span>
</td>

      </tr>
    
      <tr data-s-no="8" 
          data-custom-field="Migration Certificate"
          data-responses-yesterday="0"
          data-responses-week="1"
          data-responses-month="5"
          data-responses-year="6"
          data-pages-yesterday="0"
          data-pages-week="2"
          data-pages-month="12"
          data-pages-year="14"
          data-tokens-yesterday="5"
          data-tokens-week="20"
          data-tokens-month="300"
          data-tokens-year="350">
        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">8</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left truncate sm:max-w-44">
  <span class="font-medium text-gray-600">Migration Certificate</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">0</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">1</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">5</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">6</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">0</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">2</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">12</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">14</span>
</td>
<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-500 text-left">
  <span x-show="filter_by === 'yesterday'" class="font-medium text-gray-600">5</span>
  <span x-show="filter_by === 'this_week'" class="font-medium text-gray-600">20</span>
  <span x-show="filter_by === 'this_month'" class="font-medium text-gray-600">300</span>
  <span x-show="filter_by === 'this_year'" class="font-medium text-gray-600">350</span>
</td>

      </tr>
    
    
  </tbody>
</table>

<script>
function aiUsageTable() {
  return {
    filter_by: 'yesterday',
    order_by: 'tokens_desc',
    
    sortTable() {
      const tbody = document.getElementById('table-body');
      const rows = Array.from(tbody.querySelectorAll('tr[data-s-no]'));
      const [metric, direction] = this.order_by.split('_');
      const period = this.getDataAttribute(this.filter_by);

      rows.sort((a, b) => {
        const aValue = parseInt(a.getAttribute(`data-${metric}-${period}`)) || 0;
        const bValue = parseInt(b.getAttribute(`data-${metric}-${period}`)) || 0;

        if (direction === 'asc') {
          return aValue - bValue;
        }
        return bValue - aValue;
      });

      rows.forEach(row => tbody.appendChild(row));
    },

    getDataAttribute(period) {
      switch(period) {
        case 'yesterday': return 'yesterday';
        case 'this_week': return 'week';
        case 'this_month': return 'month';
        case 'this_year': return 'year';
        default: return 'yesterday';
      }
    },
    
    init() {
      this.sortTable();      
      this.$watch('filter_by', () => {
        this.sortTable();
      });
    }
  }
}
</script>
