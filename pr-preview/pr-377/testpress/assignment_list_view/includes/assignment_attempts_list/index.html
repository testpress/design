<div class="flex flex-col p-6" x-data="{ selected_ids: [], showEvaluator: true, showExamTitle: true }">
    <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
      <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
        <div class="overflow-hidden border-b border-gray-200 shadow sm:rounded-lg">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <!-- Checkbox Column -->
                <th scope="col" class="px-6 py-3 text-xs font-medium tracking-wider text-center text-gray-500 uppercase">
                  <input type="checkbox" @click="selected_ids = $event.target.checked ? attempts.map(attempt => attempt.id) : []"/>
                </th>
                <!-- Table Headers -->
                <th scope="col" class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">#</th>
                <th scope="col" class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                  <div class="min-w-full border-r-2 overflow-x-auto resize-x">Name</div>
                </th>
                <!-- Conditional Exam Title Column -->
                <template x-if="showExamTitle">
                  <th scope="col" class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                    <div class="min-w-full border-r-2 overflow-x-auto resize-x">Exam</div>
                  </th>
                </template>
                <th scope="col" class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">Answered</th>
                <th scope="col" class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">Submission Date</th>
                <th scope="col" class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">Actions</th>
                <!-- Conditional Evaluator Column -->
                <template x-if="showEvaluator">
                  <th scope="col" class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">Evaluators</th>
                </template>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <!-- Loop through JSON data for table rows -->
              <template x-for="(attempt, index) in attempts" :key="attempt.id">
                <tr class="bg-white">
                  <!-- Checkbox -->
                  <td class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap">
                    <div class="flex items-center justify-center">
                      <input type="checkbox" x-model="selected_ids" :value="attempt.id"/>
                    </div>
                  </td>
                  <!-- Row Number -->
                  <td class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap" x-text="index + 1"></td>
                  <!-- User Name -->
                  <td class="px-6 py-4 text-sm text-gray-900 truncate whitespace-nowrap sm:max-w-44" :title="attempt.user.username" x-text="attempt.user.username"></td>
                  <!-- Conditional Exam Title -->
                  <template x-if="showExamTitle">
                    <td class="px-6 py-4 text-sm text-gray-900 truncate whitespace-nowrap sm:max-w-44" :title="attempt.assessment.exam.title" x-text="attempt.assessment.exam.title"></td>
                  </template>
                  <!-- Answered Count -->
                  <td class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap" x-text="attempt.assessment.answered_count"></td>
                  <!-- Submission Date -->
                  <td class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap" x-text="attempt.assessment.completed_on"></td>
                  <!-- Actions -->
                  <td class="px-6 py-4 text-sm text-green-600 whitespace-nowrap">
                    <a :href="`/evaluate/${attempt.id}`" class="text-decoration-line: underline">Evaluate</a>
                  </td>
                  <!-- Conditional Evaluators -->
                  <template x-if="showEvaluator">
                    <td class="px-6 py-4 text-sm text-gray-500 whitespace-nowrap">
                      <div class="isolate flex -space-x-1 overflow-hidden items-center">
                        <template x-for="(evaluator, idx) in attempt.assessment.evaluators.slice(0, 4)" :key="evaluator.id">
                          <a :href="`/members/${evaluator.user.id}`" :data-tippy-content="evaluator.user.display_name">
                            <img class="relative z-30 inline-block h-6 w-6 rounded-full ring-2 ring-white"
                                 :src="evaluator.user.image"
                                 :alt="`Profile image of evaluator ${evaluator.user.display_name}`">
                          </a>
                        </template>
                        <template x-if="attempt.assessment.evaluators.length > 4">
                          <span class="p-2">+<span x-text="attempt.assessment.evaluators.length - 4"></span></span>
                        </template>
                      </div>
                    </td>
                  </template>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Sample JSON data for table rows
    const sampleAttempts = [
      {
        id: 1,
        user: { username: "john_doe" },
        assessment: {
          exam: { title: "Introduction to Programming" },
          answered_count: 10,
          completed_on: "2023-10-01",
          evaluators: [
            { id: 1, user: { id: 101, display_name: "Alice", image: "https://via.placeholder.com/150" } },
            { id: 2, user: { id: 102, display_name: "Bob", image: "https://via.placeholder.com/150" } },
          ],
        },
      },
      {
        id: 2,
        user: { username: "jane_smith" },
        assessment: {
          exam: { title: "Data Structures and Algorithms" },
          answered_count: 8,
          completed_on: "2023-10-02",
          evaluators: [
            { id: 3, user: { id: 103, display_name: "Charlie", image: "https://via.placeholder.com/150" } },
          ],
        },
      },
    ];

    // Initialize Alpine.js with sample data
    document.addEventListener('alpine:init', () => {
      Alpine.data('tableData', () => ({
        selected_ids: [],
        showEvaluator: true,
        showExamTitle: true,
        attempts: sampleAttempts,
      }));
    });

    // Initialize Tippy.js for tooltips
    tippy('[data-tippy-content]');
  </script>