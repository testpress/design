<script>
function GenerateorDownloadCertificate() {
    return {
        showGeneratingCertificateModal: false,
        certificateGeneratedAt: null, // Timestamp when certificate generation starts
        certificateUrl: "https://d36vpug2b5drql.cloudfront.net/institute/lmsdemo/private/exam_participation_certificates/37/e05921a5a52d4a9d9c643fb147e1013f.pdf?response-content-disposition=attachment&Expires=1739455356&Signature=Lyi~4vwavUEO9NQyDYD4J7n4cRCf94ZAwFJ2SbXctipWEzwkvjKp1v0CUqkBsFU-bUwlQev24t3mn~q6JRU~ST9fT8x7CHpYSAbeKLEY3dm1M-2wra7Nl8vIOq7jb5MBt-4oGybfK86vfsPmv15ViucZVbWFhiYEXT7f9kefRl-cYo~jiONSmfYfnlZWu-mzA1eDGtM7vER93VPx76CsoZl-ObPvPG6CoWMqLTN8yGoOLMFZDILJlcUOBlSf8lybybDOO-oLkk8RFD31ktC8Z6su1FxUtX62i0Nl5u0DhaF54Ad8Yf2k4Pi8RhZV42LUCUnQHTlFw17AZcjuk6pzkQ__&Key-Pair-Id=K2XWKDWM065EGO",
        certificateMessage: "Your certificate is being generated in the background. Please request again after 1 minute.",

        getcertificate() {
            const now = Date.now();

            if (!this.certificateGeneratedAt) {
                // First click - Start generation process
                this.certificateGeneratedAt = now;
                this.certificateMessage = "Your certificate is being generated in the background. Please request again after 1 minute.";
                this.showGeneratingCertificateModal = true;
            } else {
                const elapsedTime = Math.floor((now - this.certificateGeneratedAt) / 1000);
                const remainingTime = 60 - elapsedTime;

                if (elapsedTime >= 60) {
                    // Certificate ready, download it directly
                    window.location.href = this.certificateUrl;
                } else {
                    // Show modal with remaining time
                    this.certificateMessage = `Your certificate is still being generated. Please wait ${remainingTime} second${remainingTime !== 1 ? 's' : ''} before trying again.`;
                    this.showGeneratingCertificateModal = true;
                }
            }
        }
    };
}

</script>