<div
  x-data="{ gradingType: 'marking-guide' }"
  data-hs-stepper-content-item='{
  "index": 3
}'
  style="display: none"
>
  <div>
    <h2 class="text-base/7 font-semibold text-gray-900">Grading Settings</h2>
    <p class="mt-1 text-sm/6 text-gray-600">
      Configure grading type, maximum marks, and rubric or marking guide
      settings.
    </p>

    <div class="mt-6 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6">
      <!-- Grading Type Selection -->
      <div class="space-y-6 col-span-6">
        <label class="block text-sm font-medium text-gray-800"
          >Grading Type</label
        >
        <!-- Checkbox Grid -->
        <div class="grid lg:grid-cols-2 gap-3 lg:gap-5">
          <!-- Checkbox -->
          <label
            for="marks"
            class="py-3 px-4 flex text-sm bg-white text-gray-800 rounded-xl cursor-pointer rounded-xl ring-1 ring-gray-200 has-[:checked]:ring-2 has-[:checked]:ring-green-600"
          >
            <input
              type="radio"
              id="marks"
              value="marks"
              x-model="gradingType"
              class="bg-transparent border-gray-200 text-green-600 focus:ring-white focus:ring-offset-0"
              name="hs-pro-esdo"
              checked
            />
            <span class="grow px-4">
              <span class="block font-medium"> Marks </span>
              <span class="block text-sm leading-6 text-gray-500">
                Numeric grading out of max marks.
              </span>
            </span>
          </label>
          <!-- End Checkbox -->
          <!-- Checkbox -->
          <label
            for="letter-grades"
            class="py-3 px-4 flex text-sm bg-white text-gray-800 rounded-xl cursor-pointer rounded-xl ring-1 ring-gray-200 has-[:checked]:ring-2 has-[:checked]:ring-green-600"
          >
            <input
              type="radio"
              id="letter-grades"
              value="letter"
              x-model="gradingType"
              class="bg-transparent border-gray-200 text-green-600 focus:ring-white focus:ring-offset-0"
              name="hs-pro-esdo"
            />
            <span class="grow px-4">
              <span class="block font-medium"> Letter Grades </span>
              <span class="block text-sm leading-6 text-gray-500">
                Assign letter grades like A, B, C, etc.
              </span>
            </span>
          </label>
          <!-- End Checkbox -->

          <!-- Checkbox -->
          <label
            for="pass-or-fail"
            class="py-3 px-4 flex text-sm bg-white text-gray-800 rounded-xl cursor-pointer rounded-xl ring-1 ring-gray-200 has-[:checked]:ring-2 has-[:checked]:ring-green-600"
          >
            <input
              type="radio"
              id="pass-or-fail"
              value="pass-or-fail"
              x-model="gradingType"
              class="bg-transparent border-gray-200 text-green-600 focus:ring-white focus:ring-offset-0"
              name="hs-pro-esdo"
            />
            <span class="grow px-4">
              <span class="block font-medium"> Pass/Fail </span>
              <span class="block text-sm leading-6 text-gray-500">
                Simple pass or fail grading.
              </span>
            </span>
          </label>
          <!-- End Checkbox -->
          <!-- Checkbox -->
          <!-- <label for="rubric" class="py-3 px-4 flex text-sm bg-white text-gray-800 rounded-xl cursor-pointer rounded-xl ring-1 ring-gray-200 has-[:checked]:ring-2 has-[:checked]:ring-green-600">
    <input type="radio" id="rubric" value="rubric" x-model="gradingType" class="bg-transparent border-gray-200 text-green-600 focus:ring-white focus:ring-offset-0" name="hs-pro-esdo" >
    <span class="grow px-4">
      <span class="block font-medium">
        Rubric
      </span>
      <span class="block text-sm leading-6 text-gray-500">
        Use predefined scoring levels per criterion.
      </span>
    </span>
  </label> -->
          <!-- End Checkbox -->
          <!-- Checkbox -->
          <label
            for="marking-guide"
            class="py-3 px-4 flex text-sm bg-white text-gray-800 rounded-xl cursor-pointer rounded-xl ring-1 ring-gray-200 has-[:checked]:ring-2 has-[:checked]:ring-green-600"
          >
            <input
              type="radio"
              id="marking-guide"
              value="marking-guide"
              x-model="gradingType"
              class="bg-transparent border-gray-200 text-green-600 focus:ring-white focus:ring-offset-0"
              name="hs-pro-esdo"
            />
            <span class="grow px-4">
              <span class="block font-medium"> Marking Guide </span>
              <span class="block text-sm leading-6 text-gray-500">
                Assign scores within a range per criterion.
              </span>
            </span>
          </label>
          <!-- End Checkbox -->
        </div>
        <!-- End Checkbox Grid -->
      </div>
      <!-- Maximum Marks -->
      <template x-if="gradingType === 'marks'">
        <div class="space-y-2 col-span-6 sm:col-span-4">
          <label
            for="hs-pro-dasadamtn"
            class="block mb-2 text-sm font-medium text-gray-800 dark:text-neutral-200"
          >
            Maximum Marks
          </label>

          <input
            id="hs-pro-dasadamtn"
            type="number"
            class="focus:ring-emerald-600 focus:border-emerald-600 py-2 px-3 block w-full border-gray-200 rounded-lg text-sm text-gray-800 focus:z-10 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-200 dark:placeholder:text-neutral-500 dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-neutral-600"
          />
        </div>
      </template>
      <!-- Rubric & Marking Guide Visibility Settings -->
      <fieldset class="col-span-6">
        <template x-if="gradingType === 'rubric'">
          <div class="flex gap-3 mb-6">
            <div class="flex h-6 shrink-0 items-center">
              <div class="group grid size-4 grid-cols-1">
                <input
                  id="rubric-desc"
                  aria-describedby="rubric-desc-description"
                  name="rubric-desc"
                  type="checkbox"
                  class="col-start-1 row-start-1 appearance-none rounded-sm text-emerald-600 focus:ring-emerald-600 border border-gray-300 bg-white checked:border-emerald-600 checked:bg-emerald-600 indeterminate:border-emerald-600 indeterminate:bg-emerald-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:checked:bg-gray-100 forced-colors:appearance-auto"
                />
                <svg
                  class="pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25"
                  viewBox="0 0 14 14"
                  fill="none"
                >
                  <path
                    class="opacity-0 group-has-checked:opacity-100"
                    d="M3 8L6 11L11 3.5"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></path>
                  <path
                    class="opacity-0 group-has-indeterminate:opacity-100"
                    d="M3 7H11"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></path>
                </svg>
              </div>
            </div>
            <div class="text-sm/6">
              <label for="rubric-desc" class="font-medium text-gray-900"
                >Show rubric level descriptions to students</label
              >
              <p id="rubric-desc-description" class="text-gray-500">
                Displays detailed descriptions of each rubric level to help
                students understand expectations.
              </p>
            </div>
          </div>
        </template>
        <template x-if="gradingType === 'rubric'">
          <div class="flex gap-3 mb-6">
            <div class="flex h-6 shrink-0 items-center">
              <div class="group grid size-4 grid-cols-1">
                <input
                  id="rubric-scores"
                  aria-describedby="rubric-scores-description"
                  name="rubric-scores"
                  type="checkbox"
                  class="col-start-1 row-start-1 appearance-none rounded-sm text-emerald-600 focus:ring-emerald-600 border border-gray-300 bg-white checked:border-emerald-600 checked:bg-emerald-600 indeterminate:border-emerald-600 indeterminate:bg-emerald-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:checked:bg-gray-100 forced-colors:appearance-auto"
                />
                <svg
                  class="pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25"
                  viewBox="0 0 14 14"
                  fill="none"
                >
                  <path
                    class="opacity-0 group-has-checked:opacity-100"
                    d="M3 8L6 11L11 3.5"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></path>
                  <path
                    class="opacity-0 group-has-indeterminate:opacity-100"
                    d="M3 7H11"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></path>
                </svg>
              </div>
            </div>
            <div class="text-sm/6">
              <label for="rubric-scores" class="font-medium text-gray-900"
                >Show rubric level scores to students</label
              >
              <p id="rubric-scores-description" class="text-gray-500">
                Allows students to see the exact points assigned to each rubric
                level.
              </p>
            </div>
          </div>
        </template>
        <template x-if="gradingType === 'marking-guide'">
          <!-- Marking Guides -->
          <div
            x-data="markingGuideCriteriaManager()"
            class="flex flex-col bg-white border border-stone-200 overflow-hidden rounded-xl shadow-2xs dark:bg-neutral-800 dark:border-neutral-700"
          >
            <!-- Header -->
            <div
              class="py-3 px-5 flex justify-between items-center gap-x-5 border-b border-stone-200 dark:border-neutral-700"
            >
              <h2
                class="inline-block text-sm font-medium text-stone-800 dark:text-neutral-200"
              >
                Marking Guides
              </h2>
            </div>
            <!-- End Header -->

            <!-- Body -->
            <div class="py-3 px-5 space-y-2">
              <!-- Heading -->
              <div class="hidden md:grid grid-cols-12 gap-x-5">
                <div class="col-span-2">
                  <span
                    class="text-xs uppercase text-stone-500 dark:text-neutral-500"
                  >
                    Title
                  </span>
                </div>

                <div class="col-span-4">
                  <span
                    class="text-xs uppercase text-stone-500 dark:text-neutral-500"
                  >
                    Description for Students
                  </span>
                </div>

                <div class="col-span-4">
                  <span
                    class="text-xs uppercase text-stone-500 dark:text-neutral-500"
                  >
                    Marking Guide for Evaluator
                  </span>
                </div>

                <div class="col-span-2">
                  <span
                    class="text-xs uppercase text-stone-500 dark:text-neutral-500"
                  >
                    Maximum Marks
                  </span>
                </div>
              </div>
              <!-- End Heading -->

              <!-- List -->
              <div>
                <template x-for="(criterion, index) in criteria" :key="index">
                  <!-- Item -->
                  <div
                    class="pt-5 mt-5 border-t border-stone-200 first:pt-0 first:mt-0 first:border-t-0 md:pt-0 md:border-t-0 dark:border-neutral-700"
                  >
                    <div
                      class="grid grid-cols-2 md:grid-cols-12 gap-3 sm:gap-5"
                    >
                      <div class="col-span-1 md:col-span-2">
                        <!-- Input -->
                        <div>
                          <label
                            :for="'title-' + index"
                            class="md:hidden mb-1.5 block text-xs uppercase text-stone-500 dark:text-neutral-500"
                          >
                            Title
                          </label>
                          <input
                            :id="'title-' + index"
                            x-model="criterion.title"
                            type="text"
                            class="py-1.5 sm:py-2 px-3 block w-full border-stone-200 rounded-lg sm:text-sm text-stone-800 placeholder:text-stone-500 focus:z-10 focus:border-green-600 focus:ring-green-600 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-200 dark:placeholder:text-neutral-500 dark:focus:outline-hidden dark:focus:ring-1 dark:focus:ring-neutral-600"
                          />
                        </div>
                        <!-- End Input -->
                      </div>

                      <div class="col-span-4">
                        <!-- Input -->
                        <div>
                          <label
                            :for="'description_for_students' + index"
                            class="md:hidden mb-1.5 block text-xs uppercase text-stone-500 dark:text-neutral-500"
                          >
                            Description for Students
                          </label>
                          <input
                            type="text"
                            :id="'description_for_students-' + index"
                            x-model="criterion.description_for_students"
                            class="py-1.5 sm:py-2 px-3 block w-full border-stone-200 rounded-lg sm:text-sm text-stone-800 placeholder:text-stone-500 focus:z-10 focus:border-green-600 focus:ring-green-600 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-200 dark:placeholder:text-neutral-500 dark:focus:outline-hidden dark:focus:ring-1 dark:focus:ring-neutral-600"
                            placeholder="Enter student instructions"
                          />
                        </div>
                        <!-- End Input -->
                      </div>

                      <div class="col-span-4">
                        <!-- Input -->
                        <div>
                          <label
                            :for="'marking_guide_for_evaluator' + index"
                            class="md:hidden mb-1.5 block text-xs uppercase text-stone-500 dark:text-neutral-500"
                          >
                            Marking Guide for Evaluators
                          </label>
                          <div class="relative w-full">
                            <input
                              type="text"
                              :id="'marking_guide_for_evaluator-' + index"
                              x-model="criterion.marking_guide_for_evaluator"
                              class="py-1.5 sm:py-2 ps-3 pe-12 block w-full border-stone-200 rounded-lg sm:text-sm text-stone-800 placeholder:text-stone-500 focus:z-10 focus:border-green-600 focus:ring-green-600 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-200 dark:placeholder:text-neutral-500 dark:focus:outline-hidden dark:focus:ring-1 dark:focus:ring-neutral-600"
                              placeholder="Enter evaluator guidelines"
                            />
                          </div>
                        </div>
                        <!-- End Input -->
                      </div>

                      <div class="col-span-2">
                        <!-- Input -->
                        <div class="flex space-x-2">
                          <div>
                            <label
                              :for="'maximum_marks' + index"
                              class="md:hidden mb-1.5 block text-xs uppercase text-stone-500 dark:text-neutral-500"
                            >
                              Total Marks
                            </label>
                            <div
                              class="py-1.5 px-3 bg-white border border-stone-200 rounded-lg dark:bg-neutral-800 dark:border-neutral-700"
                            >
                              <div
                                class="w-full flex justify-between items-center gap-x-3"
                              >
                                <input
                                  :id="'maximum_marks-' + index"
                                  x-model="criterion.maximum_marks"
                                  class="w-full min-w-12 p-0 bg-transparent border-0 text-stone-800 focus:ring-0 dark:text-white"
                                  type="number"
                                  value="0"
                                  @keydown.enter.prevent="handleLastCellEnterKey(index)"
                                />
                              </div>
                            </div>
                          </div>

                          <div class="my-auto">
                            <button
                              type="button"
                              class="py-1 px-3 md:px-1 inline-flex justify-center items-center gap-x-1.5 font-medium text-sm rounded-full bg-stone-100 border border-transparent text-stone-600 hover:bg-stone-200 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-stone-200 dark:bg-neutral-700 dark:text-neutral-400 dark:hover:bg-neutral-600 dark:focus:bg-neutral-600"
                              @click="removeCriterion(index)"
                            >
                              <svg
                                class="hidden md:block shrink-0 size-4"
                                xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                              >
                                <path d="M18 6 6 18" />
                                <path d="m6 6 12 12" />
                              </svg>
                              <span class="md:hidden">Delete</span>
                            </button>
                          </div>
                        </div>
                        <!-- End Input -->
                      </div>
                    </div>
                  </div>
                  <!-- End Item -->
                </template>
              </div>
              <!-- End List -->
            </div>
            <!-- End Body -->

            <!-- Footer -->
            <div
              class="py-3 px-5 flex justify-between items-center gap-x-5 border-b border-stone-200 dark:border-neutral-700"
            >
              <!-- Add Variant -->
              <p>
                <button
                  @click="addCriterion()"
                  type="button"
                  class="py-1.5 px-2 inline-flex items-center gap-x-1 text-xs font-medium rounded-full border border-dashed border-stone-200 bg-white text-stone-800 hover:bg-stone-50 disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden focus:bg-stone-50 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700"
                >
                  <svg
                    class="shrink-0 size-3"
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M5 12h14" />
                    <path d="M12 5v14" />
                  </svg>
                  Add criterion
                </button>
              </p>
              <!-- End Add Variant -->
            </div>
            <!-- End Footer -->
          </div>
          <!-- End Marking Guides -->
        </template>
      </fieldset>
    </div>
  </div>
</div>
